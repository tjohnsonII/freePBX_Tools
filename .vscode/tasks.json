{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "dev: traceroute (inspect 9230)",
      "type": "process",
      "command": "cmd.exe",
      "args": [
        "/d",
        "/c",
        "set NODE_OPTIONS=--inspect=9230 && npm.cmd run dev"
      ],
      "isBackground": true,
      "problemMatcher": [
        {
          "pattern": [
            {
              "regexp": ".*"
            }
          ],
          "background": {
            "activeOnStart": true,
            "beginsPattern": "â–² Next\\.js",
            "endsPattern": "Ready in"
          }
        }
      ],
      "options": {
        "cwd": "${workspaceFolder}/traceroute-visualizer-main/traceroute-visualizer-main"
      }
    },
    {
      "label": "dev: deploy-ui (inspect 9232)",
      "type": "process",
      "command": "cmd.exe",
      "args": [
        "/d",
        "/c",
        "set NODE_OPTIONS=--inspect=9232 && npm.cmd run dev"
      ],
      "isBackground": true,
      "problemMatcher": [
        {
          "pattern": [
            {
              "regexp": ".*"
            }
          ],
          "background": {
            "activeOnStart": true,
            "beginsPattern": "VITE v",
            "endsPattern": "Local:\\s+http://"
          }
        }
      ],
      "options": {
        "cwd": "${workspaceFolder}/freepbx-deploy-ui"
      }
    },
    {
      "label": "dev: polycom app (inspect 9233)",
      "type": "process",
      "command": "cmd.exe",
      "args": [
        "/d",
        "/c",
        "set NODE_OPTIONS=--inspect=9233 && npm.cmd run dev"
      ],
      "isBackground": true,
      "problemMatcher": [
        {
          "pattern": [
            {
              "regexp": ".*"
            }
          ],
          "background": {
            "activeOnStart": true,
            "beginsPattern": "VITE v",
            "endsPattern": "Local:\\s+http://"
          }
        }
      ],
      "options": {
        "cwd": "${workspaceFolder}/PolycomYealinkMikrotikSwitchConfig-main/PolycomYealinkMikrotikSwitchConfig-main"
      }
    },
    {
      "label": "dev: deploy-backend (debugpy 5678)",
      "type": "process",
      "command": "cmd.exe",
      "args": [
        "/d",
        "/c",
        "call \"${workspaceFolder}\\scripts\\run_py.bat\" .venv-backend -m debugpy --listen 5678 --wait-for-client -m uvicorn freepbx_deploy_backend.main:app --reload --host 127.0.0.1 --port 8002"
      ],
      "isBackground": true,
      "problemMatcher": [
        {
          "pattern": [
            {
              "regexp": ".*"
            }
          ],
          "background": {
            "activeOnStart": true,
            "beginsPattern": "0\\.",
            "endsPattern": "Waiting for client"
          }
        }
      ],
      "options": {
        "cwd": "${workspaceFolder}/freepbx-deploy-backend"
      }
    },
    {
      "label": "dev: webscraper (debugpy 5679)",
      "type": "process",
      "command": "cmd.exe",
      "args": [
        "/d",
        "/c",
        "call scripts\\run_py.bat .venv-webscraper -m debugpy --listen 5679 --wait-for-client webscraper\\dev_server.py"
      ],
      "isBackground": true,
      "problemMatcher": [
        {
          "pattern": [
            {
              "regexp": ".*"
            }
          ],
          "background": {
            "activeOnStart": true,
            "beginsPattern": "0\\.",
            "endsPattern": "Waiting for client"
          }
        }
      ],
      "options": {
        "cwd": "${workspaceFolder}"
      }
    },
    {
      "label": "kill: debug ports",
      "type": "process",
      "command": "cmd.exe",
      "args": [
        "/d",
        "/c",
        "for %P in (9230 9232 9233 5678 5679) do @for /f \"tokens=5\" %a in ('netstat -ano ^| findstr /r /c:\":%P .*LISTENING\"') do @taskkill /F /PID %a >nul 2>&1"
      ],
      "problemMatcher": [],
      "options": {
        "cwd": "${workspaceFolder}"
      }
    },
    {
      "label": "start: all debug",
      "dependsOn": [
        "dev: traceroute (inspect 9230)",
        "dev: deploy-ui (inspect 9232)",
        "dev: polycom app (inspect 9233)",
        "dev: deploy-backend (debugpy 5678)",
        "dev: webscraper (debugpy 5679)"
      ],
      "dependsOrder": "parallel",
      "problemMatcher": []
    },
    {
      "label": "Start Everything (Debug Mode)",
      "dependsOn": [
        "kill: debug ports",
        "start: all debug"
      ],
      "dependsOrder": "sequence",
      "problemMatcher": []
    }
  ]
}
