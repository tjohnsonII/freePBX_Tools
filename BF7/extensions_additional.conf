;--------------------------------------------------------------------------------;
;          Do NOT edit this file as it is auto-generated by FreePBX.             ;
;--------------------------------------------------------------------------------;
; For information on adding additional paramaters to this file, please visit the ;
; FreePBX.org wiki page, or ask on IRC. This file was created by the new FreePBX ;
; BMO - Big Module Object. Any similarity in naming with BMO from Adventure Time ;
; is totally deliberate.                                                         ;
;--------------------------------------------------------------------------------;
[globals]
CFDEVSTATE = TRUE
MIXMON_BEEP = 
DNDDEVSTATE = TRUE
FMDEVSTATE = TRUE
QUEDEVSTATE = TRUE
QUEUETOGGLE = *45
QUEUEPAUSETOGGLE = *46
QUEUECALLERS = *47
OPERATOR_XTN = 
VM_OPTS = 
VM_GAIN = 
VM_DDTYPE = u
VMX_OPTS_LOOP = 
VMX_OPTS_DOVM = 
VMX_TIMEOUT = 2
VMX_REPEAT = 1
VMX_LOOPS = 1
DYNAMIC_FEATURES = apprecord
INTERCOMCODE = *80
ASTETCDIR = /etc/asterisk
ASTMODDIR = /usr/lib/asterisk/modules
ASTVARLIBDIR = /var/lib/asterisk
ASTAGIDIR = /var/lib/asterisk/agi-bin
ASTSPOOLDIR = /var/spool/asterisk
ASTRUNDIR = /var/run/asterisk
ASTLOGDIR = /var/log/asterisk
CWINUSEBUSY = 1
AMPMGRUSER = admin
AMPMGRPASS = kF2w8324krfr38#3
ASTMANAGERHOST = localhost
AMPDBENGINE = mysql
AMPDBHOST = localhost
AMPDBNAME = asterisk
AMPDBUSER = freepbxuser
AMPDBPASS = dc915e4bea5c
AMPBIN = /var/lib/asterisk/bin
VMX_CONTEXT = from-internal
VMX_PRI = 1
VMX_TIMEDEST_CONTEXT = 
VMX_TIMEDEST_EXT = dovm
VMX_TIMEDEST_PRI = 1
VMX_LOOPDEST_CONTEXT = 
VMX_LOOPDEST_EXT = dovm
VMX_LOOPDEST_PRI = 1
MIXMON_DIR = 
MIXMON_POST = 
DIAL_OPTIONS = Ttr
TRUNK_OPTIONS = Tt
TRUNK_RING_TIMER = 300
MIXMON_FORMAT = wav
REC_POLICY = caller
RINGTIMER_DEFAULT = 15
TRANSFER_CONTEXT = from-internal-xfer
ASTVERSION = 12.8.1
ASTCHANDAHDI = 1
NULL = ""
OUT_2 = SIP/SIP-OUT
OUTCID_2 = 2485851210
OUTMAXCHANS_2 = 23
OUTFAIL_2 = 
OUTPREFIX_2 = 
OUTDISABLE_2 = off
OUTKEEPCID_2 = off
FORCEDOUTCID_2 = 
PREFIX_TRUNK_2 = 
ALLOW_SIP_ANON = no
SIPLANG = en
#include globals_custom.conf

;end of [globals]

[app-announcement-1]
exten => s,1,GotoIf($["${CHANNEL(state)}" = "Up"]?begin)
exten => s,n,Answer
exten => s,n,Wait(1)
exten => s,n(begin),Noop(Playing announcement DIRECTIONS)
exten => s,n(play),Background(custom/DIRECTIONS,nm)
exten => s,n,GotoIf($["x${IVR_CONTEXT}" = "x"]?timeconditions,2,1:${IVR_CONTEXT},return,1)

exten => _[0-9*#],1,Noop(User skipped announcement)
exten => _[0-9*#],n,GotoIf($["x${IVR_CONTEXT}" = "x"]?timeconditions,2,1:${IVR_CONTEXT},return,1)

exten => i,1,GotoIf($["x${IVR_CONTEXT}" = "x"]?timeconditions,2,1:${IVR_CONTEXT},return,1)

;--== end of [app-announcement-1] ==--;


[app-announcement-2]
exten => s,1,GotoIf($["${CHANNEL(state)}" = "Up"]?begin)
exten => s,n,Answer
exten => s,n,Wait(1)
exten => s,n(begin),Noop(Playing announcement Temp Closed)
exten => s,n,Playback(custom/Manual_Toggle,noanswer)
exten => s,n,Goto(app-blackhole,hangup,1)

;--== end of [app-announcement-2] ==--;


[app-cf-busy-off]
exten => lang-playback,1,GosubIf($[${DIALPLAN_EXISTS(app-cf-busy-off,${CHANNEL(language)})}]?app-cf-busy-off,${CHANNEL(language)},${ARG1}():app-cf-busy-off,en,${ARG1}())
exten => lang-playback,n,Return()

exten => *91,1,Answer
exten => *91,n,Wait(1)
exten => *91,n,Macro(user-callerid,)
exten => *91,n,Set(fromext=${AMPUSER})
exten => *91,n,Noop(Deleting: CFB/${fromext} ${DB_DELETE(CFB/${fromext})})
exten => *91,n,Gosub(app-cf-busy-off,lang-playback,1(hook_0))
exten => *91,n,Macro(hangupcall,)

exten => _*91.,1,Answer
exten => _*91.,n,Wait(1)
exten => _*91.,n,Macro(user-callerid,)
exten => _*91.,n,Set(fromext=${EXTEN:3})
exten => _*91.,n,Noop(Deleting: CFB/${fromext} ${DB_DELETE(CFB/${fromext})})
exten => _*91.,n,Gosub(app-cf-busy-off,lang-playback,1(hook_1))
exten => _*91.,n,Macro(hangupcall,)

exten => en,1(hook_0),Playback(call-fwd-on-busy&de-activated)
exten => en,n,Return()
exten => en,n(hook_1),Playback(call-fwd-on-busy&for&extension)
exten => en,n,SayDigits(${fromext})
exten => en,n,Playback(cancelled)
exten => en,n,Return()

exten => ja,1(hook_0),Playback(call-fwd-on-busy&de-activated)
exten => ja,n,Return()
exten => ja,n(hook_1),Playback(extension)
exten => ja,n,SayDigits(${fromext})
exten => ja,n,Playback(jp-no&call-fwd-on-busy&jp-wo)
exten => ja,n,Playback(cancelled)
exten => ja,n,Return()

;--== end of [app-cf-busy-off] ==--;


[app-cf-off]
exten => lang-playback,1,GosubIf($[${DIALPLAN_EXISTS(app-cf-off,${CHANNEL(language)})}]?app-cf-off,${CHANNEL(language)},${ARG1}():app-cf-off,en,${ARG1}())
exten => lang-playback,n,Return()

exten => *73,1,Answer
exten => *73,n,Wait(1)
exten => *73,n,Macro(user-callerid,)
exten => *73,n,Set(fromext=${AMPUSER})
exten => *73,n,Noop(Deleting: CF/${fromext} ${DB_DELETE(CF/${fromext})})
exten => *73,n,Set(STATE=NOT_INUSE)
exten => *73,n,Gosub(app-cf-off,sstate,1())
exten => *73,n,Gosub(app-cf-off,lang-playback,1(hook_0))
exten => *73,n,Macro(hangupcall,)

exten => _*73.,1,Answer
exten => _*73.,n,Wait(1)
exten => _*73.,n,Macro(user-callerid,)
exten => _*73.,n,Set(fromext=${EXTEN:3})
exten => _*73.,n,Noop(Deleting: CF/${fromext} ${DB_DELETE(CF/${fromext})})
exten => _*73.,n,Set(STATE=NOT_INUSE)
exten => _*73.,n,Gosub(app-cf-off,sstate,1())
exten => _*73.,n,Gosub(app-cf-off,lang-playback,1(hook_1))
exten => _*73.,n,Macro(hangupcall,)

exten => sstate,1,Set(DEVICE_STATE(Custom:CF${fromext})=${STATE})
exten => sstate,n,Set(DEVICES=${DB(AMPUSER/${fromext}/device)})
exten => sstate,n,GotoIf($["${DEVICES}" = "" ]?return)
exten => sstate,n,Set(LOOPCNT=${FIELDQTY(DEVICES,&)})
exten => sstate,n,Set(ITER=1)
exten => sstate,n(begin),Set(DEVICE_STATE(Custom:DEVCF${CUT(DEVICES,&,${ITER})})=${STATE})
exten => sstate,n,Set(ITER=$[${ITER} + 1])
exten => sstate,n,GotoIf($[${ITER} <= ${LOOPCNT}]?begin)
exten => sstate,n(return),Return()

exten => en,1(hook_0),Playback(call-fwd-unconditional&de-activated)
exten => en,n,Return()
exten => en,n(hook_1),Playback(call-fwd-unconditional&for&extension)
exten => en,n,SayDigits(${fromext})
exten => en,n,Playback(cancelled)
exten => en,n,Return()

exten => ja,1(hook_0),Playback(call-fwd-unconditional&de-activated)
exten => ja,n,Return()
exten => ja,n(hook_1),Playback(extension)
exten => ja,n,SayDigits(${fromext})
exten => ja,n,Playback(jp-no&call-fwd-unconditional&jp-wo&cancelled)
exten => ja,n,Return()

;--== end of [app-cf-off] ==--;


[app-cf-busy-prompting-on]
exten => lang-playback,1,GosubIf($[${DIALPLAN_EXISTS(app-cf-busy-prompting-on,${CHANNEL(language)})}]?app-cf-busy-prompting-on,${CHANNEL(language)},${ARG1}():app-cf-busy-prompting-on,en,${ARG1}())
exten => lang-playback,n,Return()

exten => *94,1,Answer
exten => *94,n,Wait(1)
exten => *94,n,Macro(user-callerid,)
exten => *94,n,Gosub(app-cf-busy-prompting-on,lang-playback,1(hook_0))
exten => *94,n,Set(fromext=${IF($["${fromext}"=""]?${AMPUSER}:${fromext})})
exten => *94,n,Wait(1)
exten => *94,n(startread),Gosub(app-cf-busy-prompting-on,lang-playback,1(hook_1))
exten => *94,n,Gosub(app-cf-busy-prompting-on,lang-playback,1(hook_2))
exten => *94,n,Macro(hangupcall,)

exten => _*94.,1,Answer
exten => _*94.,n,Wait(1)
exten => _*94.,n,Macro(user-callerid,)
exten => _*94.,n,Set(fromext=${AMPUSER})
exten => _*94.,n,Set(toext=${EXTEN:3})
exten => _*94.,n,Set(DB(CFB/${fromext})=${toext})
exten => _*94.,n,Gosub(app-cf-busy-prompting-on,lang-playback,1(hook_3))
exten => _*94.,n,Macro(hangupcall,)

exten => en,1(hook_0),Read(fromext,call-fwd-on-busy&please-enter-your-extension-then-press-pound,,,,)
exten => en,n,Return()
exten => en,n(hook_1),Read(toext,agent-newlocation,,,,)
exten => en,n,GotoIf($["${toext}"=""]?hook_1)
exten => en,n,Wait(1)
exten => en,n,Set(DB(CFB/${fromext})=${toext})
exten => en,n,Return()
exten => en,n(hook_2),Playback(call-fwd-on-busy&for&extension)
exten => en,n,SayDigits(${fromext})
exten => en,n,Playback(is-set-to)
exten => en,n,SayDigits(${toext})
exten => en,n,Return()
exten => en,n(hook_3),Playback(call-fwd-on-busy&for&extension)
exten => en,n,SayDigits(${fromext})
exten => en,n,Playback(is-set-to)
exten => en,n,SayDigits(${toext})
exten => en,n,Return()

exten => ja,1(hook_0),Read(fromext,call-fwd-on-busy&extension&please-enter-your&vm-press-pound,,,,)
exten => ja,n,Return()
exten => ja,n(hook_1),Read(toext,ent-target-attendant&then-press-pound,,,,)
exten => ja,n,GotoIf($["${toext}"=""]?hook_1)
exten => ja,n,Wait(1)
exten => ja,n,Set(DB(CFB/${fromext})=${toext})
exten => ja,n,Return()
exten => ja,n(hook_2),Playback(extension)
exten => ja,n,SayDigits(${fromext})
exten => ja,n,Playback(jp-no&call-fwd-on-busy&jp-wo)
exten => ja,n,SayDigits(${toext})
exten => ja,n,Playback(is-set-to)
exten => ja,n,Return()
exten => ja,n(hook_3),Playback(extension)
exten => ja,n,SayDigits(${fromext})
exten => ja,n,Playback(jp-no&call-fwd-on-busy&jp-wo)
exten => ja,n,SayDigits(${toext})
exten => ja,n,Playback(is-set-to)
exten => ja,n,Return()

;--== end of [app-cf-busy-prompting-on] ==--;


[app-cf-busy-on]
exten => lang-playback,1,GosubIf($[${DIALPLAN_EXISTS(app-cf-busy-on,${CHANNEL(language)})}]?app-cf-busy-on,${CHANNEL(language)},${ARG1}():app-cf-busy-on,en,${ARG1}())
exten => lang-playback,n,Return()

exten => *90,1,Answer
exten => *90,n,Wait(1)
exten => *90,n,Macro(user-callerid,)
exten => *90,n,Set(fromext=${AMPUSER})
exten => *90,n,GotoIf($["${fromext}"!=""]?startread)
exten => *90,n,Playback(agent-loggedoff)
exten => *90,n,Macro(hangupcall,)
exten => *90,n(startread),Gosub(app-cf-busy-on,lang-playback,1(hook_1))
exten => *90,n,Gosub(app-cf-busy-on,lang-playback,1(hook_2))
exten => *90,n,Macro(hangupcall,)

exten => _*90.,1,Answer
exten => _*90.,n,Wait(1)
exten => _*90.,n,Macro(user-callerid,)
exten => _*90.,n,Set(fromext=${AMPUSER})
exten => _*90.,n,Set(toext=${EXTEN:3})
exten => _*90.,n,Set(DB(CFB/${fromext})=${toext})
exten => _*90.,n,Gosub(app-cf-busy-on,lang-playback,1(hook_3))
exten => _*90.,n,Macro(hangupcall,)

exten => en,1(hook_0),Read(fromext,call-fwd-on-busy&please-enter-your-extension-then-press-pound,,,,)
exten => en,n,Return()
exten => en,n(hook_1),Read(toext,agent-newlocation,,,,)
exten => en,n,GotoIf($["${toext}"=""]?hook_1)
exten => en,n,Wait(1)
exten => en,n,Set(DB(CFB/${fromext})=${toext})
exten => en,n,Return()
exten => en,n(hook_2),Playback(call-fwd-on-busy&for&extension)
exten => en,n,SayDigits(${fromext})
exten => en,n,Playback(is-set-to)
exten => en,n,SayDigits(${toext})
exten => en,n,Return()
exten => en,n(hook_3),Playback(call-fwd-on-busy&for&extension)
exten => en,n,SayDigits(${fromext})
exten => en,n,Playback(is-set-to)
exten => en,n,SayDigits(${toext})
exten => en,n,Return()

exten => ja,1(hook_0),Read(fromext,call-fwd-on-busy&extension&please-enter-your&vm-press-pound,,,,)
exten => ja,n,Return()
exten => ja,n(hook_1),Read(toext,ent-target-attendant&then-press-pound,,,,)
exten => ja,n,GotoIf($["${toext}"=""]?hook_1)
exten => ja,n,Wait(1)
exten => ja,n,Set(DB(CFB/${fromext})=${toext})
exten => ja,n,Return()
exten => ja,n(hook_2),Playback(extension)
exten => ja,n,SayDigits(${fromext})
exten => ja,n,Playback(jp-no&call-fwd-on-busy&jp-wo)
exten => ja,n,SayDigits(${toext})
exten => ja,n,Playback(is-set-to)
exten => ja,n,Return()
exten => ja,n(hook_3),Playback(extension)
exten => ja,n,SayDigits(${fromext})
exten => ja,n,Playback(jp-no&call-fwd-on-busy&jp-wo)
exten => ja,n,SayDigits(${toext})
exten => ja,n,Playback(is-set-to)
exten => ja,n,Return()

;--== end of [app-cf-busy-on] ==--;


[app-cf-busy-off-any]
exten => lang-playback,1,GosubIf($[${DIALPLAN_EXISTS(app-cf-busy-off-any,${CHANNEL(language)})}]?app-cf-busy-off-any,${CHANNEL(language)},${ARG1}():app-cf-busy-off-any,en,${ARG1}())
exten => lang-playback,n,Return()

exten => *92,1,Answer
exten => *92,n,Macro(user-callerid,)
exten => *92,n,Wait(1)
exten => *92,n,Gosub(app-cf-busy-off-any,lang-playback,1(hook_0))
exten => *92,n,Set(fromext=${IF($["foo${fromext}"="foo"]?${AMPUSER}:${fromext})})
exten => *92,n,Wait(1)
exten => *92,n,Noop(Deleting: CFB/${fromext} ${DB_DELETE(CFB/${fromext})})
exten => *92,n,Gosub(app-cf-busy-off-any,lang-playback,1(hook_1))
exten => *92,n,Macro(hangupcall,)

exten => en,1(hook_0),Read(fromext,please-enter-your-extension-then-press-pound,,,,)
exten => en,n,Return()
exten => en,n(hook_1),Playback(call-fwd-on-busy&for&extension)
exten => en,n,SayDigits(${fromext})
exten => en,n,Playback(cancelled)
exten => en,n,Return()

exten => ja,1(hook_0),Read(fromext,extension&please-enter-your&vm-press-pound,,,,)
exten => ja,n,Return()
exten => ja,n(hook_1),Playback(extension)
exten => ja,n,SayDigits(${fromext})
exten => ja,n,Playback(jp-no&call-fwd-on-busy&jp-wo)
exten => ja,n,Playback(cancelled)
exten => ja,n,Return()

;--== end of [app-cf-busy-off-any] ==--;


[app-cf-off-any]
exten => lang-playback,1,GosubIf($[${DIALPLAN_EXISTS(app-cf-off-any,${CHANNEL(language)})}]?app-cf-off-any,${CHANNEL(language)},${ARG1}():app-cf-off-any,en,${ARG1}())
exten => lang-playback,n,Return()

exten => *74,1,Answer
exten => *74,n,Macro(user-callerid,)
exten => *74,n,Wait(1)
exten => *74,n,Gosub(app-cf-off-any,lang-playback,1(hook_0))
exten => *74,n,Set(fromext=${IF($["foo${fromext}"="foo"]?${AMPUSER}:${fromext})})
exten => *74,n,Wait(1)
exten => *74,n,Noop(Deleting: CF/${fromext} ${DB_DELETE(CF/${fromext})})
exten => *74,n,Set(STATE=NOT_INUSE)
exten => *74,n,Gosub(app-cf-off-any,sstate,1())
exten => *74,n,Gosub(app-cf-off-any,lang-playback,1(hook_1))
exten => *74,n,Macro(hangupcall,)

exten => sstate,1,Set(DEVICE_STATE(Custom:CF${fromext})=${STATE})
exten => sstate,n,Set(DEVICES=${DB(AMPUSER/${fromext}/device)})
exten => sstate,n,GotoIf($["${DEVICES}" = "" ]?return)
exten => sstate,n,Set(LOOPCNT=${FIELDQTY(DEVICES,&)})
exten => sstate,n,Set(ITER=1)
exten => sstate,n(begin),Set(DEVICE_STATE(Custom:DEVCF${CUT(DEVICES,&,${ITER})})=${STATE})
exten => sstate,n,Set(ITER=$[${ITER} + 1])
exten => sstate,n,GotoIf($[${ITER} <= ${LOOPCNT}]?begin)
exten => sstate,n(return),Return()

exten => en,1(hook_0),Read(fromext,please-enter-your-extension-then-press-pound,,,,)
exten => en,n,Return()
exten => en,n(hook_1),Playback(call-fwd-unconditional&for&extension)
exten => en,n,SayDigits(${fromext})
exten => en,n,Playback(cancelled)
exten => en,n,Return()

exten => ja,1(hook_0),Read(fromext,extension&please-enter-your&vm-press-pound,,,,)
exten => ja,n,Return()
exten => ja,n(hook_1),Playback(extension)
exten => ja,n,SayDigits(${fromext})
exten => ja,n,Playback(jp-no&call-fwd-unconditional&jp-wo&cancelled)
exten => ja,n,Return()

;--== end of [app-cf-off-any] ==--;


[app-cf-on]
exten => lang-playback,1,GosubIf($[${DIALPLAN_EXISTS(app-cf-on,${CHANNEL(language)})}]?app-cf-on,${CHANNEL(language)},${ARG1}():app-cf-on,en,${ARG1}())
exten => lang-playback,n,Return()

exten => *72,1,Answer
exten => *72,n,Wait(1)
exten => *72,n,Macro(user-callerid,)
exten => *72,n,Set(fromext=${AMPUSER})
exten => *72,n,GotoIf($["${fromext}"!=""]?startread)
exten => *72,n,Playback(agent-loggedoff)
exten => *72,n,Macro(hangupcall,)
exten => *72,n(startread),Gosub(app-cf-on,lang-playback,1(hook_1))
exten => *72,n,GotoIf($["foo${toext}"="foo"]?startread)
exten => *72,n,Wait(1)
exten => *72,n,Set(DB(CF/${fromext})=${toext})
exten => *72,n,Set(STATE=BUSY)
exten => *72,n,Gosub(app-cf-on,sstate,1())
exten => *72,n,Gosub(app-cf-on,lang-playback,1(hook_2))
exten => *72,n,Macro(hangupcall,)

exten => _*72.,1,Answer
exten => _*72.,n,Wait(1)
exten => _*72.,n,Macro(user-callerid,)
exten => _*72.,n,Set(fromext=${AMPUSER})
exten => _*72.,n,Set(toext=${EXTEN:3})
exten => _*72.,n,Set(DB(CF/${fromext})=${toext})
exten => _*72.,n,Set(STATE=BUSY)
exten => _*72.,n,Gosub(app-cf-on,sstate,1())
exten => _*72.,n,Gosub(app-cf-on,lang-playback,1(hook_3))
exten => _*72.,n,Macro(hangupcall,)

exten => sstate,1,Set(DEVICE_STATE(Custom:CF${fromext})=${STATE})
exten => sstate,n,Set(DEVICES=${DB(AMPUSER/${fromext}/device)})
exten => sstate,n,GotoIf($["${DEVICES}" = "" ]?return)
exten => sstate,n,Set(LOOPCNT=${FIELDQTY(DEVICES,&)})
exten => sstate,n,Set(ITER=1)
exten => sstate,n(begin),Set(DEVICE_STATE(Custom:DEVCF${CUT(DEVICES,&,${ITER})})=${STATE})
exten => sstate,n,Set(ITER=$[${ITER} + 1])
exten => sstate,n,GotoIf($[${ITER} <= ${LOOPCNT}]?begin)
exten => sstate,n(return),Return()

exten => en,1(hook_0),Read(fromext,call-fwd-unconditional&please-enter-your-extension-then-press-pound,,,,)
exten => en,n,Return()
exten => en,n(hook_1),Read(toext,agent-newlocation,,,,)
exten => en,n,Return()
exten => en,n(hook_2),Playback(call-fwd-unconditional&for&extension)
exten => en,n,SayDigits(${fromext})
exten => en,n,Playback(is-set-to)
exten => en,n,SayDigits(${toext})
exten => en,n,Return()
exten => en,n(hook_3),Playback(call-fwd-unconditional&for&extension)
exten => en,n,SayDigits(${fromext})
exten => en,n,Playback(is-set-to)
exten => en,n,SayDigits(${toext})
exten => en,n,Return()

exten => ja,1(hook_0),Read(fromext,call-fwd-unconditional&extension&please-enter-your&vm-press-pound,,,,)
exten => ja,n,Return()
exten => ja,n(hook_1),Read(toext,ent-target-attendant&vm-press-pound,,,,)
exten => ja,n,Return()
exten => ja,n(hook_2),Playback(extension)
exten => ja,n,SayDigits(${fromext})
exten => ja,n,Playback(jp-no&call-fwd-unconditional&jp-wo)
exten => ja,n,SayDigits(${toext})
exten => ja,n,Playback(is-set-to)
exten => ja,n,Return()
exten => ja,n(hook_3),Playback(extension)
exten => ja,n,SayDigits(${fromext})
exten => ja,n,Playback(jp-no&call-fwd-unconditional&jp-wo)
exten => ja,n,SayDigits(${toext})
exten => ja,n,Playback(is-set-to)
exten => ja,n,Return()

;--== end of [app-cf-on] ==--;


[app-cf-toggle]
exten => lang-playback,1,GosubIf($[${DIALPLAN_EXISTS(app-cf-toggle,${CHANNEL(language)})}]?app-cf-toggle,${CHANNEL(language)},${ARG1}():app-cf-toggle,en,${ARG1}())
exten => lang-playback,n,Return()

exten => *96,1,Answer
exten => *96,n,Wait(1)
exten => *96,n,Macro(user-callerid,)
exten => *96,n,Set(fromext=${AMPUSER})
exten => *96,n,GotoIf($["${DB(CF/${fromext})}" = ""]?activate:deactivate)
exten => *96,n(activate),Read(toext,agent-newlocation,,,,)
exten => *96,n,GotoIf($["${toext}"=""]?activate)
exten => *96,n,Wait(1)
exten => *96,n(toext),Set(DB(CF/${fromext})=${toext})
exten => *96,n,Set(STATE=BUSY)
exten => *96,n,Gosub(app-cf-toggle,sstate,1())
exten => *96,n,Gosub(app-cf-toggle,lang-playback,1(hook_0))
exten => *96,n,Macro(hangupcall,)
exten => *96,n(setdirect),Answer
exten => *96,n,Wait(1)
exten => *96,n,Macro(user-callerid,)
exten => *96,n,Set(fromext=${AMPUSER})
exten => *96,n,Goto(toext)
exten => *96,n(deactivate),Noop(Deleting: CF/${fromext} ${DB_DELETE(CF/${fromext})})
exten => *96,n,Set(STATE=NOT_INUSE)
exten => *96,n,Gosub(app-cf-toggle,sstate,1())
exten => *96,n(hook_off),Playback(call-fwd-unconditional&de-activated)
exten => *96,n,Macro(hangupcall,)

exten => sstate,1,Set(DEVICE_STATE(Custom:CF${fromext})=${STATE})
exten => sstate,n,Set(DEVICES=${DB(AMPUSER/${fromext}/device)})
exten => sstate,n,GotoIf($["${DEVICES}" = "" ]?return)
exten => sstate,n,Set(LOOPCNT=${FIELDQTY(DEVICES,&)})
exten => sstate,n,Set(ITER=1)
exten => sstate,n(begin),Set(DEVICE_STATE(Custom:DEVCF${CUT(DEVICES,&,${ITER})})=${STATE})
exten => sstate,n,Set(ITER=$[${ITER} + 1])
exten => sstate,n,GotoIf($[${ITER} <= ${LOOPCNT}]?begin)
exten => sstate,n(return),Return()

exten => en,1(hook_0),Playback(call-fwd-unconditional&for&extension)
exten => en,n,SayDigits(${fromext})
exten => en,n,Playback(is-set-to)
exten => en,n,SayDigits(${toext})
exten => en,n,Return()

exten => ja,1(hook_0),Playback(extension)
exten => ja,n,SayDigits(${fromext})
exten => ja,n,Playback(jp-no&call-fwd-unconditional&jp-wo)
exten => ja,n,SayDigits(${toext})
exten => ja,n,Playback(is-set-to)
exten => ja,n,Return()

;--== end of [app-cf-toggle] ==--;


[app-cf-unavailable-prompt-on]
exten => lang-playback,1,GosubIf($[${DIALPLAN_EXISTS(app-cf-unavailable-prompt-on,${CHANNEL(language)})}]?app-cf-unavailable-prompt-on,${CHANNEL(language)},${ARG1}():app-cf-unavailable-prompt-on,en,${ARG1}())
exten => lang-playback,n,Return()

exten => *95,1,Answer
exten => *95,n,Wait(1)
exten => *95,n,Macro(user-callerid,)
exten => *95,n,Gosub(app-cf-unavailable-prompt-on,lang-playback,1(hook_0))
exten => *95,n,Set(fromext=${IF($["${fromext}"=""]?${AMPUSER}:${fromext})})
exten => *95,n,Wait(1)
exten => *95,n(startread),Gosub(app-cf-unavailable-prompt-on,lang-playback,1(hook_1))
exten => *95,n,GotoIf($["${toext}"=""]?startread)
exten => *95,n,Wait(1)
exten => *95,n,Set(DB(CFU/${fromext})=${toext})
exten => *95,n,Gosub(app-cf-unavailable-prompt-on,lang-playback,1(hook_2))
exten => *95,n,Macro(hangupcall,)

exten => _*95.,1,Answer
exten => _*95.,n,Wait(1)
exten => _*95.,n,Macro(user-callerid,)
exten => _*95.,n,Set(fromext=${AMPUSER})
exten => _*95.,n,Set(toext=${EXTEN:3})
exten => _*95.,n,Set(DB(CFU/${fromext})=${toext})
exten => _*95.,n(startread),Gosub(app-cf-unavailable-prompt-on,lang-playback,1(hook_3))
exten => _*95.,n,Macro(hangupcall,)

exten => en,1(hook_0),Read(fromext,call-fwd-no-ans&please-enter-your-extension-then-press-pound,,,,)
exten => en,n,Return()
exten => en,n(hook_1),Read(toext,agent-newlocation,,,,)
exten => en,n,Return()
exten => en,n(hook_2),Playback(call-fwd-no-ans&for&extension)
exten => en,n,SayDigits(${fromext})
exten => en,n,Playback(is-set-to)
exten => en,n,SayDigits(${toext})
exten => en,n,Return()
exten => en,n(hook_3),Playback(call-fwd-no-ans&for&extension)
exten => en,n,SayDigits(${fromext})
exten => en,n,Playback(is-set-to)
exten => en,n,SayDigits(${toext})
exten => en,n,Return()

exten => ja,1(hook_0),Read(fromext,call-fwd-no-ans&extension&please-enter-your&vm-press-pound,,,,)
exten => ja,n,Return()
exten => ja,n(hook_1),Read(toext,ent-target-attendant&then-press-pound,,,,)
exten => ja,n,Return()
exten => ja,n(hook_2),Playback(extension)
exten => ja,n,SayDigits(${fromext})
exten => ja,n,Playback(jp-no&call-fwd-no-ans&jp-wo)
exten => ja,n,SayDigits(${toext})
exten => ja,n,Playback(is-set-to)
exten => ja,n,Return()
exten => ja,n(hook_3),Playback(extension)
exten => ja,n,SayDigits(${fromext})
exten => ja,n,Playback(jp-no&call-fwd-no-ans&jp-wo)
exten => ja,n,SayDigits(${toext})
exten => ja,n,Playback(is-set-to)
exten => ja,n,Return()

;--== end of [app-cf-unavailable-prompt-on] ==--;


[app-cf-unavailable-on]
exten => lang-playback,1,GosubIf($[${DIALPLAN_EXISTS(app-cf-unavailable-on,${CHANNEL(language)})}]?app-cf-unavailable-on,${CHANNEL(language)},${ARG1}():app-cf-unavailable-on,en,${ARG1}())
exten => lang-playback,n,Return()

exten => *52,1,Answer
exten => *52,n,Wait(1)
exten => *52,n,Macro(user-callerid,)
exten => *52,n,Set(fromext=${AMPUSER})
exten => *52,n,GotoIf($["${fromext}"!=""]?startread)
exten => *52,n,Playback(agent-loggedoff)
exten => *52,n,Macro(hangupcall,)
exten => *52,n(startread),Gosub(app-cf-unavailable-on,lang-playback,1(hook_1))
exten => *52,n,GotoIf($["${toext}"=""]?startread)
exten => *52,n,Wait(1)
exten => *52,n,Set(DB(CFU/${fromext})=${toext})
exten => *52,n,Gosub(app-cf-unavailable-on,lang-playback,1(hook_2))
exten => *52,n,Macro(hangupcall,)

exten => _*52.,1,Answer
exten => _*52.,n,Wait(1)
exten => _*52.,n,Macro(user-callerid,)
exten => _*52.,n,Set(fromext=${AMPUSER})
exten => _*52.,n,Set(toext=${EXTEN:3})
exten => _*52.,n,Set(DB(CFU/${fromext})=${toext})
exten => _*52.,n(startread),Gosub(app-cf-unavailable-on,lang-playback,1(hook_3))
exten => _*52.,n,Macro(hangupcall,)

exten => en,1(hook_0),Read(fromext,call-fwd-no-ans&please-enter-your-extension-then-press-pound,,,,)
exten => en,n,Return()
exten => en,n(hook_1),Read(toext,agent-newlocation,,,,)
exten => en,n,Return()
exten => en,n(hook_2),Playback(call-fwd-no-ans&for&extension)
exten => en,n,SayDigits(${fromext})
exten => en,n,Playback(is-set-to)
exten => en,n,SayDigits(${toext})
exten => en,n,Return()
exten => en,n(hook_3),Playback(call-fwd-no-ans&for&extension)
exten => en,n,SayDigits(${fromext})
exten => en,n,Playback(is-set-to)
exten => en,n,SayDigits(${toext})
exten => en,n,Return()

exten => ja,1(hook_0),Read(fromext,call-fwd-no-ans&extension&please-enter-your&vm-press-pound,,,,)
exten => ja,n,Return()
exten => ja,n(hook_1),Read(toext,ent-target-attendant&then-press-pound,,,,)
exten => ja,n,Return()
exten => ja,n(hook_2),Playback(extension)
exten => ja,n,SayDigits(${fromext})
exten => ja,n,Playback(jp-no&call-fwd-no-ans&jp-wo)
exten => ja,n,SayDigits(${toext})
exten => ja,n,Playback(is-set-to)
exten => ja,n,Return()
exten => ja,n(hook_3),Playback(extension)
exten => ja,n,SayDigits(${fromext})
exten => ja,n,Playback(jp-no&call-fwd-no-ans&jp-wo)
exten => ja,n,SayDigits(${toext})
exten => ja,n,Playback(is-set-to)
exten => ja,n,Return()

;--== end of [app-cf-unavailable-on] ==--;


[app-cf-prompting-on]
exten => lang-playback,1,GosubIf($[${DIALPLAN_EXISTS(app-cf-prompting-on,${CHANNEL(language)})}]?app-cf-prompting-on,${CHANNEL(language)},${ARG1}():app-cf-prompting-on,en,${ARG1}())
exten => lang-playback,n,Return()

exten => *93,1,Answer
exten => *93,n,Wait(1)
exten => *93,n,Macro(user-callerid,)
exten => *93,n,Gosub(app-cf-prompting-on,lang-playback,1(hook_0))
exten => *93,n,Set(fromext=${IF($["foo${fromext}"="foo"]?${AMPUSER}:${fromext})})
exten => *93,n,Wait(1)
exten => *93,n(startread),Gosub(app-cf-prompting-on,lang-playback,1(hook_1))
exten => *93,n,GotoIf($["foo${toext}"="foo"]?startread)
exten => *93,n,Wait(1)
exten => *93,n,Set(DB(CF/${fromext})=${toext})
exten => *93,n,Set(STATE=BUSY)
exten => *93,n,Gosub(app-cf-prompting-on,sstate,1())
exten => *93,n,Gosub(app-cf-prompting-on,lang-playback,1(hook_2))
exten => *93,n,Macro(hangupcall,)

exten => _*93.,1,Answer
exten => _*93.,n,Wait(1)
exten => _*93.,n,Macro(user-callerid,)
exten => _*93.,n,Set(fromext=${AMPUSER})
exten => _*93.,n,Set(toext=${EXTEN:3})
exten => _*93.,n,Set(DB(CF/${fromext})=${toext})
exten => _*93.,n,Set(STATE=BUSY)
exten => _*93.,n,Gosub(app-cf-prompting-on,sstate,1())
exten => _*93.,n,Gosub(app-cf-prompting-on,lang-playback,1(hook_3))
exten => _*93.,n,Macro(hangupcall,)

exten => sstate,1,Set(DEVICE_STATE(Custom:CF${fromext})=${STATE})
exten => sstate,n,Set(DEVICES=${DB(AMPUSER/${fromext}/device)})
exten => sstate,n,GotoIf($["${DEVICES}" = "" ]?return)
exten => sstate,n,Set(LOOPCNT=${FIELDQTY(DEVICES,&)})
exten => sstate,n,Set(ITER=1)
exten => sstate,n(begin),Set(DEVICE_STATE(Custom:DEVCF${CUT(DEVICES,&,${ITER})})=${STATE})
exten => sstate,n,Set(ITER=$[${ITER} + 1])
exten => sstate,n,GotoIf($[${ITER} <= ${LOOPCNT}]?begin)
exten => sstate,n(return),Return()

exten => en,1(hook_0),Read(fromext,call-fwd-unconditional&please-enter-your-extension-then-press-pound,,,,)
exten => en,n,Return()
exten => en,n(hook_1),Read(toext,agent-newlocation,,,,)
exten => en,n,Return()
exten => en,n(hook_2),Playback(call-fwd-unconditional&for&extension)
exten => en,n,SayDigits(${fromext})
exten => en,n,Playback(is-set-to)
exten => en,n,SayDigits(${toext})
exten => en,n,Return()
exten => en,n(hook_3),Playback(call-fwd-unconditional&for&extension)
exten => en,n,SayDigits(${fromext})
exten => en,n,Playback(is-set-to)
exten => en,n,SayDigits(${toext})
exten => en,n,Return()

exten => ja,1(hook_0),Read(fromext,call-fwd-unconditional&extension&please-enter-your&vm-press-pound,,,,)
exten => ja,n,Return()
exten => ja,n(hook_1),Read(toext,ent-target-attendant&vm-press-pound,,,,)
exten => ja,n,Return()
exten => ja,n(hook_2),Playback(extension)
exten => ja,n,SayDigits(${fromext})
exten => ja,n,Playback(jp-no&call-fwd-unconditional&jp-wo)
exten => ja,n,SayDigits(${toext})
exten => ja,n,Playback(is-set-to)
exten => ja,n,Return()
exten => ja,n(hook_3),Playback(extension)
exten => ja,n,SayDigits(${fromext})
exten => ja,n,Playback(jp-no&call-fwd-unconditional&jp-wo)
exten => ja,n,SayDigits(${toext})
exten => ja,n,Playback(is-set-to)
exten => ja,n,Return()

;--== end of [app-cf-prompting-on] ==--;


[app-cf-unavailable-off]
exten => lang-playback,1,GosubIf($[${DIALPLAN_EXISTS(app-cf-unavailable-off,${CHANNEL(language)})}]?app-cf-unavailable-off,${CHANNEL(language)},${ARG1}():app-cf-unavailable-off,en,${ARG1}())
exten => lang-playback,n,Return()

exten => *53,1,Answer
exten => *53,n,Wait(1)
exten => *53,n,Macro(user-callerid,)
exten => *53,n,Set(fromext=${AMPUSER})
exten => *53,n,Noop(Deleting: CFU/${fromext} ${DB_DELETE(CFU/${fromext})})
exten => *53,n,Gosub(app-cf-unavailable-off,lang-playback,1(hook_0))
exten => *53,n,Macro(hangupcall,)

exten => _*53.,1,Answer
exten => _*53.,n,Wait(1)
exten => _*53.,n,Macro(user-callerid,)
exten => _*53.,n,Set(fromext=${EXTEN:3})
exten => _*53.,n,Noop(Deleting: CFU/${fromext} ${DB_DELETE(CFU/${fromext})})
exten => _*53.,n,Gosub(app-cf-unavailable-off,lang-playback,1(hook_1))
exten => _*53.,n,Macro(hangupcall,)

exten => en,1(hook_0),Playback(call-fwd-no-ans&de-activated)
exten => en,n,Return()
exten => en,n(hook_1),Playback(call-fwd-no-ans&for&extension)
exten => en,n,SayDigits(${fromext})
exten => en,n,Playback(cancelled)
exten => en,n,Return()

exten => ja,1(hook_0),Playback(call-fwd-no-ans&de-activated)
exten => ja,n,Return()
exten => ja,n(hook_1),Playback(extension)
exten => ja,n,SayDigits(${fromext})
exten => ja,n,Playback(jp-no&call-fwd-no-ans&jp-wo)
exten => ja,n,Playback(cancelled)
exten => ja,n,Return()

;--== end of [app-cf-unavailable-off] ==--;


[ext-cf-hints]
exten => _*9610999.,1,Set(toext=${EXTEN:8})
exten => _*9610999.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96201.,1,Set(toext=${EXTEN:6})
exten => _*96201.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96202.,1,Set(toext=${EXTEN:6})
exten => _*96202.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96203.,1,Set(toext=${EXTEN:6})
exten => _*96203.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96204.,1,Set(toext=${EXTEN:6})
exten => _*96204.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96205.,1,Set(toext=${EXTEN:6})
exten => _*96205.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96206.,1,Set(toext=${EXTEN:6})
exten => _*96206.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96207.,1,Set(toext=${EXTEN:6})
exten => _*96207.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96227.,1,Set(toext=${EXTEN:6})
exten => _*96227.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96228.,1,Set(toext=${EXTEN:6})
exten => _*96228.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96229.,1,Set(toext=${EXTEN:6})
exten => _*96229.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96230.,1,Set(toext=${EXTEN:6})
exten => _*96230.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96231.,1,Set(toext=${EXTEN:6})
exten => _*96231.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96232.,1,Set(toext=${EXTEN:6})
exten => _*96232.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96233.,1,Set(toext=${EXTEN:6})
exten => _*96233.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96234.,1,Set(toext=${EXTEN:6})
exten => _*96234.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96235.,1,Set(toext=${EXTEN:6})
exten => _*96235.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96236.,1,Set(toext=${EXTEN:6})
exten => _*96236.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96237.,1,Set(toext=${EXTEN:6})
exten => _*96237.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96238.,1,Set(toext=${EXTEN:6})
exten => _*96238.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96239.,1,Set(toext=${EXTEN:6})
exten => _*96239.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96240.,1,Set(toext=${EXTEN:6})
exten => _*96240.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96241.,1,Set(toext=${EXTEN:6})
exten => _*96241.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96242.,1,Set(toext=${EXTEN:6})
exten => _*96242.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96243.,1,Set(toext=${EXTEN:6})
exten => _*96243.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96244.,1,Set(toext=${EXTEN:6})
exten => _*96244.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96245.,1,Set(toext=${EXTEN:6})
exten => _*96245.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96246.,1,Set(toext=${EXTEN:6})
exten => _*96246.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96247.,1,Set(toext=${EXTEN:6})
exten => _*96247.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96248.,1,Set(toext=${EXTEN:6})
exten => _*96248.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96249.,1,Set(toext=${EXTEN:6})
exten => _*96249.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96250.,1,Set(toext=${EXTEN:6})
exten => _*96250.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96251.,1,Set(toext=${EXTEN:6})
exten => _*96251.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96252.,1,Set(toext=${EXTEN:6})
exten => _*96252.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96253.,1,Set(toext=${EXTEN:6})
exten => _*96253.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96254.,1,Set(toext=${EXTEN:6})
exten => _*96254.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96255.,1,Set(toext=${EXTEN:6})
exten => _*96255.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96256.,1,Set(toext=${EXTEN:6})
exten => _*96256.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96257.,1,Set(toext=${EXTEN:6})
exten => _*96257.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96258.,1,Set(toext=${EXTEN:6})
exten => _*96258.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96259.,1,Set(toext=${EXTEN:6})
exten => _*96259.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96260.,1,Set(toext=${EXTEN:6})
exten => _*96260.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96261.,1,Set(toext=${EXTEN:6})
exten => _*96261.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96262.,1,Set(toext=${EXTEN:6})
exten => _*96262.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96263.,1,Set(toext=${EXTEN:6})
exten => _*96263.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96264.,1,Set(toext=${EXTEN:6})
exten => _*96264.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96265.,1,Set(toext=${EXTEN:6})
exten => _*96265.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96266.,1,Set(toext=${EXTEN:6})
exten => _*96266.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96267.,1,Set(toext=${EXTEN:6})
exten => _*96267.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96268.,1,Set(toext=${EXTEN:6})
exten => _*96268.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96269.,1,Set(toext=${EXTEN:6})
exten => _*96269.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96270.,1,Set(toext=${EXTEN:6})
exten => _*96270.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96272.,1,Set(toext=${EXTEN:6})
exten => _*96272.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96273.,1,Set(toext=${EXTEN:6})
exten => _*96273.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96281.,1,Set(toext=${EXTEN:6})
exten => _*96281.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96282.,1,Set(toext=${EXTEN:6})
exten => _*96282.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96283.,1,Set(toext=${EXTEN:6})
exten => _*96283.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96284.,1,Set(toext=${EXTEN:6})
exten => _*96284.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96285.,1,Set(toext=${EXTEN:6})
exten => _*96285.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96339.,1,Set(toext=${EXTEN:6})
exten => _*96339.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96450.,1,Set(toext=${EXTEN:6})
exten => _*96450.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96827.,1,Set(toext=${EXTEN:6})
exten => _*96827.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96829.,1,Set(toext=${EXTEN:6})
exten => _*96829.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96835.,1,Set(toext=${EXTEN:6})
exten => _*96835.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96838.,1,Set(toext=${EXTEN:6})
exten => _*96838.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96840.,1,Set(toext=${EXTEN:6})
exten => _*96840.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96845.,1,Set(toext=${EXTEN:6})
exten => _*96845.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96847.,1,Set(toext=${EXTEN:6})
exten => _*96847.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96848.,1,Set(toext=${EXTEN:6})
exten => _*96848.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96852.,1,Set(toext=${EXTEN:6})
exten => _*96852.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96884.,1,Set(toext=${EXTEN:6})
exten => _*96884.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96900.,1,Set(toext=${EXTEN:6})
exten => _*96900.,n,Goto(app-cf-toggle,*96,setdirect)

exten => _*96XXX,1,Goto(app-cf-toggle,*96,1)

exten => _*96XXXXX,1,Goto(app-cf-toggle,*96,1)

exten => _*96X.,hint,Custom:DEVCF${EXTEN:3}
;--== end of [ext-cf-hints] ==--;


[sub-record-cancel]
exten => s,1,Return()

;--== end of [sub-record-cancel] ==--;


[sub-record-check]
exten => s,1,GotoIf($[${LEN(${FROMEXTEN})}]?initialized)
exten => s,n,Set(__REC_STATUS=INITIALIZED)
exten => s,n,Set(NOW=${EPOCH})
exten => s,n,Set(__DAY=${STRFTIME(${NOW},,%d)})
exten => s,n,Set(__MONTH=${STRFTIME(${NOW},,%m)})
exten => s,n,Set(__YEAR=${STRFTIME(${NOW},,%Y)})
exten => s,n,Set(__TIMESTR=${YEAR}${MONTH}${DAY}-${STRFTIME(${NOW},,%H%M%S)})
exten => s,n,Set(__FROMEXTEN=${IF($[${LEN(${AMPUSER})}]?${AMPUSER}:${IF($[${LEN(${REALCALLERIDNUM})}]?${REALCALLERIDNUM}:unknown)})})
exten => s,n,Set(__MON_FMT=${IF($["${MIXMON_FORMAT}"="wav49"]?WAV:${MIXMON_FORMAT})})
exten => s,n(initialized),Noop(Recordings initialized)
exten => s,n,ExecIf($[!${LEN(${ARG3})}]?Set(ARG3=dontcare))
exten => s,n,Set(REC_POLICY_MODE_SAVE=${REC_POLICY_MODE})
exten => s,n,ExecIf($["${BLINDTRANSFER}${ATTENDEDTRANSFER}" != ""]?Set(REC_STATUS=NO))
exten => s,n(next),GotoIf($[${LEN(${ARG1})}]?checkaction)
exten => s,n(recorderror),Playback(something-terribly-wrong,error)
exten => s,n,Hangup
exten => s,n(checkaction),GotoIf($[${DIALPLAN_EXISTS(sub-record-check,${ARG1})}]?sub-record-check,${ARG1},1)
exten => s,n,Noop(Generic ${ARG1} Recording Check - ${FROMEXTEN} ${ARG2})
exten => s,n,Gosub(recordcheck,1(${ARG3},${ARG1},${ARG2}))
exten => s,n,Return()

exten => recordcheck,1,Noop(Starting recording check against ${ARG1})
exten => recordcheck,n,Goto(${ARG1})
exten => recordcheck,n(dontcare),Return()
exten => recordcheck,n(always),Noop(Detected legacy "always" entry. Mapping to "force")
exten => recordcheck,n(force),Set(__REC_POLICY_MODE=FORCE)
exten => recordcheck,n,GotoIf($["${REC_STATUS}"!="RECORDING"]?startrec)
exten => recordcheck,n,Return()
exten => recordcheck,n(delayed),Noop(Detected legacy "delayed" entry. Mapping to "yes")
exten => recordcheck,n(yes),ExecIf($["${REC_POLICY_MODE}" = "NEVER" | "${REC_POLICY_MODE}" = "NO" | "${REC_STATUS}" = "RECORDING"]?Return())
exten => recordcheck,n,Set(__REC_POLICY_MODE=YES)
exten => recordcheck,n,Goto(startrec)
exten => recordcheck,n(no),Set(__REC_POLICY_MODE=NO)
exten => recordcheck,n,Return()
exten => recordcheck,n(never),Set(__REC_POLICY_MODE=NEVER)
exten => recordcheck,n,Goto(stoprec)
exten => recordcheck,n(startrec),Noop(Starting recording: ${ARG2}, ${ARG3})
exten => recordcheck,n,Set(__CALLFILENAME=${ARG2}-${ARG3}-${FROMEXTEN}-${TIMESTR}-${UNIQUEID})
exten => recordcheck,n,MixMonitor(${MIXMON_DIR}${YEAR}/${MONTH}/${DAY}/${CALLFILENAME}.${MON_FMT},abi(LOCAL_MIXMON_ID)${MIXMON_BEEP},${MIXMON_POST})
exten => recordcheck,n,Set(__MIXMON_ID=${LOCAL_MIXMON_ID})
exten => recordcheck,n,Set(__RECORD_ID=${CHANNEL(name)})
exten => recordcheck,n,Set(__REC_STATUS=RECORDING)
exten => recordcheck,n,Set(CDR(recordingfile)=${CALLFILENAME}.${MON_FMT})
exten => recordcheck,n,Return()
exten => recordcheck,n(stoprec),Noop(Stopping recording: ${ARG2}, ${ARG3})
exten => recordcheck,n,Set(__REC_STATUS=STOPPED)
exten => recordcheck,n,System(${AMPBIN}/stoprecording.php "${CHANNEL(name)}")
exten => recordcheck,n,Return()

exten => out,1,Noop(Outbound Recording Check from ${FROMEXTEN} to ${ARG2})
exten => out,n,Set(RECMODE=${DB(AMPUSER/${FROMEXTEN}/recording/out/external)})
exten => out,n,ExecIf($[!${LEN(${RECMODE})} | "${RECMODE}" = "dontcare"]?Goto(routewins))
exten => out,n,ExecIf($["${ARG3}" = "never" | "${ARG3}" = "force"]?Goto(routewins))
exten => out,n(extenwins),Gosub(recordcheck,1(${RECMODE},out,${ARG2}))
exten => out,n,Return()
exten => out,n(routewins),Gosub(recordcheck,1(${ARG3},out,${ARG2}))
exten => out,n,Return()

exten => in,1,Noop(Inbound Recording Check to ${ARG2})
exten => in,n,Set(FROMEXTEN=unknown)
exten => in,n,ExecIf($[${LEN(${CALLERID(num)})}]?Set(FROMEXTEN=${CALLERID(num)}))
exten => in,n,Gosub(recordcheck,1(${ARG3},in,${ARG2}))
exten => in,n,Return()

exten => exten,1,Noop(Exten Recording Check between ${FROMEXTEN} and ${ARG2})
exten => exten,n,Set(CALLTYPE=${IF($[${LEN(${FROM_DID})}]?external:internal)})
exten => exten,n,ExecIf(${LEN(${CALLTYPE_OVERRIDE})}?Set(CALLTYPE=${CALLTYPE_OVERRIDE}))
exten => exten,n,Set(CALLEE=${DB(AMPUSER/${ARG2}/recording/in/${CALLTYPE})})
exten => exten,n,ExecIf($[!${LEN(${CALLEE})}]?Set(CALLEE=dontcare))
exten => exten,n,GotoIf($["${CALLTYPE}"="external"]?callee)
exten => exten,n,GotoIf($["${CALLEE}"="dontcare"]?caller)
exten => exten,n,ExecIf($[${LEN(${DB(AMPUSER/${FROMEXTEN}/recording/priority)})}]?Set(CALLER_PRI=${DB(AMPUSER/${FROMEXTEN}/recording/priority)}):Set(CALLER_PRI=0))
exten => exten,n,ExecIf($[${LEN(${DB(AMPUSER/${ARG2}/recording/priority)})}]?Set(CALLEE_PRI=${DB(AMPUSER/${ARG2}/recording/priority)}):Set(CALLEE_PRI=0))
exten => exten,n,GotoIf($["${CALLER_PRI}"="${CALLEE_PRI}"]?${REC_POLICY}:${IF($[${CALLER_PRI}>${CALLEE_PRI}]?caller:callee)})
exten => exten,n(callee),Gosub(recordcheck,1(${CALLEE},${CALLTYPE},${ARG2}))
exten => exten,n,Return()
exten => exten,n(caller),Set(RECMODE=${DB(AMPUSER/${FROMEXTEN}/recording/out/internal)})
exten => exten,n,ExecIf($[!${LEN(${RECMODE})}]?Set(RECMODE=dontcare))
exten => exten,n,ExecIf($["${RECMODE}"="dontcare"]?Set(RECMODE=${CALLEE}))
exten => exten,n,Gosub(recordcheck,1(${RECMODE},${CALLTYPE},${ARG2}))
exten => exten,n,Return()

exten => conf,1,Noop(Conference Recording Check ${FROMEXTEN} to ${ARG2})
exten => conf,n,Gosub(recconf,1(${ARG2},${ARG2},${ARG3}))
exten => conf,n,Return()

exten => page,1,Noop(Paging Recording Check ${FROMEXTEN} to ${ARG2})
exten => page,n,GosubIf($["${REC_POLICY_MODE}"="always"]?recconf,1(${ARG2},${FROMEXTEN},${ARG3}))
exten => page,n,Return()

exten => recconf,1,Noop(Setting up recording: ${ARG1}, ${ARG2}, ${ARG3})
exten => recconf,n,Set(__CALLFILENAME=${IF($[${CONFBRIDGE_INFO(parties,${ARG2})}]?${DB(RECCONF/${ARG2})}:${ARG1}-${ARG2}-${ARG3}-${TIMESTR}-${UNIQUEID})})
exten => recconf,n,ExecIf($[!${CONFBRIDGE_INFO(parties,${ARG2})}]?Set(DB(RECCONF/${ARG2})=${CALLFILENAME}))
exten => recconf,n,Set(CONFBRIDGE(bridge,record_file)=${MIXMON_DIR}${YEAR}/${MONTH}/${DAY}/${CALLFILENAME}.${MON_FMT})
exten => recconf,n,ExecIf($["${ARG3}"!="always"]?Return())
exten => recconf,n,Set(CONFBRIDGE(bridge,record_conference)=yes)
exten => recconf,n,Set(__REC_STATUS=RECORDING)
exten => recconf,n,Set(CDR(recordingfile)=${IF($[${CONFBRIDGE_INFO(parties,${ARG2})}]?${CALLFILENAME}.${MON_FMT}:${CALLFILENAME}.${MON_FMT})})
exten => recconf,n,Noop(${MIXMONITOR_FILENAME})
exten => recconf,n,Set(CHANNEL(hangup_handler_push)=sub-record-hh-check,s,1)
exten => recconf,n,Return()

exten => recq,1,Noop(Setting up recording: ${ARG1}, ${ARG2}, ${ARG3})
exten => recq,n,Set(MONITOR_FILENAME=${MIXMON_DIR}${YEAR}/${MONTH}/${DAY}/${CALLFILENAME})
exten => recq,n,MixMonitor(${MONITOR_FILENAME}.${MON_FMT},${MONITOR_OPTIONS}${MIXMON_BEEP},${MIXMON_POST})
exten => recq,n,Set(__REC_STATUS=RECORDING)
exten => recq,n,Set(CDR(recordingfile)=${CALLFILENAME}.${MON_FMT})
exten => recq,n,Return()

exten => parking,1,Noop(User ${ARG2} picked up a parked call)
exten => parking,n,Set(USER=${ARG2})
exten => parking,n,ExecIf($[!${LEN(${ARG2})}]?Set(USER=unknown))
exten => parking,n,Set(RECMODE=${DB(AMPUSER/${ARG2}/recording/out/internal)})
exten => parking,n,ExecIf($[!${LEN(${RECMODE})}]?Set(RECMODE=dontcare))
exten => parking,n,Gosub(recordcheck,1(${RECMODE},parked,${USER}))
exten => parking,n,Return()

;--== end of [sub-record-check] ==--;


[sub-record-hh-check]
exten => _.,1,Noop(Callee: ${MIXMONITOR_FILENAME})
exten => _.,n(exit),Return()

;--== end of [sub-record-hh-check] ==--;


[macro-one-touch-record]
exten => s,1,Set(ONETOUCH_REC_SCRIPT_STATUS=)
exten => s,n,System(${AMPBIN}/one_touch_record.php "${CHANNEL(name)}")
exten => s,n,Noop(ONETOUCH_REC_SCRIPT_STATUS: [${ONETOUCH_REC_SCRIPT_STATUS}])
exten => s,n,Noop(REC_STATUS: [${REC_STATUS}])
exten => s,n,GotoIf($["${ONETOUCH_REC_SCRIPT_STATUS:0:6}"="DENIED"]?denied)
exten => s,n,ExecIf($["${REC_STATUS}"="STOPPED"]?Playback(beep&beep))
exten => s,n,GotoIf($["${REC_STATUS}"="STOPPED"]?end)
exten => s,n,GotoIf($["${REC_STATUS}"="RECORDING"]?startrec)
exten => s,n(startrec),MixMonitor(${MIXMON_DIR}${YEAR}/${MONTH}/${DAY}/${CALLFILENAME}.${MON_FMT},ai(LOCAL_MIXMON_ID)${MIXMON_BEEP},${MIXMON_POST})
exten => s,n,ExecIf($["${REC_STATUS}"="RECORDING"]?Playback(beep))
exten => s,n(denied),ExecIf($["${ONETOUCH_REC_SCRIPT_STATUS:0:6}"="DENIED"]?Playback(access-denied))
exten => s,n(end),MacroExit()

;--== end of [macro-one-touch-record] ==--;


[app-callwaiting-cwoff]
exten => *71,1,Macro(user-callerid,)
exten => *71,n,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *71,n,Set(CONNECTEDLINE(name,i)=Call Waiting: OFF)
exten => *71,n,Set(CONNECTEDLINE(num,i)=${AMPUSER})
exten => *71,n,Answer
exten => *71,n,Wait(1)
exten => *71,n,Noop(Deleting: CW/${AMPUSER} ${DB_DELETE(CW/${AMPUSER})})
exten => *71,n(hook_1),Playback(call-waiting&de-activated)
exten => *71,n,Macro(hangupcall,)

;--== end of [app-callwaiting-cwoff] ==--;


[app-callwaiting-cwon]
exten => *70,1,Macro(user-callerid,)
exten => *70,n,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *70,n,Set(CONNECTEDLINE(name,i)=Call Waiting: ON)
exten => *70,n,Set(CONNECTEDLINE(num,i)=${AMPUSER})
exten => *70,n,Answer
exten => *70,n,Wait(1)
exten => *70,n,Set(DB(CW/${AMPUSER})=ENABLED)
exten => *70,n(hook_1),Playback(call-waiting&activated)
exten => *70,n,Macro(hangupcall,)

;--== end of [app-callwaiting-cwon] ==--;


[directory]
exten => 4,1,Answer
exten => 4,n,Wait(1)
exten => 4,n,AGI(directory.agi,dir=4,retivr=false)
exten => 4,n(dial-4),Ringing()
exten => 4,n,Goto(from-internal,${DIR_DIAL},1)

exten => 1,1,Answer
exten => 1,n,Wait(1)
exten => 1,n,AGI(directory.agi,dir=1,retivr=false)
exten => 1,n(dial-1),Ringing()
exten => 1,n,Goto(from-internal,${DIR_DIAL},1)

exten => invalid,1(invalid),Playback(${DIR_INVALID_RECORDING})
exten => invalid,n,Ringing()
exten => invalid,n,Goto(${DIR_INVALID_CONTEXT},${DIR_INVALID_EXTEN},${DIR_INVALID_PRI})

exten => retivr,1(retivr),Playback(${DIR_INVALID_RECORDING})
exten => retivr,n,Goto(${IVR_CONTEXT},return,1)

exten => h,1,Macro(hangupcall,)

;--== end of [directory] ==--;


[disa-dial]
exten => _[0-9a-zA-Z],1,Noop(called ${EXTEN} in ${DISACONTEXT} by ID: ${CUT(DISA,^,2)})
exten => _[0-9a-zA-Z],n,Dial(Local/${EXTEN}@${DISACONTEXT},300,${HANGUP})
exten => _[0-9a-zA-Z],n,Gosub(s-${DIALSTATUS},1())
exten => _[0-9a-zA-Z],n,Goto(${CUT(DISA,^,1)},${CUT(DISA,^,2)},${CUT(DISA,^,3)})

exten => _[0-9a-zA-Z*#].,1,Noop(called ${EXTEN} in ${DISACONTEXT} by ID: ${CUT(DISA,^,2)})
exten => _[0-9a-zA-Z*#].,n,Dial(Local/${EXTEN}@${DISACONTEXT},300,${HANGUP})
exten => _[0-9a-zA-Z*#].,n,Gosub(s-${DIALSTATUS},1())
exten => _[0-9a-zA-Z*#].,n,Goto(${CUT(DISA,^,1)},${CUT(DISA,^,2)},${CUT(DISA,^,3)})

exten => s-ANSWER,1,Return()

exten => s-CANCEL,1,Return()

exten => s-BUSY,1,Playtones(busy)
exten => s-BUSY,n,Wait(3)
exten => s-BUSY,n,Return()

exten => _s-.,1,Noop(DISA Dial failed due to ${DIALSTATUS} - returning to dial tone)
exten => _s-.,n,Playtones(congestion)
exten => _s-.,n,Wait(3)
exten => _s-.,n,StopPlaytones
exten => _s-.,n,Return()

;--== end of [disa-dial] ==--;


[app-dnd-off]
exten => *79,1,Answer
exten => *79,n,Wait(1)
exten => *79,n,Macro(user-callerid,)
exten => *79,n,Noop(Deleting: DND/${AMPUSER} ${DB_DELETE(DND/${AMPUSER})})
exten => *79,n,Set(STATE=UNAVAILABLE)
exten => *79,n,Gosub(app-dnd-off,sstate,1())
exten => *79,n(hook_1),Playback(do-not-disturb&de-activated)
exten => *79,n,Macro(hangupcall,)

exten => sstate,1,Set(DEVICE_STATE(Custom:DND${AMPUSER})=${STATE})
exten => sstate,n,Set(DEVICES=${DB(AMPUSER/${AMPUSER}/device)})
exten => sstate,n,GotoIf($["${DEVICES}" = "" ]?return)
exten => sstate,n,Set(LOOPCNT=${FIELDQTY(DEVICES,&)})
exten => sstate,n,Set(ITER=1)
exten => sstate,n(begin),Set(DEVICE_STATE(Custom:DEVDND${CUT(DEVICES,&,${ITER})})=${STATE})
exten => sstate,n,Set(ITER=$[${ITER} + 1])
exten => sstate,n,GotoIf($[${ITER} <= ${LOOPCNT}]?begin)
exten => sstate,n(return),Return()

;--== end of [app-dnd-off] ==--;


[app-dnd-on]
exten => *78,1,Answer
exten => *78,n,Wait(1)
exten => *78,n,Macro(user-callerid,)
exten => *78,n,Set(DB(DND/${AMPUSER})=YES)
exten => *78,n,Set(STATE=BUSY)
exten => *78,n,Gosub(app-dnd-on,sstate,1())
exten => *78,n(hook_1),Playback(do-not-disturb&activated)
exten => *78,n,Macro(hangupcall,)

exten => sstate,1,Set(DEVICE_STATE(Custom:DND${AMPUSER})=${STATE})
exten => sstate,n,Set(DEVICES=${DB(AMPUSER/${AMPUSER}/device)})
exten => sstate,n,GotoIf($["${DEVICES}" = "" ]?return)
exten => sstate,n,Set(LOOPCNT=${FIELDQTY(DEVICES,&)})
exten => sstate,n,Set(ITER=1)
exten => sstate,n(begin),Set(DEVICE_STATE(Custom:DEVDND${CUT(DEVICES,&,${ITER})})=${STATE})
exten => sstate,n,Set(ITER=$[${ITER} + 1])
exten => sstate,n,GotoIf($[${ITER} <= ${LOOPCNT}]?begin)
exten => sstate,n(return),Return()

;--== end of [app-dnd-on] ==--;


[app-dnd-toggle]
exten => *76,1,Answer
exten => *76,n,Wait(1)
exten => *76,n,Macro(user-callerid,)
exten => *76,n,GotoIf($["${DB(DND/${AMPUSER})}" = ""]?activate:deactivate)
exten => *76,n(activate),Set(DB(DND/${AMPUSER})=YES)
exten => *76,n,Set(STATE=BUSY)
exten => *76,n,Gosub(app-dnd-toggle,sstate,1())
exten => *76,n(hook_on),Playback(do-not-disturb&activated)
exten => *76,n,Macro(hangupcall,)
exten => *76,n(deactivate),Noop(Deleting: DND/${AMPUSER} ${DB_DELETE(DND/${AMPUSER})})
exten => *76,n,Set(STATE=UNAVAILABLE)
exten => *76,n,Gosub(app-dnd-toggle,sstate,1())
exten => *76,n(hook_off),Playback(do-not-disturb&de-activated)
exten => *76,n,Macro(hangupcall,)

exten => sstate,1,Set(DEVICE_STATE(Custom:DND${AMPUSER})=${STATE})
exten => sstate,n,Set(DEVICES=${DB(AMPUSER/${AMPUSER}/device)})
exten => sstate,n,GotoIf($["${DEVICES}" = "" ]?return)
exten => sstate,n,Set(LOOPCNT=${FIELDQTY(DEVICES,&)})
exten => sstate,n,Set(ITER=1)
exten => sstate,n(begin),Set(DEVICE_STATE(Custom:DEVDND${CUT(DEVICES,&,${ITER})})=${STATE})
exten => sstate,n,Set(ITER=$[${ITER} + 1])
exten => sstate,n,GotoIf($[${ITER} <= ${LOOPCNT}]?begin)
exten => sstate,n(return),Return()

;--== end of [app-dnd-toggle] ==--;


[ext-dnd-hints]
exten => _*76X.,1,Goto(app-dnd-toggle,*76,1)
exten => _*76X.,hint,Custom:DEVDND${EXTEN:3}

;--== end of [ext-dnd-hints] ==--;


[ext-featurecodes]
exten => *30,1,Goto(from-internal,*30,1)

exten => *31,1,Goto(from-internal,*31,1)

exten => 555,1,Goto(from-internal,555,1)

exten => 7777,1,Goto(from-internal,7777,1)

exten => *43,1,Goto(from-internal,*43,1)

exten => *60,1,Goto(from-internal,*60,1)

exten => *88,1,Goto(from-internal,*88,1)

exten => *85,1,Goto(from-internal,*85,1)

exten => *297,1,Goto(from-internal,*297,1)

exten => *295,1,Goto(from-internal,*295,1)

exten => *2911,1,Goto(from-internal,*298,1)

exten => *296,1,Goto(from-internal,*296,1)

exten => *294,1,Goto(from-internal,*294,1)

exten => *2912,1,Goto(from-internal,*2912,1)

exten => *2910,1,Goto(from-internal,*2910,1)

exten => *2710,1,Goto(from-internal,*2710,1)

exten => *2711,1,Goto(from-internal,*2711,1)

exten => *2712,1,Goto(from-internal,*2712,1)

exten => *2713,1,Goto(from-internal,*2713,1)

exten => *2714,1,Goto(from-internal,*2714,1)

exten => *2715,1,Goto(from-internal,*2715,1)

exten => *2716,1,Goto(from-internal,*2716,1)

exten => *2717,1,Goto(from-internal,*2717,1)

exten => *2718,1,Goto(from-internal,*2718,1)

exten => *2719,1,Goto(from-internal,*2719,1)

exten => *271,1,Goto(from-internal,*271,1)

exten => *2720,1,Goto(from-internal,*2720,1)

exten => *2721,1,Goto(from-internal,*2721,1)

exten => *2722,1,Goto(from-internal,*2722,1)

exten => *2723,1,Goto(from-internal,*2723,1)

exten => *2724,1,Goto(from-internal,*2724,1)

exten => *2725,1,Goto(from-internal,*2725,1)

exten => *2726,1,Goto(from-internal,*2726,1)

exten => *2727,1,Goto(from-internal,*2727,1)

exten => *2728,1,Goto(from-internal,*2728,1)

exten => *272,1,Goto(from-internal,*272,1)

exten => *2730,1,Goto(from-internal,*2730,1)

exten => *2731,1,Goto(from-internal,*2731,1)

exten => *2732,1,Goto(from-internal,*2732,1)

exten => *2733,1,Goto(from-internal,*2733,1)

exten => *2734,1,Goto(from-internal,*2734,1)

exten => *2735,1,Goto(from-internal,*2735,1)

exten => *2736,1,Goto(from-internal,*2736,1)

exten => *2737,1,Goto(from-internal,*2737,1)

exten => *2738,1,Goto(from-internal,*2738,1)

exten => *2739,1,Goto(from-internal,*2739,1)

exten => *273,1,Goto(from-internal,*273,1)

exten => *2740,1,Goto(from-internal,*2740,1)

exten => *2741,1,Goto(from-internal,*2741,1)

exten => *2742,1,Goto(from-internal,*2742,1)

exten => *2744,1,Goto(from-internal,*2744,1)

exten => *274,1,Goto(from-internal,*274,1)

exten => *275,1,Goto(from-internal,*275,1)

exten => *276,1,Goto(from-internal,*276,1)

exten => *277,1,Goto(from-internal,*277,1)

exten => *278,1,Goto(from-internal,*278,1)

exten => *279,1,Goto(from-internal,*279,1)

exten => *98,1,Goto(from-internal,*98,1)

;--== end of [ext-featurecodes] ==--;


[app-fmf-toggle]
exten => *21,1,Goto(app-fmf-toggle,s,start)

exten => s,1(start),Answer
exten => s,n,Wait(1)
exten => s,n,Macro(user-callerid,)
exten => s,n,GotoIf($["${DB(AMPUSER/${AMPUSER}/followme/ddial)}" = "EXTENSION"]?activate)
exten => s,n,GotoIf($["${DB(AMPUSER/${AMPUSER}/followme/ddial)}" = "DIRECT"]?deactivate:end)
exten => s,n(deactivate),Set(DB(AMPUSER/${AMPUSER}/followme/ddial)=EXTENSION)
exten => s,n,Set(STATE=NOT_INUSE)
exten => s,n,Gosub(app-fmf-toggle,sstate,1())
exten => s,n(hook_off),Playback(followme&de-activated)
exten => s,n(end),Macro(hangupcall,)
exten => s,n(activate),Set(DB(AMPUSER/${AMPUSER}/followme/ddial)=DIRECT)
exten => s,n,Set(STATE=INUSE)
exten => s,n,Gosub(app-fmf-toggle,sstate,1())
exten => s,n(hook_on),Playback(followme&activated)
exten => s,n,Macro(hangupcall,)

exten => sstate,1,Set(DEVICES=${DB(AMPUSER/${AMPUSER}/device)})
exten => sstate,n,GotoIf($["${DEVICES}" = "" ]?return)
exten => sstate,n,Set(LOOPCNT=${FIELDQTY(DEVICES,&)})
exten => sstate,n,Set(ITER=1)
exten => sstate,n(begin),Set(DEVICE_STATE(Custom:FOLLOWME${CUT(DEVICES,&,${ITER})})=${STATE})
exten => sstate,n,Set(ITER=$[${ITER} + 1])
exten => sstate,n,GotoIf($[${ITER} <= ${LOOPCNT}]?begin)
exten => sstate,n(return),Return()

;--== end of [app-fmf-toggle] ==--;


[ext-findmefollow]
exten => _*21X.,1,Goto(app-fmf-toggle,*21,1)
exten => _*21X.,hint,Custom:FOLLOWME${EXTEN:3}

exten => 143,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 139,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 135,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 136,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 137,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 138,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 140,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 141,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 142,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 145,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 146,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 147,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 148,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 101,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 102,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 106,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 128,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 131,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 100,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 9999,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 350,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 351,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 352,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 354,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 355,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 356,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 359,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 360,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 361,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 362,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 364,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 365,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 367,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 369,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 372,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 133,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 130,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 127,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 149,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 129,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 132,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 134,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 144,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 370,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 371,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 105,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 103,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 107,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 353,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 358,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 363,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 366,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 368,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 373,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 381,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 382,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 383,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 104,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 800,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 357,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 384,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 150,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => 152,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/ddial)} != 1 | "${DB(AMPUSER/${EXTEN}/followme/ddial)}" = "EXTENSION" ]?ext-local,${EXTEN},1:followme-check,${EXTEN},1)

exten => _FMX.,1,Goto(followme-check,${EXTEN:2},FMCID)

;--== end of [ext-findmefollow] ==--;


[fmgrps]
exten => _RG-143*.,1+1,Macro(dial,${DB(AMPUSER/143/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^143),${EXTEN:8})

exten => _RG-139*.,1+1,Macro(dial,${DB(AMPUSER/139/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^139),${EXTEN:8})

exten => _RG-135*.,1+1,Macro(dial,${DB(AMPUSER/135/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^135),${EXTEN:8})

exten => _RG-136*.,1+1,Macro(dial,${DB(AMPUSER/136/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^136),${EXTEN:8})

exten => _RG-137*.,1+1,Macro(dial,${DB(AMPUSER/137/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^137),${EXTEN:8})

exten => _RG-138*.,1+1,Macro(dial,${DB(AMPUSER/138/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^138),${EXTEN:8})

exten => _RG-140*.,1+1,Macro(dial,${DB(AMPUSER/140/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^140),${EXTEN:8})

exten => _RG-141*.,1+1,Macro(dial,${DB(AMPUSER/141/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^141),${EXTEN:8})

exten => _RG-142*.,1+1,Macro(dial,${DB(AMPUSER/142/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^142),${EXTEN:8})

exten => _RG-145*.,1+1,Macro(dial,${DB(AMPUSER/145/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^145),${EXTEN:8})

exten => _RG-146*.,1+1,Macro(dial,${DB(AMPUSER/146/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^146),${EXTEN:8})

exten => _RG-147*.,1+1,Macro(dial,${DB(AMPUSER/147/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^147),${EXTEN:8})

exten => _RG-148*.,1+1,Macro(dial,${DB(AMPUSER/148/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^148),${EXTEN:8})

exten => _RG-101*.,1+1,Macro(dial,${DB(AMPUSER/101/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^101),${EXTEN:8})

exten => _RG-102*.,1+1,Macro(dial,${DB(AMPUSER/102/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^102),${EXTEN:8})

exten => _RG-106*.,1+1,Macro(dial,${DB(AMPUSER/106/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^106),${EXTEN:8})

exten => _RG-128*.,1+1,Macro(dial,${DB(AMPUSER/128/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^128),${EXTEN:8})

exten => _RG-131*.,1+1,Macro(dial,${DB(AMPUSER/131/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^131),${EXTEN:8})

exten => _RG-100*.,1+1,Macro(dial,${DB(AMPUSER/100/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^100),${EXTEN:8})

exten => _RG-9999*.,1+1,Macro(dial,${DB(AMPUSER/9999/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^9999),${EXTEN:9})

exten => _RG-350*.,1+1,Macro(dial,${DB(AMPUSER/350/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^350),${EXTEN:8})

exten => _RG-351*.,1+1,Macro(dial,${DB(AMPUSER/351/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^351),${EXTEN:8})

exten => _RG-352*.,1+1,Macro(dial,${DB(AMPUSER/352/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^352),${EXTEN:8})

exten => _RG-354*.,1+1,Macro(dial,${DB(AMPUSER/354/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^354),${EXTEN:8})

exten => _RG-355*.,1+1,Macro(dial,${DB(AMPUSER/355/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^355),${EXTEN:8})

exten => _RG-356*.,1+1,Macro(dial,${DB(AMPUSER/356/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^356),${EXTEN:8})

exten => _RG-359*.,1+1,Macro(dial,${DB(AMPUSER/359/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^359),${EXTEN:8})

exten => _RG-360*.,1+1,Macro(dial,${DB(AMPUSER/360/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^360),${EXTEN:8})

exten => _RG-361*.,1+1,Macro(dial,${DB(AMPUSER/361/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^361),${EXTEN:8})

exten => _RG-362*.,1+1,Macro(dial,${DB(AMPUSER/362/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^362),${EXTEN:8})

exten => _RG-364*.,1+1,Macro(dial,${DB(AMPUSER/364/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^364),${EXTEN:8})

exten => _RG-365*.,1+1,Macro(dial,${DB(AMPUSER/365/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^365),${EXTEN:8})

exten => _RG-367*.,1+1,Macro(dial,${DB(AMPUSER/367/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^367),${EXTEN:8})

exten => _RG-369*.,1+1,Macro(dial,${DB(AMPUSER/369/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^369),${EXTEN:8})

exten => _RG-372*.,1+1,Macro(dial,${DB(AMPUSER/372/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^372),${EXTEN:8})

exten => _RG-133*.,1+1,Macro(dial,${DB(AMPUSER/133/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^133),${EXTEN:8})

exten => _RG-130*.,1+1,Macro(dial,${DB(AMPUSER/130/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^130),${EXTEN:8})

exten => _RG-127*.,1+1,Macro(dial,${DB(AMPUSER/127/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^127),${EXTEN:8})

exten => _RG-149*.,1+1,Macro(dial,${DB(AMPUSER/149/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^149),${EXTEN:8})

exten => _RG-129*.,1+1,Macro(dial,${DB(AMPUSER/129/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^129),${EXTEN:8})

exten => _RG-132*.,1+1,Macro(dial,${DB(AMPUSER/132/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^132),${EXTEN:8})

exten => _RG-134*.,1+1,Macro(dial,${DB(AMPUSER/134/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^134),${EXTEN:8})

exten => _RG-144*.,1+1,Macro(dial,${DB(AMPUSER/144/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^144),${EXTEN:8})

exten => _RG-370*.,1+1,Macro(dial,${DB(AMPUSER/370/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^370),${EXTEN:8})

exten => _RG-371*.,1+1,Macro(dial,${DB(AMPUSER/371/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^371),${EXTEN:8})

exten => _RG-105*.,1+1,Macro(dial,${DB(AMPUSER/105/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^105),${EXTEN:8})

exten => _RG-103*.,1+1,Macro(dial,${DB(AMPUSER/103/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^103),${EXTEN:8})

exten => _RG-107*.,1+1,Macro(dial,${DB(AMPUSER/107/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^107),${EXTEN:8})

exten => _RG-353*.,1+1,Macro(dial,${DB(AMPUSER/353/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^353),${EXTEN:8})

exten => _RG-358*.,1+1,Macro(dial,${DB(AMPUSER/358/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^358),${EXTEN:8})

exten => _RG-363*.,1+1,Macro(dial,${DB(AMPUSER/363/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^363),${EXTEN:8})

exten => _RG-366*.,1+1,Macro(dial,${DB(AMPUSER/366/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^366),${EXTEN:8})

exten => _RG-368*.,1+1,Macro(dial,${DB(AMPUSER/368/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^368),${EXTEN:8})

exten => _RG-373*.,1+1,Macro(dial,${DB(AMPUSER/373/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^373),${EXTEN:8})

exten => _RG-381*.,1+1,Macro(dial,${DB(AMPUSER/381/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^381),${EXTEN:8})

exten => _RG-382*.,1+1,Macro(dial,${DB(AMPUSER/382/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^382),${EXTEN:8})

exten => _RG-383*.,1+1,Macro(dial,${DB(AMPUSER/383/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^383),${EXTEN:8})

exten => _RG-104*.,1+1,Macro(dial,${DB(AMPUSER/104/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^104),${EXTEN:8})

exten => _RG-800*.,1+1,Macro(dial,${DB(AMPUSER/800/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^800),${EXTEN:8})

exten => _RG-357*.,1+1,Macro(dial,${DB(AMPUSER/357/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^357),${EXTEN:8})

exten => _RG-384*.,1+1,Macro(dial,${DB(AMPUSER/384/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^384),${EXTEN:8})

exten => _RG-150*.,1+1,Macro(dial,${DB(AMPUSER/150/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^150),${EXTEN:8})

exten => _RG-152*.,1+1,Macro(dial,${DB(AMPUSER/152/followme/grptime)},${DIAL_OPTIONS}M(confirm^^^152),${EXTEN:8})

exten => _RG-X.,1,Set(CDR_PROP(disable)=true)

;--== end of [fmgrps] ==--;


[followme-check]
exten => _X.,1(FMCID),Gosub(followme-sub,${EXTEN},1())
exten => _X.,n,Noop(Should never get here)
exten => _X.,n,Hangup

;--== end of [followme-check] ==--;


[followme-sub]
exten => _X.,1,Macro(user-callerid,)
exten => _X.,n,Set(DIAL_OPTIONS=${DIAL_OPTIONS}I)
exten => _X.,n,Set(CONNECTEDLINE(num,i)=${EXTEN})
exten => _X.,n,Gosub(sub-presencestate-display,s,1(${EXTEN}))
exten => _X.,n,Set(CONNECTEDLINE(name)=${DB(AMPUSER/${EXTEN}/cidname)}${PRESENCESTATE_DISPLAY})
exten => _X.,n,Set(FM_DIALSTATUS=${EXTENSION_STATE(${EXTEN}@ext-local)})
exten => _X.,n,Set(__EXTTOCALL=${EXTEN})
exten => _X.,n,Set(__PICKUPMARK=${EXTEN})
exten => _X.,n,Macro(blkvm-setifempty,)
exten => _X.,n,GotoIf($["${GOSUB_RETVAL}" = "TRUE"]?skipov)
exten => _X.,n,Macro(blkvm-set,reset)
exten => _X.,n,Set(__NODEST=)
exten => _X.,n(skipov),Set(RRNODEST=${NODEST})
exten => _X.,n(skipvmblk),Set(__NODEST=${EXTEN})
exten => _X.,n,GosubIf($[${DB_EXISTS(AMPUSER/${EXTEN}/followme/changecid)} = 1 & "${DB(AMPUSER/${EXTEN}/followme/changecid)}" != "default" & "${DB(AMPUSER/${EXTEN}/followme/changecid)}" != ""]?sub-fmsetcid,s,1())
exten => _X.,n,GotoIf($[ "${DB(AMPUSER/${EXTEN}/followme/grppre)}" = "" ]?skipprepend)
exten => _X.,n,Macro(prepend-cid,${DB(AMPUSER/${EXTEN}/followme/grppre)})
exten => _X.,n(skipprepend),Set(RecordMethod=Group)
exten => _X.,n(checkrecord),Gosub(sub-record-check,s,1(exten,${EXTEN},))
exten => _X.,n,GotoIf($[ $["${DB(AMPUSER/${EXTEN}/followme/dring)}" = ""] | $["${ALERT_INFO}"!=""] ]?skipdring)
exten => _X.,n,Set(DRING=${DB(AMPUSER/${EXTEN}/followme/dring)})
exten => _X.,n,Set(__ALERT_INFO=${STRREPLACE(DRING,\;,\\;)})
exten => _X.,n(skipdring),Set(STRATEGY=${DB(AMPUSER/${EXTEN}/followme/strategy)})
exten => _X.,n,Set(__RVOL=${DB(AMPUSER/${EXTEN}/followme/rvolume)})
exten => _X.,n,GotoIf($["${CUT(STRATEGY,-,1)}"="ringallv2"]?skipsimple)
exten => _X.,n,GotoIf($[$[ "${DB(AMPUSER/${EXTEN}/followme/prering)}" = "0" ] | $[ "${DB(AMPUSER/${EXTEN}/followme/prering)}" = "" ]] ?skipsimple)
exten => _X.,n,Macro(simple-dial,${EXTEN},${DB(AMPUSER/${EXTEN}/followme/prering)})
exten => _X.,n(skipsimple),Set(RingGroupMethod=${STRATEGY})
exten => _X.,n,Set(_FMGRP=${EXTEN})
exten => _X.,n,GotoIf($[$["${DB(AMPUSER/${EXTEN}/followme/annmsg)}" = ""] | $["${DIALSTATUS}" = "ANSWER"] | $["foo${RRNODEST}" != "foo"]]?DIALGRP)
exten => _X.,n,Answer
exten => _X.,n,Wait(1)
exten => _X.,n,Playback(${DB(AMPUSER/${EXTEN}/followme/annmsg)})
exten => _X.,n(DIALGRP),ExecIf($[$["${DB(AMPUSER/${EXTEN}/followme/ringing)}"="Ring"] | $["${DB(AMPUSER/${EXTEN}/followme/ringing)}"=""]]?Set(DOPTS=${DIAL_OPTIONS}):Set(DOPTS=m(${DB(AMPUSER/${EXTEN}/followme/ringing)})${STRREPLACE(DIAL_OPTIONS,r)}))
exten => _X.,n,GotoIf($[("${DB(AMPUSER/${EXTEN}/followme/grpconf)}"="ENABLED") | ("${FORCE_CONFIRM}"!="") ]?doconfirm)
exten => _X.,n,GotoIf($["${CUT(STRATEGY,-,1)}"="ringallv2"]?ringallv21)
exten => _X.,n,Macro(dial,${DB(AMPUSER/${EXTEN}/followme/grptime)},${DOPTS},${DB(AMPUSER/${EXTEN}/followme/grplist)})
exten => _X.,n,Goto(nextstep)
exten => _X.,n(ringallv21),Macro(dial,$[ ${DB(AMPUSER/${EXTEN}/followme/grptime)} + ${DB(AMPUSER/${EXTEN}/followme/prering)} ],${DOPTS},${DB(AMPUSER/${EXTEN}/followme/grplist)})
exten => _X.,n,Goto(nextstep)
exten => _X.,n(doconfirm),GotoIf($["${CUT(STRATEGY,-,1)}"="ringallv2"]?ringallv22)
exten => _X.,n,Macro(dial-confirm,${DB(AMPUSER/${EXTEN}/followme/grptime)},${DOPTS},${DB(AMPUSER/${EXTEN}/followme/grplist)},${EXTEN})
exten => _X.,n,Goto(nextstep)
exten => _X.,n(ringallv22),Macro(dial-confirm,$[ ${DB(AMPUSER/${EXTEN}/followme/grptime)} + ${DB(AMPUSER/${EXTEN}/followme/prering)} ],${DOPTS},${DB(AMPUSER/${EXTEN}/followme/grplist)},${EXTEN})
exten => _X.,n(nextstep),Set(RingGroupMethod=)
exten => _X.,n,GotoIf($["foo${RRNODEST}" != "foo"]?nodest)
exten => _X.,n,Set(__NODEST=)
exten => _X.,n,Set(__PICKUPMARK=)
exten => _X.,n,Macro(blkvm-clr,)
exten => _X.,n,Set(DIALSTATUS=${IF($["${FM_DIALSTATUS}"="NOT_INUSE"&"${DIALSTATUS}"!="CHANUNAVAIL"]?NOANSWER:${IF($["${DIALSTATUS}"="CHANUNAVAIL"|"${FM_DIALSTATUS}"="UNAVAILABLE"|"${FM_DIALSTATUS}"="UNKNOWN"|"${FM_DIALSTATUS}"="INVALID"]?CHANUNAVAIL:BUSY)})})
exten => _X.,n,GotoIf($["${DB(AMPUSER/${EXTEN}/followme/postdest)}"=""]?dohangup)
exten => _X.,n,Goto(${DB(AMPUSER/${EXTEN}/followme/postdest)})
exten => _X.,n(dohangup),Hangup
exten => _X.,n(nodest),Noop(SKIPPING DEST, CALL CAME FROM Q/RG: ${RRNODEST})
exten => _X.,n,Return()

;--== end of [followme-sub] ==--;


[sub-fmsetcid]
exten => s,1,Goto(s-${DB(AMPUSER/${EXTTOCALL}/followme/changecid)},1)

exten => s-fixed,1,ExecIf($["${REGEX("^[\+]?[0-9]+$" ${DB(AMPUSER/${EXTTOCALL}/followme/fixedcid)})}" = "1"]?Set(__TRUNKCIDOVERRIDE=${DB(AMPUSER/${EXTTOCALL}/followme/fixedcid)}))
exten => s-fixed,n,Return()

exten => s-extern,1,ExecIf($["${REGEX("^[\+]?[0-9]+$" ${DB(AMPUSER/${EXTTOCALL}/followme/fixedcid)})}" == "1" & "${FROM_DID}" != ""]?Set(__TRUNKCIDOVERRIDE=${DB(AMPUSER/${EXTTOCALL}/followme/fixedcid)}))
exten => s-extern,n,Return()

exten => s-did,1,ExecIf($["${REGEX("^[\+]?[0-9]+$" ${FROM_DID})}" = "1"]?Set(__REALCALLERIDNUM=${FROM_DID}))
exten => s-did,n,Return()

exten => s-forcedid,1,ExecIf($["${REGEX("^[\+]?[0-9]+$" ${FROM_DID})}" = "1"]?Set(__TRUNKCIDOVERRIDE=${FROM_DID}))
exten => s-forcedid,n,Return()

exten => _s-.,1,Noop(Unknown value for AMPUSER/${EXTTOCALL}/followme/changecid of ${DB(AMPUSER/${EXTTOCALL}/followme/changecid)} set to "default")
exten => _s-.,n,Set(DB(AMPUSER/${EXTTOCALL}/followme/changecid)=default)
exten => _s-.,n,Return()

;--== end of [sub-fmsetcid] ==--;


[app-hotelwakeup]
exten => *68,1,Macro(user-callerid,)
exten => *68,n,Answer
exten => *68,n,Wait(1)
exten => *68,n,AGI(wakeup)
exten => *68,n,Hangup

;--== end of [app-hotelwakeup] ==--;


[app-calltrace]
exten => *69,1,Goto(app-calltrace-perform,s,1)

;--== end of [app-calltrace] ==--;


[app-calltrace-perform]
exten => s,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => s,n,Set(CONNECTEDLINE(name,i)=Call Trace)
exten => s,n,Set(CONNECTEDLINE(num,i)=s)
exten => s,n,Answer
exten => s,n,Wait(1)
exten => s,n,Macro(user-callerid,)
exten => s,n,Set(INVALID_LOOPCOUNT=0)
exten => s,n,Playback(info-about-last-call&telephone-number)
exten => s,n,Set(lastcaller=${DB(CALLTRACE/${AMPUSER})})
exten => s,n,GotoIf($[ $[ "${lastcaller}" = "" ] | $[ "${lastcaller}" = "unknown" ] ]?noinfo)
exten => s,n,SayDigits(${lastcaller})
exten => s,n,Set(TIMEOUT(digit)=3)
exten => s,n,Set(TIMEOUT(response)=7)
exten => s,n(repeatoption),Set(INVALID_LOOPCOUNT=$[${INVALID_LOOPCOUNT}+1])
exten => s,n,Read(EXT,to-call-this-number&vm-press&digits/1,1,,0,10)
exten => s,n,GotoIf($["${EXT}" = ""]?i,invalid)
exten => s,n,GotoIf($["${DIALPLAN_EXISTS(app-calltrace-perform,${EXT},1)}" = "0"]?i,invalid:1,dial)
exten => s,n,Goto(fin)
exten => s,n(noinfo),Playback(from-unknown-caller)
exten => s,n,Macro(hangupcall,)
exten => s,n(fin),Noop(Waiting for input)

exten => 1,1(dial),Goto(from-internal,${lastcaller},1)

exten => i,1(invalid),Playback(no-valid-responce-pls-try-again)
exten => i,n,GotoIf($[${INVALID_LOOPCOUNT} < 3 ]?s,repeatoption)
exten => i,n,Playback(vm-goodbye)
exten => i,n,Macro(hangupcall,)

;--== end of [app-calltrace-perform] ==--;


[app-echo-test]
exten => *43,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *43,n,Set(CONNECTEDLINE(name,i)=Echo Test)
exten => *43,n,Set(CONNECTEDLINE(num,i)=*43)
exten => *43,n,Answer
exten => *43,n,Macro(user-callerid,)
exten => *43,n,Wait(1)
exten => *43,n,Background(demo-echotest,,,app-echo-test-echo)
exten => *43,n,Goto(app-echo-test-echo,1,1)

;--== end of [app-echo-test] ==--;


[app-echo-test-echo]
exten => _[0-9#*],1,Echo()
exten => _[0-9#*],n,Playback(demo-echodone)
exten => _[0-9#*],n,Hangup

;--== end of [app-echo-test-echo] ==--;


[app-speakextennum]
exten => *65,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *65,n,Set(CONNECTEDLINE(name,i)=Speak Extension)
exten => *65,n,Set(CONNECTEDLINE(num,i)=*65)
exten => *65,n,Answer
exten => *65,n,Wait(1)
exten => *65,n,Macro(user-callerid,)
exten => *65,n,GotoIf($[${DIALPLAN_EXISTS(app-speakextennum,${CHANNEL(language)},1)}]?app-speakextennum,${CHANNEL(language)},1:app-speakextennum,en,1)

exten => en,1,Playback(your)
exten => en,n,Playback(extension)
exten => en,n,Playback(number)
exten => en,n,Playback(is)
exten => en,n,SayDigits(${AMPUSER})
exten => en,n,Wait(2)
exten => en,n,Hangup

exten => fr,1,Playback(your)
exten => fr,n,Playback(extension)
exten => fr,n,Playback(is2)
exten => fr,n,SayDigits(${AMPUSER})
exten => fr,n,Wait(2)
exten => fr,n,Hangup

exten => ja,1,Playback(your)
exten => ja,n,Playback(extension)
exten => ja,n,Playback(jp-wa)
exten => ja,n,SayDigits(${AMPUSER})
exten => ja,n,Wait(2)
exten => ja,n,Hangup

;--== end of [app-speakextennum] ==--;


[sub-hr12format]
exten => s,1,GotoIf($[${DIALPLAN_EXISTS(sub-hr12format,${CHANNEL(language)},1)}]?sub-hr12format,${CHANNEL(language)},1:sub-hr12format,en,1)
exten => s,n,GotoIf($[${DIALPLAN_EXISTS(sub-hr12format,${CHANNEL(language)},1)}]?${CHANNEL(language)},1:en,1)

exten => en,1,Playback(at-tone-time-exactly)
exten => en,n,SayUnixTime(${FutureTime},,IM 'vm-and' S 'seconds' p)
exten => en,n,Return()
exten => en,n,Playback(at-tone-time-exactly)
exten => en,n,SayUnixTime(${FutureTime},,IM 'vm-and' S 'seconds' p)
exten => en,n,Return()

exten => fr,1,Playback(at-tone-time-exactly)
exten => fr,n,SayUnixTime(${FutureTime},,IMSp)
exten => fr,n,Return()
exten => fr,n,Playback(at-tone-time-exactly)
exten => fr,n,SayUnixTime(${FutureTime},,IMSp)
exten => fr,n,Return()

exten => de,1,Playback(at-tone-time-exactly)
exten => de,n,SayUnixTime(${FutureTime},,IMSp)
exten => de,n,Return()
exten => de,n,Playback(at-tone-time-exactly)
exten => de,n,SayUnixTime(${FutureTime},,IMSp)
exten => de,n,Return()

exten => ja,1,Playback(at-tone-time-exactly)
exten => ja,n,SayUnixTime(${FutureTime},,pIMS)
exten => ja,n,Return()
exten => ja,n,Playback(at-tone-time-exactly)
exten => ja,n,SayUnixTime(${FutureTime},,pIMS)
exten => ja,n,Return()

;--== end of [sub-hr12format] ==--;


[app-speakingclock]
exten => *60,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *60,n,Set(CONNECTEDLINE(name,i)=Speaking Clock)
exten => *60,n,Set(CONNECTEDLINE(num,i)=*60)
exten => *60,n,Macro(user-callerid,)
exten => *60,n,Answer
exten => *60,n,Wait(1)
exten => *60,n,Set(NumLoops=0)
exten => *60,n(start),Set(FutureTime=$[${EPOCH} + 8])
exten => *60,n,Set(FutureTimeMod=$[${FutureTime} % 10])
exten => *60,n,Set(FutureTime=$[${FutureTime} - ${FutureTimeMod} + 10])
exten => *60,n,Gosub(sub-hr12format,s,1())
exten => *60,n(waitloop),Set(TimeLeft=$[${FutureTime} - ${EPOCH}])
exten => *60,n,GotoIf($[${TimeLeft} < 1]?playbeep)
exten => *60,n,Wait(1)
exten => *60,n,Goto(waitloop)
exten => *60,n(playbeep),Playback(beep)
exten => *60,n,Wait(5)
exten => *60,n,Set(NumLoops=$[${NumLoops} + 1])
exten => *60,n,GotoIf($[${NumLoops} < 5]?start)
exten => *60,n,Playback(goodbye)
exten => *60,n,Hangup

;--== end of [app-speakingclock] ==--;


[sub-hr24format]
exten => s,1,GotoIf($[${DIALPLAN_EXISTS(sub-hr24format,${CHANNEL(language)},1)}]?${CHANNEL(language)},1:en,1)

exten => en,1,Playback(at-tone-time-exactly)
exten => en,n,SayUnixTime(${FutureTime},,kM 'vm-and' S 'seconds')
exten => en,n,Return()

exten => fr,1,Playback(at-tone-time-exactly)
exten => fr,n,SayUnixTime(${FutureTime},,kMS)
exten => fr,n,Return()

exten => de,1,Playback(at-tone-time-exactly)
exten => de,n,SayUnixTime(${FutureTime},,kMS)
exten => de,n,Return()

exten => ja,1,Playback(at-tone-time-exactly)
exten => ja,n,SayUnixTime(${FutureTime},,kMS)
exten => ja,n,Return()

;--== end of [sub-hr24format] ==--;


[originate-aa]
exten => _.X,1,Macro(blkvm-set,)
exten => _.X,n,Gosub(app-paging,ssetup,1())
exten => _.X,n,Macro(autoanswer,${EXTEN})
exten => _.X,n,Gosub(autoanswer,s,1(${ALERTINFO},${CALLINFO}))
exten => _.X,n,Goto(from-internal,${EXTEN},1)

;--== end of [originate-aa] ==--;


[ext-intercom]
exten => lang-playback,1,GosubIf($[${DIALPLAN_EXISTS(ext-intercom,${CHANNEL(language)})}]?ext-intercom,${CHANNEL(language)},${ARG1}():ext-intercom,en,${ARG1}())
exten => lang-playback,n,Return()

exten => _*80.,1,Macro(user-callerid,)
exten => _*80.,n,Set(dialnumber=${EXTEN:3})
exten => _*80.,n,Set(INTERCOM_CALL=TRUE)
exten => _*80.,n,Gosub(sub-record-check,s,1(exten,${dialnumber}))
exten => _*80.,n,GotoIf($["${DB(AMPUSER/${AMPUSER}/intercom/block)}" = "blocked"]?end)
exten => _*80.,n,GotoIf($["${DB(DND/${dialnumber})}" = "YES"]?end)
exten => _*80.,n,GotoIf($["${DB(AMPUSER/${dialnumber}/intercom/${AMPUSER})}" = "allow" ]?allow)
exten => _*80.,n,GotoIf($["${DB(AMPUSER/${dialnumber}/intercom/${AMPUSER})}" = "deny" ]?nointercom)
exten => _*80.,n,GotoIf($["${DB(AMPUSER/${dialnumber}/intercom)}" = "disabled" ]?nointercom)
exten => _*80.,n(allow),Set(DEVICES=${DB(AMPUSER/${dialnumber}/device)})
exten => _*80.,n,GotoIf($["${DEVICES}" = "" ]?end)
exten => _*80.,n,Set(OVERRIDE=${DB(AMPUSER/${dialnumber}/intercom/override)})
exten => _*80.,n,Set(LOOPCNT=${FIELDQTY(DEVICES,&)})
exten => _*80.,n,Set(_SIPURI=)
exten => _*80.,n,Set(_ALERTINFO=Ring Answer)
exten => _*80.,n,Set(_CALLINFO=<uri>\;answer-after=0)
exten => _*80.,n,Set(_SIPURI=intercom=true)
exten => _*80.,n,Set(_DTIME=5)
exten => _*80.,n,Set(_ANSWERMACRO=)
exten => _*80.,n,GotoIf($[${LOOPCNT} > 1 ]?pagemode)
exten => _*80.,n,Macro(autoanswer,${DEVICES})
exten => _*80.,n,Set(_DOPTIONS=A(beep)b(autoanswer^s^1(${ALERTINFO},${CALLINFO})))
exten => _*80.,n(check),ChanIsAvail(${DEVICE},s)
exten => _*80.,n,ExecIf($["${AVAILSTATUS}" = "6"]?Set(AVAILORIGCHAN=${DEVICE}))
exten => _*80.,n,GotoIf($["${AVAILORIGCHAN}" != ""]?continue)
exten => _*80.,n,ExecIf($["${OVERRIDE}" = ""]?Set(OVERRIDE=reject))
exten => _*80.,n,GotoIf($["${OVERRIDE}" = "reject"]?end)
exten => _*80.,n,Set(DTIME=30)
exten => _*80.,n,ExecIf($["${OVERRIDE}" = "ring"]?Set(DOPTIONS=A(beep)))
exten => _*80.,n(continue),Noop(Continuing with page)
exten => _*80.,n,GotoIf($["${DB(AMPUSER/${EXTEN:3}/cidname)}" = ""]?godial)
exten => _*80.,n,Set(CONNECTEDLINE(name,i)=${DB(AMPUSER/${EXTEN:3}/cidname)})
exten => _*80.,n,Set(CONNECTEDLINE(num)=${EXTEN:3})
exten => _*80.,n(godial),Dial(${DIAL},${DTIME},I${DOPTIONS}${INTERCOM_EXT_DOPTIONS})
exten => _*80.,n(end),ExecIf($[${INTERCOM_RETURN}]?Return())
exten => _*80.,n,Busy(20)
exten => _*80.,n,Macro(hangupcall,)
exten => _*80.,n(pagemode),Set(ITER=1)
exten => _*80.,n,Set(DIALSTR=)
exten => _*80.,n(begin),ChanIsAvail(${DB(DEVICE/${CUT(DEVICES,&,${ITER})}/dial)},s)
exten => _*80.,n,GotoIf($["${AVAILORIGCHAN}" = ""]?skip)
exten => _*80.,n,Set(DIALSTR=${DIALSTR}-${CUT(DEVICES,&,${ITER})})
exten => _*80.,n(skip),Set(ITER=$[${ITER} + 1])
exten => _*80.,n,GotoIf($[${ITER} <= ${LOOPCNT}]?begin)
exten => _*80.,n,Set(DIALSTR=${DIALSTR:1})
exten => _*80.,n,GotoIf($["${DIALSTR}" = ""]?checkpageoption)
exten => _*80.,n,Set(_AMPUSER=${AMPUSER})
exten => _*80.,n,Gosub(page,1(${DIALSTR}))
exten => _*80.,n(checkpageoption),Noop(Intercom option ${OVERRIDE})
exten => _*80.,n,GotoIf($["${OVERRIDE}" = "reject"]?end2)
exten => _*80.,n,Gosub(dialall,1(${DIALSTR}))
exten => _*80.,n(end2),ExecIf($[${INTERCOM_RETURN}]?Return())
exten => _*80.,n,Busy(20)
exten => _*80.,n,Macro(hangupcall,)
exten => _*80.,n(nointercom),Noop(Intercom disallowed by ${dialnumber})
exten => _*80.,n,ExecIf($[${INTERCOM_RETURN}]?Return())
exten => _*80.,n,Gosub(ext-intercom,lang-playback,1(hook_0))
exten => _*80.,n,Congestion(20)

exten => page,1,Set(PAGE_CONF=${EPOCH}${RAND(100,999)})
exten => page,n,Set(PAGEMODE=PAGE)
exten => page,n,Set(PAGE_MEMBERS=${ARG1})
exten => page,n,Set(PAGE_CONF_OPTS=duplex)
exten => page,n,AGI(page.agi)
exten => page,n,Set(CONFBRIDGE(user,template)=page_user_duplex)
exten => page,n,Set(CONFBRIDGE(user,admin)=yes)
exten => page,n,Set(CONFBRIDGE(user,marked)=yes)
exten => page,n,ConfBridge(${PAGE_CONF},,,admin_menu)
exten => page,n,Hangup

exten => dialall,1,GotoIf($[${LOOPCNT} > 1 ]?preparedialst)
exten => dialall,n(preparedialst),Set(ITER=1)
exten => dialall,n,Set(DIALSTR=)
exten => dialall,n(begin1),Set(DIALSTR=${DIALSTR}&${DB(DEVICE/${CUT(DEVICES,&,${ITER})}/dial)})
exten => dialall,n,Set(ITER=$[${ITER} + 1])
exten => dialall,n,GotoIf($[${ITER} <= ${LOOPCNT}]?begin1)
exten => dialall,n,Set(DIALSTR=${DIALSTR:1})
exten => dialall,n,Noop(Dial statring  ${DIALSTR})
exten => dialall,n,GotoIf($["${OVERRIDE}" = "ring"]?dialnow)
exten => dialall,n,Set(_DOPTIONS=A(beep)b(autoanswer^s^1(${ALERTINFO},${CALLINFO})))
exten => dialall,n(dialnow),Dial(${DIALSTR},${DTIME},I${DOPTIONS}${INTERCOM_EXT_DOPTIONS})
exten => dialall,n,Hangup

exten => en,1(hook_0),Playback(intercom&for&extension)
exten => en,n,SayDigits(${dialnumber})
exten => en,n,Playback(is&disabled)
exten => en,n,Return()

exten => ja,1(hook_0),Playback(extension)
exten => ja,n,SayDigits(${dialnumber})
exten => ja,n,Playback(jp-no&intercom&jp-wa&disabled-2)
exten => ja,n,Return()

;--== end of [ext-intercom] ==--;


[ext-intercom-users]
exten => _*80XXX,1,Goto(ext-intercom,${EXTEN},1)

exten => _*80XXXXX,1,Goto(ext-intercom,${EXTEN},1)

exten => lang-playback,1,GosubIf($[${DIALPLAN_EXISTS(ext-intercom-users,${CHANNEL(language)})}]?ext-intercom-users,${CHANNEL(language)},${ARG1}():ext-intercom-users,en,${ARG1}())
exten => lang-playback,n,Return()

exten => *54,1,Macro(user-callerid,)
exten => *54,n,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *54,n,Set(CONNECTEDLINE(name,i)=Intercom: Enabled)
exten => *54,n,Set(CONNECTEDLINE(num,i)=${AMPUSER})
exten => *54,n,Answer
exten => *54,n,Wait(1)
exten => *54,n,Set(DB(AMPUSER/${AMPUSER}/intercom)=enabled)
exten => *54,n,Playback(intercom&enabled)
exten => *54,n,Macro(hangupcall,)

exten => _*54.,1,Macro(user-callerid,)
exten => _*54.,n,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => _*54.,n,Set(CONNECTEDLINE(name,i)=Intercom from ${EXTEN:3}: Enabled)
exten => _*54.,n,Set(CONNECTEDLINE(num,i)=${AMPUSER})
exten => _*54.,n,Set(dialnumber=${EVAL(${EXTEN:3})})
exten => _*54.,n,Answer
exten => _*54.,n,Wait(1)
exten => _*54.,n,GotoIf($["${DB(AMPUSER/${AMPUSER}/intercom/${EXTEN:3})}" = "allow" ]}?unset)
exten => _*54.,n,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN:3}/device)} != 1]?invaliduser)
exten => _*54.,n,Set(DB(AMPUSER/${AMPUSER}/intercom/${EXTEN:3})=allow)
exten => _*54.,n,Gosub(ext-intercom-users,lang-playback,1(hook_1))
exten => _*54.,n,Macro(hangupcall,)
exten => _*54.,n(unset),dbDeltree(AMPUSER/${AMPUSER}/intercom/${EXTEN:3})
exten => _*54.,n,Gosub(ext-intercom-users,lang-playback,1(hook_2))
exten => _*54.,n,Macro(hangupcall,)
exten => _*54.,n(invaliduser),Gosub(ext-intercom-users,lang-playback,1(hook_3))
exten => _*54.,n,Macro(hangupcall,)

exten => en,1(hook_1),Playback(intercom&from&extension&number)
exten => en,n,SayDigits(${dialnumber})
exten => en,n,Playback(enabled)
exten => en,n,Return()
exten => en,n(hook_2),Playback(intercom&enabled&cancelled&for&extension&number)
exten => en,n,SayDigits(${dialnumber})
exten => en,n,Return()
exten => en,n(hook_3),Playback(extension&number)
exten => en,n,SayDigits(${dialnumber})
exten => en,n,Playback(invalid)
exten => en,n,Return()
exten => en,n(hook_4),Playback(intercom&from&extension&number)
exten => en,n,SayDigits(${dialnumber})
exten => en,n,Playback(disabled)
exten => en,n,Return()
exten => en,n(hook_5),Playback(intercom&disabled&cancelled&for&extension&number)
exten => en,n,SayDigits(${dialnumber})
exten => en,n,Return()
exten => en,n(hook_6),Playback(extension&number)
exten => en,n,SayDigits(${dialnumber})
exten => en,n,Playback(invalid)
exten => en,n,Return()

exten => ja,1(hook_1),Playback(extension)
exten => ja,n,SayDigits(${dialnumber})
exten => ja,n,Playback(jp-kara&jp-no&intercom&jp-wo&allow)
exten => ja,n,Return()
exten => ja,n(hook_2),Playback(extension)
exten => ja,n,SayDigits(${dialnumber})
exten => ja,n,Playback(jp-kara&jp-no&intercom&setting&jp-wo&cancelled)
exten => ja,n,Return()
exten => ja,n(hook_3),Playback(extension)
exten => ja,n,SayDigits(${dialnumber})
exten => ja,n,Playback(invalid)
exten => ja,n,Return()
exten => ja,n(hook_4),Playback(extension)
exten => ja,n,SayDigits(${dialnumber})
exten => ja,n,Playback(jp-kara&jp-no&intercom&jp-wo&deny)
exten => ja,n,Return()
exten => ja,n(hook_5),Playback(extension)
exten => ja,n,SayDigits(${dialnumber})
exten => ja,n,Playback(jp-kara&jp-no&intercom&setting&jp-wo&cancelled)
exten => ja,n,Return()
exten => ja,n(hook_6),Playback(extension)
exten => ja,n,SayDigits(${dialnumber})
exten => ja,n,Playback(invalid)
exten => ja,n,Return()

exten => *55,1,Macro(user-callerid,)
exten => *55,n,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *55,n,Set(CONNECTEDLINE(name,i)=Intercom: Disabled)
exten => *55,n,Set(CONNECTEDLINE(num,i)=${AMPUSER})
exten => *55,n,Answer
exten => *55,n,Wait(1)
exten => *55,n,Set(DB(AMPUSER/${AMPUSER}/intercom)=disabled)
exten => *55,n,Playback(intercom&disabled)
exten => *55,n,Macro(hangupcall,)

exten => _*55.,1,Macro(user-callerid,)
exten => _*55.,n,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => _*55.,n,Set(CONNECTEDLINE(name,i)=Intercom from ${EXTEN:3}: Disabled)
exten => _*55.,n,Set(CONNECTEDLINE(num,i)=${AMPUSER})
exten => _*55.,n,Set(dialnumber=${EVAL(${EXTEN:3})})
exten => _*55.,n,Answer
exten => _*55.,n,Wait(1)
exten => _*55.,n,GotoIf($["${DB(AMPUSER/${AMPUSER}/intercom/${EXTEN:3})}" = "deny" ]}?unset2)
exten => _*55.,n,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN:3}/device)} != 1]?invaliduser2)
exten => _*55.,n,Set(DB(AMPUSER/${AMPUSER}/intercom/${EXTEN:3})=deny)
exten => _*55.,n,Gosub(ext-intercom-users,lang-playback,1(hook_4))
exten => _*55.,n,Macro(hangupcall,)
exten => _*55.,n(unset2),dbDeltree(AMPUSER/${AMPUSER}/intercom/${EXTEN:3})
exten => _*55.,n,Gosub(ext-intercom-users,lang-playback,1(hook_5))
exten => _*55.,n,Macro(hangupcall,)
exten => _*55.,n(invaliduser2),Gosub(ext-intercom-users,lang-playback,1(hook_6))
exten => _*55.,n,Macro(hangupcall,)

;--== end of [ext-intercom-users] ==--;


[macro-autoanswer]
exten => s,1,GotoIf($["${KNOWNDIAL}" != ""]?knowndial)
exten => s,n,Set(DEVICE=${DB(DEVICE/${ARG1}/dial)})
exten => s,n,GotoIf($["${DEVICE:0:5}" == "PJSIP" ]?dopjsip)
exten => s,n,Set(KNOWNDIAL=${DEVICE})
exten => s,n,Goto(knowndial)
exten => s,n(dopjsip),Set(KNOWNDIAL=${PJSIP_DIAL_CONTACTS(${ARG1})})
exten => s,n,GotoIf($[${REGEX("&" ${KNOWNDIAL})} == 0]?knowndial)
exten => s,n,Gosub(app-paging,ssetup,1())
exten => s,n,Set(PAGEMODE=PAGE)
exten => s,n,Set(PAGE_CONF_OPTS=duplex)
exten => s,n,Set(STREAM=NONE)
exten => s,n,Set(PAGE_MEMBERS=${ARG1})
exten => s,n,AGI(page.agi)
exten => s,n,Set(CONFBRIDGE(user,template)=page_user_duplex)
exten => s,n,Set(CONFBRIDGE(user,admin)=yes)
exten => s,n,Set(CONFBRIDGE(user,marked)=yes)
exten => s,n,ConfBridge(${PAGE_CONF},,,admin_menu)
exten => s,n,Hangup
exten => s,n(knowndial),Set(DIAL=${KNOWNDIAL})
exten => s,n,ExecIf($["${DIAL:0:3}" = "ZAP"]?Set(DIAL=DAHDI${DIAL:3}))
exten => s,n,GotoIf($["${DB(DEVICE/${ARG1}/autoanswer/macro)}" != "" ]?macro)
exten => s,n,GotoIf($["${DIAL:0:5}" = "PJSIP"]?pjsipua)
exten => s,n,Set(USERAGENT=${SIPPEER(${CUT(DIAL,/,2)},useragent)})
exten => s,n,Goto(uafin)
exten => s,n(pjsipua),Set(AOR=${CUT(DIAL,/,2)})
exten => s,n,Set(CONTACT=${PJSIP_AOR(${AOR},contact)})
exten => s,n,Set(USERAGENT=${PJSIP_CONTACT(${CONTACT},user_agent)})
exten => s,n(uafin),ExecIf($["${KNOWNAGENT}" != ""]?Set(USERAGENT=${KNOWNAGENT}))
exten => s,n,ExecIf($["${LEN(${PVOL})}" != "0"]?Set(PAGE_VOL=\;volume=${PVOL}))
exten => s,n,ExecIf($["${USERAGENT:0:5}" = "Mitel"]?Set(CALLINFO=<sip:broadworks.net>\;answer-after=0))
exten => s,n,ExecIf($["${USERAGENT:0:9}" = "Panasonic"]?Set(ALERTINFO=Intercom))
exten => s,n,ExecIf($["${USERAGENT:0:7}" = "Polycom"]?Set(ALERTINFO=info=Auto Answer))
exten => s,n,ExecIf($["${USERAGENT:0:6}" = "Digium"]?Set(ALERTINFO=ring-answer))
exten => s,n,ExecIf($["${USERAGENT:0:7}" = "Sangoma"]?Set(ALERTINFO=<http://www.sangoma.com>\;info=external${PAGE_VOL}))
exten => s,n,ExecIf($["${USERAGENT:0:9}" = "OpenStage"]?Set(ALERTINFO=<http://example.com>\;info=alert-autoanswer))
exten => s,n,ExecIf($["${SIPURI}" != ""]?Set(__SIP_URI_OPTIONS=${SIPURI}))
exten => s,n+2(macro),Macro(${DB(DEVICE/${ARG1}/autoanswer/macro)},${ARG1})

;--== end of [macro-autoanswer] ==--;


[autoanswer]
exten => s,1,GosubIf($["${ARG1}" != ""]?func-set-sipheader,s,1(Alert-Info,${ARG1}))
exten => s,n,GosubIf($["${ARG2}" != ""]?func-set-sipheader,s,1(Call-Info,${ARG2}))
exten => s,n,Gosub(func-apply-sipheaders,s,1())
exten => s,n,Return()

;--== end of [autoanswer] ==--;


[app-paging]
exten => ssetup,1,Set(_SIPURI=)
exten => ssetup,n,Set(_ALERTINFO=Ring Answer)
exten => ssetup,n,Set(_CALLINFO=<uri>\;answer-after=0)
exten => ssetup,n,Set(_SIPURI=intercom=true)
exten => ssetup,n,Set(_DTIME=5)
exten => ssetup,n,Set(_ANSWERMACRO=)
exten => ssetup,n,Set(PAGE_CONF=${EPOCH}${RAND(100,999)})
exten => ssetup,n,Return()

exten => _PAGE.,1(SKIPCHECK),Macro(autoanswer,${EXTEN:4})
exten => _PAGE.,n,Noop(${EXTRINGTIME})
exten => _PAGE.,n,GotoIf($["${EXTRINGTIME}" != "true"]?doptions)
exten => _PAGE.,n,Set(_DTIME=${RINGTIMER_DEFAULT})
exten => _PAGE.,n,ExecIf($["${DB(AMPUSER/${EXTEN:4}/ringtimer)}" != "" & ${DB(AMPUSER/${EXTEN:4}/ringtimer)} > 0]?Set(_DTIME=${DB(AMPUSER/${EXTEN:4}/ringtimer)}))
exten => _PAGE.,n(doptions),ExecIf($["${DOPTIONS}" = ""]?Set(_DOPTIONS=b(autoanswer^s^1(${ALERTINFO},${CALLINFO}))))
exten => _PAGE.,n,Dial(${DIAL},${DTIME},A(${ANNOUNCEMENT})${DOPTIONS})
exten => _PAGE.,n(skipself),Hangup

exten => _SPAGE.,1(chanspy),ChanSpy(${SP_DEVICE}-,qW)
exten => _SPAGE.,n,Hangup

;--== end of [app-paging] ==--;


[app-page-stream]
exten => s,1,Wait(1)
exten => s,n,Answer
exten => s,n,Set(CONFBRIDGE(user,template)=page_user_duplex)
exten => s,n,Set(CONFBRIDGE(user,marked)=yes)
exten => s,n,ExecIf($["${PAGE_USER_TYPE}" = "ADMIN_MUTED"]?Set(CONFBRIDGE(user,startmuted)=yes))
exten => s,n,ExecIf($["${PAGE_USER_TYPE}" = "ADMIN_MUTED"]?Set(CONFBRIDGE(user,marked)=yes))
exten => s,n,ConfBridge(${PAGE_CONF},,,)
exten => s,n,Hangup

;--== end of [app-page-stream] ==--;


[macro-parked-call]
exten => s,1,Macro(user-callerid,)
exten => s,n,Gosub(sub-record-check,s,1(parking,${AMPUSER},${AMPUSER}))
exten => s,n,Noop(PARKRETURNTO: ${SHARED(PARKRETURNTO,${CHANNEL})})
exten => s,n,GotoIf($[${LEN(${SHARED(PARKRETURNTO,${CHANNEL})})} > 0]?backtosender)
exten => s,n,GotoIf($[${LEN(${BLINDTRANSFER})} > 0 | ${LEN(${ATTENDEDTRANSFER})} > 0]?attemptpark)
exten => s,n,AGI(parkfetch.agi,${ARG1},${ARG2})
exten => s,n,GotoIf($["${REC_STATUS}" != "RECORDING"]?next)
exten => s,n,Set(CDR(recordingfile)=${CALLFILENAME}.${MON_FMT})
exten => s,n(next),Set(CCSS_SETUP=TRUE)
exten => s,n,GotoIf($["${PARKIE}" != ""]?pcall)
exten => s,n,ResetCDR()
exten => s,n,Set(CDR_PROP(disable)=true)
exten => s,n,Wait(1)
exten => s,n,Playback(pbx-invalidpark)
exten => s,n,Wait(1)
exten => s,n,Hangup
exten => s,n(pcall),Noop(User: ${CALLERID(all)} attempting to pick up Parked Call Slot ${ARG1})
exten => s,n,Noop(PARKIE: ${PARKIE})
exten => s,n,Set(SHARED(PARKRETURNTO,${PARKIE})=)
exten => s,n,Set(PARKOWNER=1)
exten => s,n,ParkedCall(${ARG2},${ARG1})
exten => s,n,Hangup
exten => s,n(attemptpark),Noop(User: ${CALLERID(all)} attempting to Park into slot ${ARG1})
exten => s,n,Noop(Blind Transfer: ${BLINDTRANSFER}, Attended Transfer: ${ATTENDEDTRANSFER})
exten => s,n,Noop($[${LEN(${PARKOWNER})} = 0])
exten => s,n,GotoIf($[${LEN(${PARKOWNER})} = 0]?parkit)
exten => s,n,Macro(hangupcall,)
exten => s,n(parkit),Set(PARKINGEXTEN=${ARG1})
exten => s,n,ExecIf($[${LEN(${BLINDTRANSFER})} > 0]?Set(SHARED(PARKRETURNTO,${CHANNEL})=${CUT(BLINDTRANSFER,-,1)}):Set(SHARED(PARKRETURNTO,${CHANNEL})=${CUT(ATTENDEDTRANSFER,-,1)}))
exten => s,n,Noop(PARKRETURNTO: ${SHARED(PARKRETURNTO,${CHANNEL})})
exten => s,n,Park(${ARG2},sc(${CONTEXT},s,200))
exten => s,1+199(backtosender),Noop(Attempting to go back to sender)
exten => s,n,Set(PARKCALLBACK=${SHARED(PARKRETURNTO,${CHANNEL})})
exten => s,n,Set(SHARED(PARKRETURNTO,${CHANNEL})=)
exten => s,n,Goto(park-return-routing,${ARG1},1)

exten => h,1,Macro(hangupcall,)

;--== end of [macro-parked-call] ==--;


[parkedcallstimeout]
exten => _[0-9a-zA-Z*#].,1,Set(PARKCALLBACK=${REPLACE(EXTEN,_,/)})
exten => _[0-9a-zA-Z*#].,n,GotoIf($["${REC_STATUS}" != "RECORDING"]?next)
exten => _[0-9a-zA-Z*#].,n,MixMonitor(${MIXMON_DIR}${YEAR}/${MONTH}/${DAY}/${CALLFILENAME}.${MIXMON_FORMAT},a,${MIXMON_POST})
exten => _[0-9a-zA-Z*#].,n(next),Goto(park-return-routing,${PARKING_SPACE},1)

;--== end of [parkedcallstimeout] ==--;


[park-dial]
exten => t,1,Noop(WARNING: PARKRETURN to: [${EXTEN}] failed with: [${DIALSTATUS}]. Trying Alternate Dest On Parking Lot ${PARKING_SPACE})
exten => t,n,Goto(park-orphan-routing,70,1)

exten => _[0-9a-zA-Z*#].,1,Noop(WARNING: PARKRETURN to: [${EXTEN}] failed with: [${DIALSTATUS}]. Trying Alternate Dest On Parking Lot ${PARKING_SPACE})
exten => _[0-9a-zA-Z*#].,n,Goto(park-orphan-routing,70,1)

;--== end of [park-dial] ==--;


[park-orphan-routing]
exten => 70,1,Goto(app-blackhole,hangup,1)

;--== end of [park-orphan-routing] ==--;


[park-return-routing]
exten => 70,1,Set(PLOT=70)
exten => 70,n,ExecIf($["${ALERT_INFO}"!=""]?Set(HASH(__SIPHEADERS,Alert-Info)=${ALERT_INFO}))
exten => 70,n,ExecIf($["${RVOL}"!=""]?Set(HASH(__SIPHEADERS,Alert-Info)=${ALERT_INFO}\;volume=${RVOL}))
exten => 70,n,Dial(${PARKCALLBACK},15,b(func-apply-sipheaders^s^1),tr)
exten => 70,n,Set(PARKCALLBACK=)
exten => 70,n,Goto(app-blackhole,hangup,1)

exten => 71,1,Goto(70,1)

exten => 72,1,Goto(70,1)

exten => 73,1,Goto(70,1)

exten => 74,1,Goto(70,1)

exten => 75,1,Goto(70,1)

exten => 76,1,Goto(70,1)

exten => 77,1,Goto(70,1)

exten => 78,1,Goto(70,1)

;--== end of [park-return-routing] ==--;


[park-hints]
include => parkedcalls ; Default Lot
exten => 71,1,Macro(parked-call,71,default)
exten => 71,hint,park:71@parkedcalls

exten => *8571,1,Set(FORCEPICKUP=default)
exten => *8571,n,Macro(parked-call,71,default)
exten => *8571,hint,park:71@parkedcalls

exten => 72,1,Macro(parked-call,72,default)
exten => 72,hint,park:72@parkedcalls

exten => *8572,1,Set(FORCEPICKUP=default)
exten => *8572,n,Macro(parked-call,72,default)
exten => *8572,hint,park:72@parkedcalls

exten => 73,1,Macro(parked-call,73,default)
exten => 73,hint,park:73@parkedcalls

exten => *8573,1,Set(FORCEPICKUP=default)
exten => *8573,n,Macro(parked-call,73,default)
exten => *8573,hint,park:73@parkedcalls

exten => 74,1,Macro(parked-call,74,default)
exten => 74,hint,park:74@parkedcalls

exten => *8574,1,Set(FORCEPICKUP=default)
exten => *8574,n,Macro(parked-call,74,default)
exten => *8574,hint,park:74@parkedcalls

exten => 75,1,Macro(parked-call,75,default)
exten => 75,hint,park:75@parkedcalls

exten => *8575,1,Set(FORCEPICKUP=default)
exten => *8575,n,Macro(parked-call,75,default)
exten => *8575,hint,park:75@parkedcalls

exten => 76,1,Macro(parked-call,76,default)
exten => 76,hint,park:76@parkedcalls

exten => *8576,1,Set(FORCEPICKUP=default)
exten => *8576,n,Macro(parked-call,76,default)
exten => *8576,hint,park:76@parkedcalls

exten => 77,1,Macro(parked-call,77,default)
exten => 77,hint,park:77@parkedcalls

exten => *8577,1,Set(FORCEPICKUP=default)
exten => *8577,n,Macro(parked-call,77,default)
exten => *8577,hint,park:77@parkedcalls

exten => 78,1,Macro(parked-call,78,default)
exten => 78,hint,park:78@parkedcalls

exten => *8578,1,Set(FORCEPICKUP=default)
exten => *8578,n,Macro(parked-call,78,default)
exten => *8578,hint,park:78@parkedcalls

exten => 70,hint,park:71@parkedcalls&park:72@parkedcalls&park:73@parkedcalls&park:74@parkedcalls&park:75@parkedcalls&park:76@parkedcalls&park:77@parkedcalls&park:78@parkedcalls
;--== end of [park-hints] ==--;


[app-parking]
exten => *88,1,Park()

;--== end of [app-parking] ==--;


[app-queue-toggle]
exten => s,1(start),Answer
exten => s,n,Wait(1)
exten => s,n,Macro(user-callerid,)
exten => s,n,Set(QUEUEUSER=${IF($[${LEN(${QUEUEUSER})}>0]?${QUEUEUSER}:${AMPUSER})})
exten => s,n,Set(QUEUESTAT=LOGGEDOUT)
exten => s,n,AGI(queue_devstate.agi,getqueues,${QUEUEUSER})
exten => s,n,GotoIf($["${QUEUESTAT}" = "LOGGEDOUT"]?activate)
exten => s,n,GotoIf($["${QUEUESTAT}" = "LOGGEDIN"]?deactivate)
exten => s,n,GotoIf($["${QUEUESTAT}" = "STATIC"]?static:end)
exten => s,n(deactivate),Noop(Agent Logged out)
exten => s,n,Macro(toggle-del-agent,)
exten => s,n(logout),Set(STATE=NOT_INUSE)
exten => s,n,Gosub(sstate,1())
exten => s,n,Playback(agent-loggedoff)
exten => s,n,Macro(hangupcall,)
exten => s,n(activate),Noop(Agent Logged In)
exten => s,n,Macro(toggle-add-agent,)
exten => s,n,GotoIf($["${QAGENT_UNAUTHORIZED}"="1"]?logout)
exten => s,n,Set(STATE=INUSE)
exten => s,n,Gosub(sstate,1())
exten => s,n,Playback(agent-loginok)
exten => s,n,SayDigits(${QUEUEUSER})
exten => s,n,Macro(hangupcall,)
exten => s,n(static),Noop(User is a Static Agent)
exten => s,n,Set(STATE=INUSE)
exten => s,n,Gosub(sstate,1())
exten => s,n,Playback(agent-loginok)
exten => s,n,Macro(hangupcall,)

exten => sstate,1,Set(DEVICES=${DB(AMPUSER/${QUEUEUSER}/device)})
exten => sstate,n,GotoIf($["${DEVICES}" = "" ]?return)
exten => sstate,n,Set(LOOPCNT=${FIELDQTY(DEVICES,&)})
exten => sstate,n,Set(ITER=1)
exten => sstate,n(begin),Set(DEVICE_STATE(Custom:QUEUE${CUT(DEVICES,&,${ITER})}*${QUEUENO})=${STATE})
exten => sstate,n,Set(ITER=$[${ITER} + 1])
exten => sstate,n,GotoIf($[${ITER} <= ${LOOPCNT}]?begin)
exten => sstate,n(return),Return()

;--== end of [app-queue-toggle] ==--;


[app-all-queue-toggle]
exten => s,1(start),Answer
exten => s,n,Wait(1)
exten => s,n,Macro(user-callerid,)
exten => s,n,AGI(queue_devstate.agi,getall,${AMPUSER})
exten => s,n,GotoIf($["${QUEUESTAT}" = "NOQUEUES"]?skip)
exten => s,n,Set(TOGGLE_MACRO=${IF($["${QUEUESTAT}"="LOGGEDOUT"]?toggle-add-agent:toggle-del-agent)})
exten => s,n,Set(STATE=${IF($["${QUEUESTAT}"="LOGGEDOUT"]?INUSE:NOT_INUSE)})
exten => s,n,Set(LOOPCNTALL=${FIELDQTY(USERQUEUES,-)})
exten => s,n,Set(ITERALL=1)
exten => s,n(begin),Set(QUEUENO=${CUT(USERQUEUES,-,${ITERALL})})
exten => s,n,Set(ITERALL=$[${ITERALL}+1])
exten => s,n,Macro(${TOGGLE_MACRO},)
exten => s,n,Gosub(app-queue-toggle,sstate,1())
exten => s,n,GotoIf($[${ITERALL} <= ${LOOPCNTALL}]?begin)
exten => s,n(skip),ExecIf($["${QUEUESTAT}"="LOGGEDIN" | "${QUEUESTAT}"="NOQUEUES"]?Playback(agent-loggedoff))
exten => s,n,ExecIf($["${QUEUESTAT}"="LOGGEDOUT"]?Playback(agent-loginok))
exten => s,n,ExecIf($["${QUEUESTAT}"="LOGGEDOUT"]?SayDigits(${AMPUSER}))
exten => s,n,Macro(hangupcall,)

;--== end of [app-all-queue-toggle] ==--;


[macro-toggle-del-agent]
exten => s,1,Macro(user-callerid,SKIPTTL,)
exten => s,n,Set(QUEUEUSER=${IF($[${LEN(${QUEUEUSER})}>0]?${QUEUEUSER}:${AMPUSER})})
exten => s,n,Set(QUEUEUSERCIDNAME="${DB(AMPUSER/${QUEUEUSER}/cidname)}")
exten => s,n,RemoveQueueMember(${QUEUENO},Local/${QUEUEUSER}@from-queue/n)
exten => s,n,RemoveQueueMember(${QUEUENO},Local/${QUEUEUSER}@from-internal/n)
exten => s,n,UserEvent(RefreshQueue)
exten => s,n,QueueLog(${QUEUENO},MANAGER,${IF($[${LEN(${QUEUEUSERCIDNAME})}>0]?${QUEUEUSERCIDNAME}:${QUEUEUSER})},REMOVEMEMBER,)
exten => s,n,MacroExit()

;--== end of [macro-toggle-del-agent] ==--;


[macro-toggle-add-agent]
exten => s,1,Macro(user-callerid,SKIPTTL,)
exten => s,n,Set(QUEUEUSER=${IF($[${LEN(${QUEUEUSER})}>0]?${QUEUEUSER}:${AMPUSER})})
exten => s,n,Set(QUEUEUSERCIDNAME="${DB(AMPUSER/${QUEUEUSER}/cidname)}")
exten => s,n,GotoIf($["${DB(QPENALTY/${QUEUENO}/dynmemberonly)}" = "yes" & ${DB_EXISTS(QPENALTY/${QUEUENO}/agents/${QUEUEUSER})} != 1]?invalid)
exten => s,n,ExecIf($["${DB(AMPUSER/${QUEUEUSER}/queues/qnostate)}" != "ignorestate"]?AddQueueMember(${QUEUENO},Local/${QUEUEUSER}@from-queue/n,${DB(QPENALTY/${QUEUENO}/agents/${QUEUEUSER})},,${QUEUEUSERCIDNAME},hint:${QUEUEUSER}@ext-local))
exten => s,n,ExecIf($["${DB(AMPUSER/${QUEUEUSER}/queues/qnostate)}" = "ignorestate"]?AddQueueMember(${QUEUENO},Local/${QUEUEUSER}@from-queue/n,${DB(QPENALTY/${QUEUENO}/agents/${QUEUEUSER})},,${QUEUEUSERCIDNAME}))
exten => s,n,UserEvent(AgentLogin,Agent: ${QUEUEUSER})
exten => s,n,QueueLog(${QUEUENO},MANAGER,${IF($[${LEN(${QUEUEUSERCIDNAME})}>0]?${QUEUEUSERCIDNAME}:${QUEUEUSER})},ADDMEMBER,)
exten => s,n,MacroExit()
exten => s,n(invalid),Playback(pbx-invalid)
exten => s,n,Set(QAGENT_UNAUTHORIZED=1)
exten => s,n,MacroExit()

;--== end of [macro-toggle-add-agent] ==--;


[app-queue-pause-toggle]
exten => s,1(start),Answer
exten => s,n,Wait(1)
exten => s,n,Macro(user-callerid,)
exten => s,n,Set(QUEUEUSER=${IF($[${LEN(${ARG2})}>0]?${ARG2}:${AMPUSER})})
exten => s,n,Set(MEMBR=Local/${QUEUEUSER}@from-queue/n)
exten => s,n,Set(PAUSE_STATE=${QUEUE_MEMBER(${ARG1},paused,${MEMBR})})
exten => s,n,Set(QUEUE_MEMBER(${ARG1},paused,${MEMBR})=${IF($[${PAUSE_STATE}]?0:1)})
exten => s,n,Playback(dictate/pause&${IF($[${PAUSE_STATE}]?de-activated:activated)})
exten => s,n,ExecIf($[${ARG2}]?Return())
exten => s,n,Macro(hangupcall,)

;--== end of [app-queue-pause-toggle] ==--;


[app-all-queue-pause-toggle]
exten => s,1(start),Answer
exten => s,n,Wait(1)
exten => s,n,Macro(user-callerid,)
exten => s,n,AGI(queue_devstate.agi,toggle-pause-all,${AMPUSER})
exten => s,n,Playback(dictate/pause&${IF($[${TOGGLEPAUSED}]?activated:de-activated)})
exten => s,n,Macro(hangupcall,)

;--== end of [app-all-queue-pause-toggle] ==--;


[ext-queues]
exten => 700,1,Macro(user-callerid,)
exten => 700,n,Answer
exten => 700,n,Macro(blkvm-set,reset)
exten => 700,n,ExecIf($["${REGEX("(M[(]auto-blkvm[)])" ${DIAL_OPTIONS})}" != "1"]?Set(_DIAL_OPTIONS=${DIAL_OPTIONS}M(auto-blkvm)))
exten => 700,n,Set(__NODEST=${EXTEN})
exten => 700,n,Set(QCIDPP=${IF($[${LEN(${VQ_CIDPP})}>0]?${VQ_CIDPP}: )})
exten => 700,n,Set(VQ_CIDPP=)
exten => 700,n,ExecIf($["${QCIDPP}"!=""]?Macro(prepend-cid,${QCIDPP}))
exten => 700,n,Set(QAINFO=${IF($[${LEN(${VQ_AINFO})}>0]?${VQ_AINFO}: )})
exten => 700,n,Set(VQ_AINFO=)
exten => 700,n,ExecIf($["${QAINFO}"!=""]?Set(__ALERT_INFO=${QAINFO}))
exten => 700,n,Set(QJOINMSG=${IF($[${LEN(${VQ_JOINMSG})}>0]?${IF($["${VQ_JOINMSG}"!="0"]?${VQ_JOINMSG}: )}: )})
exten => 700,n,Set(VQ_JOINMSG=)
exten => 700,n,Set(QRINGOPTS=r)
exten => 700,n,Set(QRETRY=${IF($[${LEN(${VQ_RETRY})}>0]?${VQ_RETRY}: )})
exten => 700,n,Set(VQ_RETRY=)
exten => 700,n(qoptions),Set(QOPTIONS=${IF($[${LEN(${VQ_OPTIONS})}>0]?${VQ_OPTIONS}:t)}${QCANCELMISSED}${QRINGOPTS}${QRETRY})
exten => 700,n,Set(VQ_OPTIONS=)
exten => 700,n(qgosub),Set(QGOSUB=${IF($[${LEN(${VQ_GOSUB})}>0]?${VQ_GOSUB}:${QGOSUB})})
exten => 700,n,Set(VQ_GOSUB=)
exten => 700,n(qagi),Set(QAGI=${IF($[${LEN(${VQ_AGI})}>0]?${VQ_AGI}:${QAGI})})
exten => 700,n,Set(VQ_AGI=)
exten => 700,n(qrule),Set(QRULE=${IF($[${LEN(${VQ_RULE})}>0]?${IF($["${VQ_RULE}"!="0"]?${VQ_RULE}: )}:${QRULE})})
exten => 700,n,Set(VQ_RULE=)
exten => 700,n(qposition),Set(QPOSITION=${IF($[${LEN(${VQ_POSITION})}>0]?${VQ_POSITION}:${QPOSITION})})
exten => 700,n,Set(VQ_POSITION=)
exten => 700,n,Gosub(sub-record-check,s,1(q,700,dontcare))
exten => 700,n,ExecIf($["${QJOINMSG}"!=""]?Playback(${QJOINMSG}, ))
exten => 700,n,QueueLog(700,${UNIQUEID},NONE,DID,${FROM_DID})
exten => 700,n,Set(QAANNOUNCE=${IF($[${LEN(${VQ_AANNOUNCE})}>0]?${IF($["${VQ_AANNOUNCE}"!="0"]?${VQ_AANNOUNCE}: )}: )})
exten => 700,n,Set(VQ_AANNOUNCE=)
exten => 700,n,Set(QMOH=${IF($["${VQ_MOH}"!=""]?${VQ_MOH}:none)})
exten => 700,n,Set(VQ_MOH=)
exten => 700,n,ExecIf($["${QMOH}"!=""]?Set(__MOHCLASS=${QMOH}))
exten => 700,n,ExecIf($["${MOHCLASS}"!=""]?Set(CHANNEL(musicclass)=${MOHCLASS}))
exten => 700,n,Set(QMAXWAIT=${IF($[${LEN(${VQ_MAXWAIT})}>0]?${VQ_MAXWAIT}:300)})
exten => 700,n,Set(VQ_MAXWAIT=)
exten => 700,n,Set(QUEUENUM=700)
exten => 700,n,Set(QUEUEJOINTIME=${EPOCH})
exten => 700,n(qcall),Queue(700,${QOPTIONS},,${QAANNOUNCE},${QMAXWAIT},${QAGI},,${QGOSUB},${QRULE},${QPOSITION})
exten => 700,n,Macro(blkvm-clr,)
exten => 700,n,Gosub(sub-record-cancel,s,1())
exten => 700,n,Set(__NODEST=)
exten => 700,n,Set(_QUEUE_PRIO=0)
exten => 700,n,Set(QRINGOPTS=)
exten => 700,n,Set(QDEST=${VQ_DEST})
exten => 700,n,Set(VQ_DEST=)
exten => 700,n(gotodest),GotoIf($["${QDEST}"=""]?ext-local,vmu130,1:${CUT(QDEST,^,1)},${CUT(QDEST,^,2)},${CUT(QDEST,^,3)})

exten => *45700,1,Set(QUEUENO=700)
exten => *45700,n,Goto(app-queue-toggle,s,start)

exten => *46700,1,Gosub(app-queue-pause-toggle,s,1(700))

exten => _*45XXXXX*XXX,1,Set(QUEUENO=${EXTEN:9:3})
exten => _*45XXXXX*XXX,n,Set(QUEUEUSER=${EXTEN:3:5})
exten => _*45XXXXX*XXX,n,Goto(app-queue-toggle,s,start)
exten => _*45XXXXX*XXX,hint,Custom:QUEUE${EXTEN:3}

exten => _*45XXX*XXX,1,Set(QUEUENO=${EXTEN:7:3})
exten => _*45XXX*XXX,n,Set(QUEUEUSER=${EXTEN:3:3})
exten => _*45XXX*XXX,n,Goto(app-queue-toggle,s,start)
exten => _*45XXX*XXX,hint,Custom:QUEUE${EXTEN:3}

exten => *45,1,Goto(app-all-queue-toggle,s,start)

exten => _*45*X.,1,Goto(app-all-queue-toggle,s,start)
exten => _*45*X.,hint,${DB(AMPUSER/${EXTEN:4}/queuehint)}

exten => *46,1,Goto(app-all-queue-pause-toggle,s,1)

exten => _*46*X.,1,Goto(app-all-queue-pause-toggle,s,1)
exten => _*46*X.,hint,${DB(AMPUSER/${EXTEN:4}/pausequeuehint)}

exten => _*46*XXX*700,1,Gosub(app-queue-pause-toggle,s,1(700,${DB(DEVICE/${EXTEN:4:3}/user)}))
exten => _*46*XXX*700,hint,Queue:700_pause_Local/${DB(DEVICE/${EXTEN:4:3}/user)}@from-queue/n

exten => *47,1,Goto(app-queue-caller-count,s,1)

exten => *47*700,1,Set(QUEUE=700)
exten => *47*700,n,Goto(app-queue-caller-count,s,1)

exten => h,1,Macro(hangupcall,)

;--== end of [ext-queues] ==--;


[from-queue]
exten => 700,1,Goto(from-internal,${QAGENT},1)

exten => _.,1,Set(QAGENT=${EXTEN})
exten => _.,n,Set(__FROMQ=true)
exten => _.,n,GotoIf($["${LEN(${NODEST})}" = "0"]?hangup)
exten => _.,n,GotoIf($["${DIALPLAN_EXISTS(from-queue,${NODEST},1)}" = "1"]?${NODEST},1:hangup)
exten => _.,n(hangup),Macro(hangupcall,)

exten => h,1,Macro(hangupcall,)

;--== end of [from-queue] ==--;


[app-queue-caller-count]
exten => s,1,AGI(queue_devstate.agi,getuserQueues,${CALLERID(num)},${QUEUE})
exten => s,n,Answer
exten => s,n,Set(COUNT=0)
exten => s,n,Noop(${QUEUES})
exten => s,n,GotoIf($["${QUEUES}" = "0"]?skip)
exten => s,n,Wait(1)
exten => s,n,Set(LOOPCNT=${FIELDQTY(QUEUES,&)})
exten => s,n,Set(ITER=1)
exten => s,n(begin1),Set(QUEUE=${CUT(QUEUES,&,${ITER})})
exten => s,n,Set(COUNT=$[${COUNT} + ${QUEUE_WAITING_COUNT(${QUEUE})}])
exten => s,n(end1),Set(ITER=$[${ITER} + 1])
exten => s,n,GotoIf($[${ITER} <= ${LOOPCNT}]?begin1)
exten => s,n(skip),Wait(1)
exten => s,n,SayNumber(${COUNT},f)
exten => s,n,Playback(queue-quantity2)
exten => s,n,Return()

;--== end of [app-queue-caller-count] ==--;


[macro-auto-blkvm]
exten => s,1,ExecIf($["${FROMQ}" = "true" & "${CALLFILENAME}" != "" & "${CDR(recordingfile)}" = ""]?Set(CDR(recordingfile)=${CALLFILENAME}.${MON_FMT}))
exten => s,n,Set(__MACRO_RESULT=)
exten => s,n,Set(CFIGNORE=)
exten => s,n,Set(MASTER_CHANNEL(CFIGNORE)=)
exten => s,n,Set(FORWARD_CONTEXT=from-internal)
exten => s,n,Set(MASTER_CHANNEL(FORWARD_CONTEXT)=from-internal)
exten => s,n,Macro(blkvm-clr,)
exten => s,n,ExecIf($[!${REGEX("[^0-9]" ${DIALEDPEERNUMBER})} && "${DB(AMPUSER/${AMPUSER}/cidname)}" != ""]?Set(MASTER_CHANNEL(CONNECTEDLINE(num))=${DIALEDPEERNUMBER}))
exten => s,n,ExecIf($[!${REGEX("[^0-9]" ${DIALEDPEERNUMBER})} && "${DB(AMPUSER/${AMPUSER}/cidname)}" != ""]?Set(MASTER_CHANNEL(CONNECTEDLINE(name))=${DB(AMPUSER/${DIALEDPEERNUMBER}/cidname)}))

;--== end of [macro-auto-blkvm] ==--;


[from-queue-exten-only-x]
include => from-internal
exten => foo,1,Noop(bar)

;--== end of [from-queue-exten-only-x] ==--;


[from-queue-exten-internal]
include => from-queue-exten-only
include => from-queue-exten-only-x
include => from-internal
exten => foo,1,Noop(bar)

;--== end of [from-queue-exten-internal] ==--;


[from-queue-exten-only]
exten => _XXX,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/cidnum)} = 0]?from-queue-exten-only-x,${EXTEN},1)
exten => _XXX,n,Set(RingGroupMethod=none)
exten => _XXX,n,Set(CHANNEL(language)=${MASTER_CHANNEL(CHANNEL(language))})
exten => _XXX,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => _XXX,n(checkrecord),Set(CALLTYPE_OVERRIDE=external)
exten => _XXX,n,ExecIf($[!${LEN(${FROMEXTEN})}]?Set(FROMEXTEN=${IF(${LEN(${NODEST})}?${NODEST}:external)}))
exten => _XXX,n,Gosub(sub-record-check,s,1(exten,${EXTEN},))
exten => _XXX,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},${EXTEN})
exten => _XXX,n,GotoIf($["${CALLER_DEST}"!=""&&"${DIALSTATUS}"="ANSWER"]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => _XXX,n,Hangup

exten => _XXXX,1,GotoIf($[${DB_EXISTS(AMPUSER/${EXTEN}/cidnum)} = 0]?from-queue-exten-only-x,${EXTEN},1)
exten => _XXXX,n,Set(RingGroupMethod=none)
exten => _XXXX,n,Set(CHANNEL(language)=${MASTER_CHANNEL(CHANNEL(language))})
exten => _XXXX,n,Set(QDOPTS=${IF($["${CALLER_DEST}"!=""]?g)}${IF($["${AGENT_DEST}"!=""]?F(${AGENT_DEST}))})
exten => _XXXX,n(checkrecord),Set(CALLTYPE_OVERRIDE=external)
exten => _XXXX,n,ExecIf($[!${LEN(${FROMEXTEN})}]?Set(FROMEXTEN=${IF(${LEN(${NODEST})}?${NODEST}:external)}))
exten => _XXXX,n,Gosub(sub-record-check,s,1(exten,${EXTEN},))
exten => _XXXX,n,Macro(dial-one,,${DIAL_OPTIONS}${QDOPTS},${EXTEN})
exten => _XXXX,n,GotoIf($["${CALLER_DEST}"!=""&&"${DIALSTATUS}"="ANSWER"]?${CUT(CALLER_DEST,^,1)},${CUT(CALLER_DEST,^,2)},${CUT(CALLER_DEST,^,3)})
exten => _XXXX,n,Hangup

exten => h,1,Macro(hangupcall,)

;--== end of [from-queue-exten-only] ==--;


[play-system-recording]
exten => 7,1,Answer
exten => 7,n,Playback(custom/DIRECTIONS)
exten => 7,n,Hangup

exten => 5,1,Answer
exten => 5,n,Playback(custom/IVR-CLOSED)
exten => 5,n,Hangup

exten => 11,1,Answer
exten => 11,n,Playback(custom/IVR_COUNSELING)
exten => 11,n,Hangup

exten => 6,1,Answer
exten => 6,n,Playback(custom/IVR-HOLIDAY)
exten => 6,n,Hangup

exten => 4,1,Answer
exten => 4,n,Playback(custom/IVR-MAIN)
exten => 4,n,Hangup

exten => 12,1,Answer
exten => 12,n,Playback(custom/Manual_Toggle)
exten => 12,n,Hangup

exten => 10,1,Answer
exten => 10,n,Playback(custom/77outage20161009)
exten => 10,n,Hangup

;--== end of [play-system-recording] ==--;


[app-recordings]
exten => *297,1,Macro(user-callerid,)
exten => *297,n,Wait(2)
exten => *297,n,Macro(systemrecording,docheck,custom/DIRECTIONS,1776,en)

exten => *295,1,Macro(user-callerid,)
exten => *295,n,Wait(2)
exten => *295,n,Macro(systemrecording,docheck,custom/IVR-CLOSED,1776,en)

exten => *298,1,Macro(user-callerid,)
exten => *298,n,Wait(2)
exten => *298,n,Macro(systemrecording,docheck,custom/IVR_COUNSELING,1776,en)

exten => *296,1,Macro(user-callerid,)
exten => *296,n,Wait(2)
exten => *296,n,Macro(systemrecording,docheck,custom/IVR-HOLIDAY,1776,en)

exten => *294,1,Macro(user-callerid,)
exten => *294,n,Wait(2)
exten => *294,n,Macro(systemrecording,docheck,custom/IVR-MAIN,1776,en)

exten => *2912,1,Macro(user-callerid,)
exten => *2912,n,Wait(2)
exten => *2912,n,Macro(systemrecording,docheck,custom/Manual_Toggle,1776,en)

exten => *2910,1,Macro(user-callerid,)
exten => *2910,n,Wait(2)
exten => *2910,n,Macro(systemrecording,docheck,custom/77outage20161009,1776,en)

;--== end of [app-recordings] ==--;


[systemrecording-gui]
exten => dorecord,1,Record(${RECFILE}.wav,,,k)

exten => h,1,System(touch ${RECFILE}.finished)
exten => h,n(exit),Hangup

;--== end of [systemrecording-gui] ==--;


[macro-systemrecording]
exten => s,1,GotoIf($["${ARG2}" = ""]?invalid)
exten => s,n,Set(TMPLANG=${CHANNEL(language)})
exten => s,n,ExecIf($["${ARG4}" != ""]?Set(TMPLANG=${ARG4}))
exten => s,n,Set(RECFILE=${TMPLANG}/${ARG2})
exten => s,n,Set(LISTEN=docheck)
exten => s,n,ExecIf($["${ARG3}" != ""]?Authenticate(${ARG3}))
exten => s,n,Goto(${ARG1},1)

exten => dorecord,1,Set(TMPRECFILE=${RECFILE}-TMP)
exten => dorecord,n,Background(say-temp-msg-prs-pound,,${CHANNEL(language)})
exten => dorecord,n,Record(${TMPRECFILE}.${CHANNEL(audioreadformat)},,,k)
exten => dorecord,n,Set(LISTEN=dochecknolanguage)
exten => dorecord,n,Goto(confmenu,1)

exten => dochecknolanguage,1,Playback(beep)
exten => dochecknolanguage,n(dc_start),Background(${TMPRECFILE},m,,macro-systemrecording)
exten => dochecknolanguage,n,Wait(1)
exten => dochecknolanguage,n,Goto(confmenu,1)

exten => docheck,1,Playback(beep)
exten => docheck,n(dc_start),Background(${RECFILE},m,${CHANNEL(language)},macro-systemrecording)
exten => docheck,n,Wait(1)
exten => docheck,n,Goto(confmenu,1)

exten => confmenu,1,Background(to-listen-to-it&press-1&to-accept-recording&press-2&to-rerecord-it&press-star&language&press-3,m,${CHANNEL(language)},macro-systemrecording)
exten => confmenu,n,Read(RECRESULT,,1,,,4)
exten => confmenu,n,GotoIf($["x${RECRESULT}"="x*"]?dorecord,1)
exten => confmenu,n,GotoIf($["x${RECRESULT}"="x1"]?${LISTEN},2)
exten => confmenu,n,GotoIf($["x${RECRESULT}"="x2"]?doaccept,1)
exten => confmenu,n,GotoIf($["x${RECRESULT}"="x3"]?switchlang,1)
exten => confmenu,n,Goto(1)

exten => doaccept,1,Set(EXISTS=${STAT(e,${ASTVARLIBDIR}/sounds/${TMPRECFILE}.${CHANNEL(audioreadformat)})})
exten => doaccept,n,Noop(${EXISTS})
exten => doaccept,n,GotoIf($["${EXISTS}" != "1"]?exit)
exten => doaccept,n,System(touch ${ASTVARLIBDIR}/sounds/${RECFILE}.finished)
exten => doaccept,n,GotoIf($["x${TMPRECFILE}"="x"]?exit)
exten => doaccept,n,System(mv ${ASTVARLIBDIR}/sounds/${TMPRECFILE}.${CHANNEL(audioreadformat)} ${ASTVARLIBDIR}/sounds/${RECFILE}.${CHANNEL(audioreadformat)})
exten => doaccept,n,Playback(wait-moment)
exten => doaccept,n,AGI(recordings.agi)
exten => doaccept,n,Set(TMPRECFILE=${RECFILE})
exten => doaccept,n(exit),Playback(auth-thankyou)
exten => doaccept,n,Goto(confmenu,1)

exten => switchlang,1,Playback(language&is-set-to)
exten => switchlang,n,SayAlpha(${TMPLANG})
exten => switchlang,n,Playback(after-the-tone)
exten => switchlang,n,Background(press-1)
exten => switchlang,n,SayAlpha(en)
exten => switchlang,n,Playback(beep)
exten => switchlang,n,Read(LANGRESULT,,1,,,4)
exten => switchlang,n,ExecIf($["x${LANGRESULT}"="x1"]?Set(TMPLANG=en))
exten => switchlang,n,Set(RECFILE=${TMPLANG}/${ARG2})
exten => switchlang,n,Playback(language&is-set-to)
exten => switchlang,n,SayAlpha(${TMPLANG})
exten => switchlang,n,Goto(confmenu,1)

exten => invalid,1,Playback(pm-invalid-option)
exten => invalid,n,Hangup

exten => 1,1,Goto(${LISTEN},dc_start)

exten => 2,1,Goto(doaccept,1)

exten => 3,1,Goto(switchlang,1)

exten => *,1,Goto(dorecord,1)

exten => t,1,Playback(goodbye)
exten => t,n,Hangup

exten => i,1,Playback(pm-invalid-option)
exten => i,n,Goto(confmenu,1)

exten => h,1,System(touch ${ASTVARLIBDIR}/sounds/${RECFILE}.finished)
exten => h,n,GotoIf($["x${TMPRECFILE}"="x"]?exit)
exten => h,n,System(mv ${ASTVARLIBDIR}/sounds/${TMPRECFILE}.${CHANNEL(audioreadformat)} ${ASTVARLIBDIR}/sounds/${CHANNEL(language)}/${RECFILE}.${CHANNEL(audioreadformat)})
exten => h,n(exit),Hangup

;--== end of [macro-systemrecording] ==--;


[ext-group]
exten => 331,1,GotoIf($["${__RINGINGSENT}" = "TRUE"]?cid)
exten => 331,n,Playtones(ring)
exten => 331,n,Progress
exten => 331,n(cid),Macro(user-callerid,)
exten => 331,n,Macro(blkvm-setifempty,)
exten => 331,n,GotoIf($["${GOSUB_RETVAL}" = "TRUE"]?skipov)
exten => 331,n,Macro(blkvm-set,reset)
exten => 331,n,Set(__NODEST=)
exten => 331,n(skipov),Set(RRNODEST=${NODEST})
exten => 331,n(skipvmblk),Set(__NODEST=${EXTEN})
exten => 331,n,GosubIf($[${DB_EXISTS(RINGGROUP/331/changecid)} = 1 & "${DB(RINGGROUP/331/changecid)}" != "default" & "${DB(RINGGROUP/331/changecid)}" != ""]?sub-rgsetcid,s,1())
exten => 331,n,Macro(prepend-cid,A: )
exten => 331,n,Set(_CFIGNORE=TRUE)
exten => 331,n,Set(_FORWARD_CONTEXT=block-cf)
exten => 331,n,Gosub(sub-record-check,s,1(rg,331,dontcare))
exten => 331,n,Set(RingGroupMethod=ringall)
exten => 331,n(DIALGRP),Macro(dial,18,${DIAL_OPTIONS},131)
exten => 331,n,Gosub(sub-record-cancel,s,1())
exten => 331,n,Set(RingGroupMethod=)
exten => 331,n,GotoIf($["foo${RRNODEST}" != "foo"]?nodest)
exten => 331,n,Set(_CFIGNORE=)
exten => 331,n,Set(_FORWARD_CONTEXT=from-internal)
exten => 331,n,Set(__NODEST=)
exten => 331,n,Macro(blkvm-clr,)
exten => 331,n,Goto(ext-local,vmu131,1)
exten => 331,n(nodest),Noop(SKIPPING DEST, CALL CAME FROM Q/RG: ${RRNODEST})

exten => 332,1,GotoIf($["${__RINGINGSENT}" = "TRUE"]?cid)
exten => 332,n,Playtones(ring)
exten => 332,n,Progress
exten => 332,n(cid),Macro(user-callerid,)
exten => 332,n,Macro(blkvm-setifempty,)
exten => 332,n,GotoIf($["${GOSUB_RETVAL}" = "TRUE"]?skipov)
exten => 332,n,Macro(blkvm-set,reset)
exten => 332,n,Set(__NODEST=)
exten => 332,n(skipov),Set(RRNODEST=${NODEST})
exten => 332,n(skipvmblk),Set(__NODEST=${EXTEN})
exten => 332,n,GosubIf($[${DB_EXISTS(RINGGROUP/332/changecid)} = 1 & "${DB(RINGGROUP/332/changecid)}" != "default" & "${DB(RINGGROUP/332/changecid)}" != ""]?sub-rgsetcid,s,1())
exten => 332,n,Gosub(sub-record-check,s,1(rg,332,dontcare))
exten => 332,n,Set(RingGroupMethod=ringall)
exten => 332,n(DIALGRP),Macro(dial,18,${DIAL_OPTIONS},130)
exten => 332,n,Gosub(sub-record-cancel,s,1())
exten => 332,n,Set(RingGroupMethod=)
exten => 332,n,GotoIf($["foo${RRNODEST}" != "foo"]?nodest)
exten => 332,n,Set(__NODEST=)
exten => 332,n,Macro(blkvm-clr,)
exten => 332,n,Goto(ivr-3,s,1)
exten => 332,n(nodest),Noop(SKIPPING DEST, CALL CAME FROM Q/RG: ${RRNODEST})

exten => 333,1,GotoIf($["${__RINGINGSENT}" = "TRUE"]?cid)
exten => 333,n,Playtones(ring)
exten => 333,n,Progress
exten => 333,n(cid),Macro(user-callerid,)
exten => 333,n,Macro(blkvm-setifempty,)
exten => 333,n,GotoIf($["${GOSUB_RETVAL}" = "TRUE"]?skipov)
exten => 333,n,Macro(blkvm-set,reset)
exten => 333,n,Set(__NODEST=)
exten => 333,n(skipov),Set(RRNODEST=${NODEST})
exten => 333,n(skipvmblk),Set(__NODEST=${EXTEN})
exten => 333,n,GosubIf($[${DB_EXISTS(RINGGROUP/333/changecid)} = 1 & "${DB(RINGGROUP/333/changecid)}" != "default" & "${DB(RINGGROUP/333/changecid)}" != ""]?sub-rgsetcid,s,1())
exten => 333,n,Set(_CFIGNORE=TRUE)
exten => 333,n,Set(_FORWARD_CONTEXT=block-cf)
exten => 333,n,Gosub(sub-record-check,s,1(rg,333,dontcare))
exten => 333,n,Set(RingGroupMethod=ringall)
exten => 333,n(DIALGRP),Macro(dial,20,${DIAL_OPTIONS},139)
exten => 333,n,Gosub(sub-record-cancel,s,1())
exten => 333,n,Set(RingGroupMethod=)
exten => 333,n,GotoIf($["foo${RRNODEST}" != "foo"]?nodest)
exten => 333,n,Set(_CFIGNORE=)
exten => 333,n,Set(_FORWARD_CONTEXT=from-internal)
exten => 333,n,Set(__NODEST=)
exten => 333,n,Macro(blkvm-clr,)
exten => 333,n,Goto(ext-local,vmu139,1)
exten => 333,n(nodest),Noop(SKIPPING DEST, CALL CAME FROM Q/RG: ${RRNODEST})

exten => 999999,1,GotoIf($["${__RINGINGSENT}" = "TRUE"]?cid)
exten => 999999,n,Playtones(ring)
exten => 999999,n,Progress
exten => 999999,n(cid),Macro(user-callerid,)
exten => 999999,n,Macro(blkvm-setifempty,)
exten => 999999,n,GotoIf($["${GOSUB_RETVAL}" = "TRUE"]?skipov)
exten => 999999,n,Macro(blkvm-set,reset)
exten => 999999,n,Set(__NODEST=)
exten => 999999,n(skipov),Set(RRNODEST=${NODEST})
exten => 999999,n(skipvmblk),Set(__NODEST=${EXTEN})
exten => 999999,n,GosubIf($[${DB_EXISTS(RINGGROUP/999999/changecid)} = 1 & "${DB(RINGGROUP/999999/changecid)}" != "default" & "${DB(RINGGROUP/999999/changecid)}" != ""]?sub-rgsetcid,s,1())
exten => 999999,n,Gosub(sub-record-check,s,1(rg,999999,dontcare))
exten => 999999,n,Set(RingGroupMethod=ringall)
exten => 999999,n(DIALGRP),Macro(dial,1,${DIAL_OPTIONS},102-104-106-107-128-132-134-139-143-351-352-353-354-355-356-357-358-359-360-361-362-363-364-365-366-367-368-369-370-372-373-381-382-383-384)
exten => 999999,n,Gosub(sub-record-cancel,s,1())
exten => 999999,n,Set(RingGroupMethod=)
exten => 999999,n,GotoIf($["foo${RRNODEST}" != "foo"]?nodest)
exten => 999999,n,Set(__NODEST=)
exten => 999999,n,Macro(blkvm-clr,)
exten => 999999,n,Goto(app-blackhole,hangup,1)
exten => 999999,n(nodest),Noop(SKIPPING DEST, CALL CAME FROM Q/RG: ${RRNODEST})

exten => h,1,Macro(hangupcall,)

;--== end of [ext-group] ==--;


[app-pickup]
exten => *#331,1,Set(ALLOWEDMEM=131)
exten => *#331,n,Macro(user-callerid,)
exten => *#331,n,Set(EXTENS=${FIELDQTY(ALLOWEDMEM,-)})
exten => *#331,n,Set(ITER=1)
exten => *#331,n,Noop($["${AMPUSER}" == "${CUT(ALLOWEDMEM,-,${ITER})}"])
exten => *#331,n(extloop),GotoIf($["${AMPUSER}" == "${CUT(ALLOWEDMEM,-,${ITER})}"]?pickup)
exten => *#331,n,Set(ITER=$[${ITER}+1])
exten => *#331,n,GotoIf($["${ITER}" <= "${EXTENS}"]?extloop)
exten => *#331,n,Playback(im-sorry&access-denied)
exten => *#331,n,Hangup
exten => *#331,n(pickup),Set(PICKUP_EXTEN=${AMPUSER})
exten => *#331,n,Pickup(${EXTEN:2}&${EXTEN:2}@PICKUPMARK)
exten => *#331,n,Hangup

exten => *#332,1,Set(ALLOWEDMEM=130)
exten => *#332,n,Macro(user-callerid,)
exten => *#332,n,Set(EXTENS=${FIELDQTY(ALLOWEDMEM,-)})
exten => *#332,n,Set(ITER=1)
exten => *#332,n,Noop($["${AMPUSER}" == "${CUT(ALLOWEDMEM,-,${ITER})}"])
exten => *#332,n(extloop),GotoIf($["${AMPUSER}" == "${CUT(ALLOWEDMEM,-,${ITER})}"]?pickup)
exten => *#332,n,Set(ITER=$[${ITER}+1])
exten => *#332,n,GotoIf($["${ITER}" <= "${EXTENS}"]?extloop)
exten => *#332,n,Playback(im-sorry&access-denied)
exten => *#332,n,Hangup
exten => *#332,n(pickup),Set(PICKUP_EXTEN=${AMPUSER})
exten => *#332,n,Pickup(${EXTEN:2}&${EXTEN:2}@PICKUPMARK)
exten => *#332,n,Hangup

exten => *#333,1,Set(ALLOWEDMEM=139)
exten => *#333,n,Macro(user-callerid,)
exten => *#333,n,Set(EXTENS=${FIELDQTY(ALLOWEDMEM,-)})
exten => *#333,n,Set(ITER=1)
exten => *#333,n,Noop($["${AMPUSER}" == "${CUT(ALLOWEDMEM,-,${ITER})}"])
exten => *#333,n(extloop),GotoIf($["${AMPUSER}" == "${CUT(ALLOWEDMEM,-,${ITER})}"]?pickup)
exten => *#333,n,Set(ITER=$[${ITER}+1])
exten => *#333,n,GotoIf($["${ITER}" <= "${EXTENS}"]?extloop)
exten => *#333,n,Playback(im-sorry&access-denied)
exten => *#333,n,Hangup
exten => *#333,n(pickup),Set(PICKUP_EXTEN=${AMPUSER})
exten => *#333,n,Pickup(${EXTEN:2}&${EXTEN:2}@PICKUPMARK)
exten => *#333,n,Hangup

exten => *#999999,1,Set(ALLOWEDMEM=102-104-106-107-128-132-134-139-143-351-352-353-354-355-356-357-358-359-360-361-362-363-364-365-366-367-368-369-370-372-373-381-382-383-384)
exten => *#999999,n,Macro(user-callerid,)
exten => *#999999,n,Set(EXTENS=${FIELDQTY(ALLOWEDMEM,-)})
exten => *#999999,n,Set(ITER=1)
exten => *#999999,n,Noop($["${AMPUSER}" == "${CUT(ALLOWEDMEM,-,${ITER})}"])
exten => *#999999,n(extloop),GotoIf($["${AMPUSER}" == "${CUT(ALLOWEDMEM,-,${ITER})}"]?pickup)
exten => *#999999,n,Set(ITER=$[${ITER}+1])
exten => *#999999,n,GotoIf($["${ITER}" <= "${EXTENS}"]?extloop)
exten => *#999999,n,Playback(im-sorry&access-denied)
exten => *#999999,n,Hangup
exten => *#999999,n(pickup),Set(PICKUP_EXTEN=${AMPUSER})
exten => *#999999,n,Pickup(${EXTEN:2}&${EXTEN:2}@PICKUPMARK)
exten => *#999999,n,Hangup

exten => _*#.,1,Macro(user-callerid,)
exten => _*#.,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => _*#.,n,Pickup(${EXTEN:2}&${EXTEN:2}@PICKUPMARK)
exten => _*#.,n,Hangup

exten => _*#*80.,1,Macro(user-callerid,)
exten => _*#*80.,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => _*#*80.,n,Pickup(${EXTEN:5}&${EXTEN:5}@PICKUPMARK)
exten => _*#*80.,n,Hangup

exten => *#131,1,Macro(user-callerid,)
exten => *#131,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#131,n,Pickup(131&131@PICKUPMARK&331@from-internal&331@from-internal-xfer&331@ext-group)
exten => *#131,n,Hangup

exten => *#*80131,1,Macro(user-callerid,)
exten => *#*80131,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80131,n,Pickup(131&131@PICKUPMARK&331@from-internal&331@from-internal-xfer&331@ext-group)
exten => *#*80131,n,Hangup

exten => *#130,1,Macro(user-callerid,)
exten => *#130,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#130,n,Pickup(130&130@PICKUPMARK&332@from-internal&332@from-internal-xfer&332@ext-group)
exten => *#130,n,Hangup

exten => *#*80130,1,Macro(user-callerid,)
exten => *#*80130,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80130,n,Pickup(130&130@PICKUPMARK&332@from-internal&332@from-internal-xfer&332@ext-group)
exten => *#*80130,n,Hangup

exten => *#139,1,Macro(user-callerid,)
exten => *#139,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#139,n,Pickup(139&139@PICKUPMARK&333@from-internal&333@from-internal-xfer&333@ext-group&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#139,n,Hangup

exten => *#*80139,1,Macro(user-callerid,)
exten => *#*80139,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80139,n,Pickup(139&139@PICKUPMARK&333@from-internal&333@from-internal-xfer&333@ext-group&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80139,n,Hangup

exten => *#102,1,Macro(user-callerid,)
exten => *#102,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#102,n,Pickup(102&102@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#102,n,Hangup

exten => *#*80102,1,Macro(user-callerid,)
exten => *#*80102,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80102,n,Pickup(102&102@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80102,n,Hangup

exten => *#104,1,Macro(user-callerid,)
exten => *#104,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#104,n,Pickup(104&104@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#104,n,Hangup

exten => *#*80104,1,Macro(user-callerid,)
exten => *#*80104,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80104,n,Pickup(104&104@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80104,n,Hangup

exten => *#106,1,Macro(user-callerid,)
exten => *#106,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#106,n,Pickup(106&106@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#106,n,Hangup

exten => *#*80106,1,Macro(user-callerid,)
exten => *#*80106,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80106,n,Pickup(106&106@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80106,n,Hangup

exten => *#107,1,Macro(user-callerid,)
exten => *#107,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#107,n,Pickup(107&107@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#107,n,Hangup

exten => *#*80107,1,Macro(user-callerid,)
exten => *#*80107,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80107,n,Pickup(107&107@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80107,n,Hangup

exten => *#128,1,Macro(user-callerid,)
exten => *#128,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#128,n,Pickup(128&128@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#128,n,Hangup

exten => *#*80128,1,Macro(user-callerid,)
exten => *#*80128,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80128,n,Pickup(128&128@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80128,n,Hangup

exten => *#132,1,Macro(user-callerid,)
exten => *#132,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#132,n,Pickup(132&132@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#132,n,Hangup

exten => *#*80132,1,Macro(user-callerid,)
exten => *#*80132,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80132,n,Pickup(132&132@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80132,n,Hangup

exten => *#134,1,Macro(user-callerid,)
exten => *#134,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#134,n,Pickup(134&134@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#134,n,Hangup

exten => *#*80134,1,Macro(user-callerid,)
exten => *#*80134,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80134,n,Pickup(134&134@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80134,n,Hangup

exten => *#143,1,Macro(user-callerid,)
exten => *#143,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#143,n,Pickup(143&143@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#143,n,Hangup

exten => *#*80143,1,Macro(user-callerid,)
exten => *#*80143,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80143,n,Pickup(143&143@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80143,n,Hangup

exten => *#351,1,Macro(user-callerid,)
exten => *#351,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#351,n,Pickup(351&351@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#351,n,Hangup

exten => *#*80351,1,Macro(user-callerid,)
exten => *#*80351,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80351,n,Pickup(351&351@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80351,n,Hangup

exten => *#352,1,Macro(user-callerid,)
exten => *#352,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#352,n,Pickup(352&352@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#352,n,Hangup

exten => *#*80352,1,Macro(user-callerid,)
exten => *#*80352,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80352,n,Pickup(352&352@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80352,n,Hangup

exten => *#353,1,Macro(user-callerid,)
exten => *#353,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#353,n,Pickup(353&353@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#353,n,Hangup

exten => *#*80353,1,Macro(user-callerid,)
exten => *#*80353,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80353,n,Pickup(353&353@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80353,n,Hangup

exten => *#354,1,Macro(user-callerid,)
exten => *#354,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#354,n,Pickup(354&354@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#354,n,Hangup

exten => *#*80354,1,Macro(user-callerid,)
exten => *#*80354,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80354,n,Pickup(354&354@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80354,n,Hangup

exten => *#355,1,Macro(user-callerid,)
exten => *#355,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#355,n,Pickup(355&355@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#355,n,Hangup

exten => *#*80355,1,Macro(user-callerid,)
exten => *#*80355,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80355,n,Pickup(355&355@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80355,n,Hangup

exten => *#356,1,Macro(user-callerid,)
exten => *#356,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#356,n,Pickup(356&356@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#356,n,Hangup

exten => *#*80356,1,Macro(user-callerid,)
exten => *#*80356,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80356,n,Pickup(356&356@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80356,n,Hangup

exten => *#357,1,Macro(user-callerid,)
exten => *#357,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#357,n,Pickup(357&357@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#357,n,Hangup

exten => *#*80357,1,Macro(user-callerid,)
exten => *#*80357,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80357,n,Pickup(357&357@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80357,n,Hangup

exten => *#358,1,Macro(user-callerid,)
exten => *#358,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#358,n,Pickup(358&358@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#358,n,Hangup

exten => *#*80358,1,Macro(user-callerid,)
exten => *#*80358,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80358,n,Pickup(358&358@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80358,n,Hangup

exten => *#359,1,Macro(user-callerid,)
exten => *#359,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#359,n,Pickup(359&359@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#359,n,Hangup

exten => *#*80359,1,Macro(user-callerid,)
exten => *#*80359,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80359,n,Pickup(359&359@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80359,n,Hangup

exten => *#360,1,Macro(user-callerid,)
exten => *#360,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#360,n,Pickup(360&360@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#360,n,Hangup

exten => *#*80360,1,Macro(user-callerid,)
exten => *#*80360,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80360,n,Pickup(360&360@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80360,n,Hangup

exten => *#361,1,Macro(user-callerid,)
exten => *#361,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#361,n,Pickup(361&361@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#361,n,Hangup

exten => *#*80361,1,Macro(user-callerid,)
exten => *#*80361,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80361,n,Pickup(361&361@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80361,n,Hangup

exten => *#362,1,Macro(user-callerid,)
exten => *#362,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#362,n,Pickup(362&362@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#362,n,Hangup

exten => *#*80362,1,Macro(user-callerid,)
exten => *#*80362,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80362,n,Pickup(362&362@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80362,n,Hangup

exten => *#363,1,Macro(user-callerid,)
exten => *#363,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#363,n,Pickup(363&363@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#363,n,Hangup

exten => *#*80363,1,Macro(user-callerid,)
exten => *#*80363,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80363,n,Pickup(363&363@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80363,n,Hangup

exten => *#364,1,Macro(user-callerid,)
exten => *#364,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#364,n,Pickup(364&364@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#364,n,Hangup

exten => *#*80364,1,Macro(user-callerid,)
exten => *#*80364,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80364,n,Pickup(364&364@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80364,n,Hangup

exten => *#365,1,Macro(user-callerid,)
exten => *#365,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#365,n,Pickup(365&365@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#365,n,Hangup

exten => *#*80365,1,Macro(user-callerid,)
exten => *#*80365,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80365,n,Pickup(365&365@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80365,n,Hangup

exten => *#366,1,Macro(user-callerid,)
exten => *#366,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#366,n,Pickup(366&366@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#366,n,Hangup

exten => *#*80366,1,Macro(user-callerid,)
exten => *#*80366,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80366,n,Pickup(366&366@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80366,n,Hangup

exten => *#367,1,Macro(user-callerid,)
exten => *#367,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#367,n,Pickup(367&367@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#367,n,Hangup

exten => *#*80367,1,Macro(user-callerid,)
exten => *#*80367,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80367,n,Pickup(367&367@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80367,n,Hangup

exten => *#368,1,Macro(user-callerid,)
exten => *#368,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#368,n,Pickup(368&368@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#368,n,Hangup

exten => *#*80368,1,Macro(user-callerid,)
exten => *#*80368,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80368,n,Pickup(368&368@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80368,n,Hangup

exten => *#369,1,Macro(user-callerid,)
exten => *#369,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#369,n,Pickup(369&369@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#369,n,Hangup

exten => *#*80369,1,Macro(user-callerid,)
exten => *#*80369,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80369,n,Pickup(369&369@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80369,n,Hangup

exten => *#370,1,Macro(user-callerid,)
exten => *#370,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#370,n,Pickup(370&370@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#370,n,Hangup

exten => *#*80370,1,Macro(user-callerid,)
exten => *#*80370,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80370,n,Pickup(370&370@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80370,n,Hangup

exten => *#372,1,Macro(user-callerid,)
exten => *#372,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#372,n,Pickup(372&372@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#372,n,Hangup

exten => *#*80372,1,Macro(user-callerid,)
exten => *#*80372,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80372,n,Pickup(372&372@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80372,n,Hangup

exten => *#373,1,Macro(user-callerid,)
exten => *#373,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#373,n,Pickup(373&373@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#373,n,Hangup

exten => *#*80373,1,Macro(user-callerid,)
exten => *#*80373,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80373,n,Pickup(373&373@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80373,n,Hangup

exten => *#381,1,Macro(user-callerid,)
exten => *#381,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#381,n,Pickup(381&381@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#381,n,Hangup

exten => *#*80381,1,Macro(user-callerid,)
exten => *#*80381,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80381,n,Pickup(381&381@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80381,n,Hangup

exten => *#382,1,Macro(user-callerid,)
exten => *#382,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#382,n,Pickup(382&382@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#382,n,Hangup

exten => *#*80382,1,Macro(user-callerid,)
exten => *#*80382,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80382,n,Pickup(382&382@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80382,n,Hangup

exten => *#383,1,Macro(user-callerid,)
exten => *#383,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#383,n,Pickup(383&383@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#383,n,Hangup

exten => *#*80383,1,Macro(user-callerid,)
exten => *#*80383,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80383,n,Pickup(383&383@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80383,n,Hangup

exten => *#384,1,Macro(user-callerid,)
exten => *#384,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#384,n,Pickup(384&384@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#384,n,Hangup

exten => *#*80384,1,Macro(user-callerid,)
exten => *#*80384,n,Set(PICKUP_EXTEN=${AMPUSER})
exten => *#*80384,n,Pickup(384&384@PICKUPMARK&999999@from-internal&999999@from-internal-xfer&999999@ext-group)
exten => *#*80384,n,Hangup

;--== end of [app-pickup] ==--;


[sub-rgsetcid]
exten => s,1,Goto(s-${DB(RINGGROUP/${NODEST}/changecid)},1)

exten => s-fixed,1,ExecIf($["${REGEX("^[\+]?[0-9]+$" ${DB(RINGGROUP/${NODEST}/fixedcid)})}" = "1"]?Set(__TRUNKCIDOVERRIDE=${DB(RINGGROUP/${NODEST}/fixedcid)}))
exten => s-fixed,n,Return()

exten => s-extern,1,ExecIf($["${REGEX("^[\+]?[0-9]+$" ${DB(RINGGROUP/${NODEST}/fixedcid)})}" == "1" & "${FROM_DID}" != ""]?Set(__TRUNKCIDOVERRIDE=${DB(RINGGROUP/${NODEST}/fixedcid)}))
exten => s-extern,n,Return()

exten => s-did,1,ExecIf($["${REGEX("^[\+]?[0-9]+$" ${FROM_DID})}" = "1"]?Set(__REALCALLERIDNUM=${FROM_DID}))
exten => s-did,n,Return()

exten => s-forcedid,1,ExecIf($["${REGEX("^[\+]?[0-9]+$" ${FROM_DID})}" = "1"]?Set(__TRUNKCIDOVERRIDE=${FROM_DID}))
exten => s-forcedid,n,Return()

exten => _s-.,1,Noop(Unknown value for RINGGROUP/${NODEST}/changecid of ${DB(RINGGROUP/${NODEST}/changecid)} set to "default")
exten => _s-.,n,Set(DB(RINGGROUP/${NODEST}/changecid)=default)
exten => _s-.,n,Return()

;--== end of [sub-rgsetcid] ==--;


[timeconditions]
exten => 44,1,Set(DB(TC/44/INUSESTATE)=INUSE)
exten => 44,n,Set(DB(TC/44/NOT_INUSESTATE)=NOT_INUSE)
exten => 44,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 44,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*,America/Detroit?TRUE:FALSE)})
exten => 44,n,GotoIfTime(00:00-07:49,mon-fri,*,*,America/Detroit?truestate)
exten => 44,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 44,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*,America/Detroit?TRUE:FALSE)})
exten => 44,n,GotoIfTime(14:51-23:59,mon-fri,*,*,America/Detroit?truestate)
exten => 44,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 44,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*,America/Detroit?TRUE:FALSE)})
exten => 44,n,GotoIfTime(00:00-23:59,sat,*,*,America/Detroit?truestate)
exten => 44,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 44,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*,America/Detroit?TRUE:FALSE)})
exten => 44,n,GotoIfTime(00:00-23:59,sun,*,*,America/Detroit?truestate)
exten => 44,n(falsestate),GotoIf($["${DB(TC/44):0:4}" = "true"]?truegoto)
exten => 44,n,ExecIf($["${DB(TC/44)}" = "false"]?Set(DB(TC/44)=))
exten => 44,n(falsegoto),Set(DEVICE_STATE(Custom:TC44)=INUSE)
exten => 44,n,ExecIf($["${DB(TC/44)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 44,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu384,1)
exten => 44,n,Set(TCSTATE=false)
exten => 44,n,Set(TCOVERRIDE=${IF($["${DB(TC/44):0:5}" = "false"]?true:false)})
exten => 44,n,Return()
exten => 44,n(truestate),GotoIf($["${DB(TC/44):0:5}" = "false"]?falsegoto)
exten => 44,n,ExecIf($["${DB(TC/44)}" = "true"]?Set(DB(TC/44)=))
exten => 44,n(truegoto),Set(DEVICE_STATE(Custom:TC44)=NOT_INUSE)
exten => 44,n,ExecIf($["${DB(TC/44)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 44,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,384,1)
exten => 44,n,Set(TCSTATE=true)
exten => 44,n,Set(TCOVERRIDE=${IF($["${DB(TC/44):0:4}" = "true"]?true:false)})
exten => 44,n,Return()

exten => 30,1,Set(DB(TC/30/INUSESTATE)=INUSE)
exten => 30,n,Set(DB(TC/30/NOT_INUSESTATE)=NOT_INUSE)
exten => 30,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 30,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*?TRUE:FALSE)})
exten => 30,n,GotoIfTime(00:00-07:49,mon-fri,*,*?truestate)
exten => 30,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 30,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*?TRUE:FALSE)})
exten => 30,n,GotoIfTime(14:51-23:59,mon-fri,*,*?truestate)
exten => 30,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 30,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*?TRUE:FALSE)})
exten => 30,n,GotoIfTime(00:00-23:59,sat,*,*?truestate)
exten => 30,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 30,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*?TRUE:FALSE)})
exten => 30,n,GotoIfTime(00:00-23:59,sun,*,*?truestate)
exten => 30,n(falsestate),GotoIf($["${DB(TC/30):0:4}" = "true"]?truegoto)
exten => 30,n,ExecIf($["${DB(TC/30)}" = "false"]?Set(DB(TC/30)=))
exten => 30,n(falsegoto),Set(DEVICE_STATE(Custom:TC30)=INUSE)
exten => 30,n,ExecIf($["${DB(TC/30)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 30,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu100,1)
exten => 30,n,Set(TCSTATE=false)
exten => 30,n,Set(TCOVERRIDE=${IF($["${DB(TC/30):0:5}" = "false"]?true:false)})
exten => 30,n,Return()
exten => 30,n(truestate),GotoIf($["${DB(TC/30):0:5}" = "false"]?falsegoto)
exten => 30,n,ExecIf($["${DB(TC/30)}" = "true"]?Set(DB(TC/30)=))
exten => 30,n(truegoto),Set(DEVICE_STATE(Custom:TC30)=NOT_INUSE)
exten => 30,n,ExecIf($["${DB(TC/30)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 30,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,102,1)
exten => 30,n,Set(TCSTATE=true)
exten => 30,n,Set(TCOVERRIDE=${IF($["${DB(TC/30):0:4}" = "true"]?true:false)})
exten => 30,n,Return()

exten => 34,1,Set(DB(TC/34/INUSESTATE)=INUSE)
exten => 34,n,Set(DB(TC/34/NOT_INUSESTATE)=NOT_INUSE)
exten => 34,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 34,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*,America/Detroit?TRUE:FALSE)})
exten => 34,n,GotoIfTime(00:00-07:49,mon-fri,*,*,America/Detroit?truestate)
exten => 34,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 34,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*,America/Detroit?TRUE:FALSE)})
exten => 34,n,GotoIfTime(14:51-23:59,mon-fri,*,*,America/Detroit?truestate)
exten => 34,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 34,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*,America/Detroit?TRUE:FALSE)})
exten => 34,n,GotoIfTime(00:00-23:59,sat,*,*,America/Detroit?truestate)
exten => 34,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 34,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*,America/Detroit?TRUE:FALSE)})
exten => 34,n,GotoIfTime(00:00-23:59,sun,*,*,America/Detroit?truestate)
exten => 34,n(falsestate),GotoIf($["${DB(TC/34):0:4}" = "true"]?truegoto)
exten => 34,n,ExecIf($["${DB(TC/34)}" = "false"]?Set(DB(TC/34)=))
exten => 34,n(falsegoto),Set(DEVICE_STATE(Custom:TC34)=INUSE)
exten => 34,n,ExecIf($["${DB(TC/34)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 34,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu100,1)
exten => 34,n,Set(TCSTATE=false)
exten => 34,n,Set(TCOVERRIDE=${IF($["${DB(TC/34):0:5}" = "false"]?true:false)})
exten => 34,n,Return()
exten => 34,n(truestate),GotoIf($["${DB(TC/34):0:5}" = "false"]?falsegoto)
exten => 34,n,ExecIf($["${DB(TC/34)}" = "true"]?Set(DB(TC/34)=))
exten => 34,n(truegoto),Set(DEVICE_STATE(Custom:TC34)=NOT_INUSE)
exten => 34,n,ExecIf($["${DB(TC/34)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 34,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,104,1)
exten => 34,n,Set(TCSTATE=true)
exten => 34,n,Set(TCOVERRIDE=${IF($["${DB(TC/34):0:4}" = "true"]?true:false)})
exten => 34,n,Return()

exten => 28,1,Set(DB(TC/28/INUSESTATE)=INUSE)
exten => 28,n,Set(DB(TC/28/NOT_INUSESTATE)=NOT_INUSE)
exten => 28,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 28,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*?TRUE:FALSE)})
exten => 28,n,GotoIfTime(00:00-07:49,mon-fri,*,*?truestate)
exten => 28,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 28,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*?TRUE:FALSE)})
exten => 28,n,GotoIfTime(14:51-23:59,mon-fri,*,*?truestate)
exten => 28,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 28,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*?TRUE:FALSE)})
exten => 28,n,GotoIfTime(00:00-23:59,sat,*,*?truestate)
exten => 28,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 28,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*?TRUE:FALSE)})
exten => 28,n,GotoIfTime(00:00-23:59,sun,*,*?truestate)
exten => 28,n(falsestate),GotoIf($["${DB(TC/28):0:4}" = "true"]?truegoto)
exten => 28,n,ExecIf($["${DB(TC/28)}" = "false"]?Set(DB(TC/28)=))
exten => 28,n(falsegoto),Set(DEVICE_STATE(Custom:TC28)=INUSE)
exten => 28,n,ExecIf($["${DB(TC/28)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 28,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu383,1)
exten => 28,n,Set(TCSTATE=false)
exten => 28,n,Set(TCOVERRIDE=${IF($["${DB(TC/28):0:5}" = "false"]?true:false)})
exten => 28,n,Return()
exten => 28,n(truestate),GotoIf($["${DB(TC/28):0:5}" = "false"]?falsegoto)
exten => 28,n,ExecIf($["${DB(TC/28)}" = "true"]?Set(DB(TC/28)=))
exten => 28,n(truegoto),Set(DEVICE_STATE(Custom:TC28)=NOT_INUSE)
exten => 28,n,ExecIf($["${DB(TC/28)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 28,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,383,1)
exten => 28,n,Set(TCSTATE=true)
exten => 28,n,Set(TCOVERRIDE=${IF($["${DB(TC/28):0:4}" = "true"]?true:false)})
exten => 28,n,Return()

exten => 27,1,Set(DB(TC/27/INUSESTATE)=INUSE)
exten => 27,n,Set(DB(TC/27/NOT_INUSESTATE)=NOT_INUSE)
exten => 27,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 27,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*?TRUE:FALSE)})
exten => 27,n,GotoIfTime(00:00-07:49,mon-fri,*,*?truestate)
exten => 27,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 27,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*?TRUE:FALSE)})
exten => 27,n,GotoIfTime(14:51-23:59,mon-fri,*,*?truestate)
exten => 27,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 27,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*?TRUE:FALSE)})
exten => 27,n,GotoIfTime(00:00-23:59,sat,*,*?truestate)
exten => 27,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 27,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*?TRUE:FALSE)})
exten => 27,n,GotoIfTime(00:00-23:59,sun,*,*?truestate)
exten => 27,n(falsestate),GotoIf($["${DB(TC/27):0:4}" = "true"]?truegoto)
exten => 27,n,ExecIf($["${DB(TC/27)}" = "false"]?Set(DB(TC/27)=))
exten => 27,n(falsegoto),Set(DEVICE_STATE(Custom:TC27)=INUSE)
exten => 27,n,ExecIf($["${DB(TC/27)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 27,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu383,1)
exten => 27,n,Set(TCSTATE=false)
exten => 27,n,Set(TCOVERRIDE=${IF($["${DB(TC/27):0:5}" = "false"]?true:false)})
exten => 27,n,Return()
exten => 27,n(truestate),GotoIf($["${DB(TC/27):0:5}" = "false"]?falsegoto)
exten => 27,n,ExecIf($["${DB(TC/27)}" = "true"]?Set(DB(TC/27)=))
exten => 27,n(truegoto),Set(DEVICE_STATE(Custom:TC27)=NOT_INUSE)
exten => 27,n,ExecIf($["${DB(TC/27)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 27,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,382,1)
exten => 27,n,Set(TCSTATE=true)
exten => 27,n,Set(TCOVERRIDE=${IF($["${DB(TC/27):0:4}" = "true"]?true:false)})
exten => 27,n,Return()

exten => 26,1,Set(DB(TC/26/INUSESTATE)=INUSE)
exten => 26,n,Set(DB(TC/26/NOT_INUSESTATE)=NOT_INUSE)
exten => 26,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 26,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*?TRUE:FALSE)})
exten => 26,n,GotoIfTime(00:00-07:49,mon-fri,*,*?truestate)
exten => 26,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 26,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*?TRUE:FALSE)})
exten => 26,n,GotoIfTime(14:51-23:59,mon-fri,*,*?truestate)
exten => 26,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 26,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*?TRUE:FALSE)})
exten => 26,n,GotoIfTime(00:00-23:59,sat,*,*?truestate)
exten => 26,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 26,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*?TRUE:FALSE)})
exten => 26,n,GotoIfTime(00:00-23:59,sun,*,*?truestate)
exten => 26,n(falsestate),GotoIf($["${DB(TC/26):0:4}" = "true"]?truegoto)
exten => 26,n,ExecIf($["${DB(TC/26)}" = "false"]?Set(DB(TC/26)=))
exten => 26,n(falsegoto),Set(DEVICE_STATE(Custom:TC26)=INUSE)
exten => 26,n,ExecIf($["${DB(TC/26)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 26,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu383,1)
exten => 26,n,Set(TCSTATE=false)
exten => 26,n,Set(TCOVERRIDE=${IF($["${DB(TC/26):0:5}" = "false"]?true:false)})
exten => 26,n,Return()
exten => 26,n(truestate),GotoIf($["${DB(TC/26):0:5}" = "false"]?falsegoto)
exten => 26,n,ExecIf($["${DB(TC/26)}" = "true"]?Set(DB(TC/26)=))
exten => 26,n(truegoto),Set(DEVICE_STATE(Custom:TC26)=NOT_INUSE)
exten => 26,n,ExecIf($["${DB(TC/26)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 26,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,381,1)
exten => 26,n,Set(TCSTATE=true)
exten => 26,n,Set(TCOVERRIDE=${IF($["${DB(TC/26):0:4}" = "true"]?true:false)})
exten => 26,n,Return()

exten => 25,1,Set(DB(TC/25/INUSESTATE)=INUSE)
exten => 25,n,Set(DB(TC/25/NOT_INUSESTATE)=NOT_INUSE)
exten => 25,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 25,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*?TRUE:FALSE)})
exten => 25,n,GotoIfTime(00:00-07:49,mon-fri,*,*?truestate)
exten => 25,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 25,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*?TRUE:FALSE)})
exten => 25,n,GotoIfTime(14:51-23:59,mon-fri,*,*?truestate)
exten => 25,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 25,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*?TRUE:FALSE)})
exten => 25,n,GotoIfTime(00:00-23:59,sat,*,*?truestate)
exten => 25,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 25,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*?TRUE:FALSE)})
exten => 25,n,GotoIfTime(00:00-23:59,sun,*,*?truestate)
exten => 25,n(falsestate),GotoIf($["${DB(TC/25):0:4}" = "true"]?truegoto)
exten => 25,n,ExecIf($["${DB(TC/25)}" = "false"]?Set(DB(TC/25)=))
exten => 25,n(falsegoto),Set(DEVICE_STATE(Custom:TC25)=INUSE)
exten => 25,n,ExecIf($["${DB(TC/25)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 25,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu373,1)
exten => 25,n,Set(TCSTATE=false)
exten => 25,n,Set(TCOVERRIDE=${IF($["${DB(TC/25):0:5}" = "false"]?true:false)})
exten => 25,n,Return()
exten => 25,n(truestate),GotoIf($["${DB(TC/25):0:5}" = "false"]?falsegoto)
exten => 25,n,ExecIf($["${DB(TC/25)}" = "true"]?Set(DB(TC/25)=))
exten => 25,n(truegoto),Set(DEVICE_STATE(Custom:TC25)=NOT_INUSE)
exten => 25,n,ExecIf($["${DB(TC/25)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 25,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,373,1)
exten => 25,n,Set(TCSTATE=true)
exten => 25,n,Set(TCOVERRIDE=${IF($["${DB(TC/25):0:4}" = "true"]?true:false)})
exten => 25,n,Return()

exten => 24,1,Set(DB(TC/24/INUSESTATE)=INUSE)
exten => 24,n,Set(DB(TC/24/NOT_INUSESTATE)=NOT_INUSE)
exten => 24,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 24,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*?TRUE:FALSE)})
exten => 24,n,GotoIfTime(00:00-07:49,mon-fri,*,*?truestate)
exten => 24,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 24,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*?TRUE:FALSE)})
exten => 24,n,GotoIfTime(14:51-23:59,mon-fri,*,*?truestate)
exten => 24,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 24,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*?TRUE:FALSE)})
exten => 24,n,GotoIfTime(00:00-23:59,sat,*,*?truestate)
exten => 24,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 24,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*?TRUE:FALSE)})
exten => 24,n,GotoIfTime(00:00-23:59,sun,*,*?truestate)
exten => 24,n(falsestate),GotoIf($["${DB(TC/24):0:4}" = "true"]?truegoto)
exten => 24,n,ExecIf($["${DB(TC/24)}" = "false"]?Set(DB(TC/24)=))
exten => 24,n(falsegoto),Set(DEVICE_STATE(Custom:TC24)=INUSE)
exten => 24,n,ExecIf($["${DB(TC/24)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 24,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu372,1)
exten => 24,n,Set(TCSTATE=false)
exten => 24,n,Set(TCOVERRIDE=${IF($["${DB(TC/24):0:5}" = "false"]?true:false)})
exten => 24,n,Return()
exten => 24,n(truestate),GotoIf($["${DB(TC/24):0:5}" = "false"]?falsegoto)
exten => 24,n,ExecIf($["${DB(TC/24)}" = "true"]?Set(DB(TC/24)=))
exten => 24,n(truegoto),Set(DEVICE_STATE(Custom:TC24)=NOT_INUSE)
exten => 24,n,ExecIf($["${DB(TC/24)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 24,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,372,1)
exten => 24,n,Set(TCSTATE=true)
exten => 24,n,Set(TCOVERRIDE=${IF($["${DB(TC/24):0:4}" = "true"]?true:false)})
exten => 24,n,Return()

exten => 23,1,Set(DB(TC/23/INUSESTATE)=INUSE)
exten => 23,n,Set(DB(TC/23/NOT_INUSESTATE)=NOT_INUSE)
exten => 23,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 23,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*?TRUE:FALSE)})
exten => 23,n,GotoIfTime(00:00-07:49,mon-fri,*,*?truestate)
exten => 23,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 23,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*?TRUE:FALSE)})
exten => 23,n,GotoIfTime(14:51-23:59,mon-fri,*,*?truestate)
exten => 23,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 23,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*?TRUE:FALSE)})
exten => 23,n,GotoIfTime(00:00-23:59,sat,*,*?truestate)
exten => 23,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 23,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*?TRUE:FALSE)})
exten => 23,n,GotoIfTime(00:00-23:59,sun,*,*?truestate)
exten => 23,n(falsestate),GotoIf($["${DB(TC/23):0:4}" = "true"]?truegoto)
exten => 23,n,ExecIf($["${DB(TC/23)}" = "false"]?Set(DB(TC/23)=))
exten => 23,n(falsegoto),Set(DEVICE_STATE(Custom:TC23)=INUSE)
exten => 23,n,ExecIf($["${DB(TC/23)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 23,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu370,1)
exten => 23,n,Set(TCSTATE=false)
exten => 23,n,Set(TCOVERRIDE=${IF($["${DB(TC/23):0:5}" = "false"]?true:false)})
exten => 23,n,Return()
exten => 23,n(truestate),GotoIf($["${DB(TC/23):0:5}" = "false"]?falsegoto)
exten => 23,n,ExecIf($["${DB(TC/23)}" = "true"]?Set(DB(TC/23)=))
exten => 23,n(truegoto),Set(DEVICE_STATE(Custom:TC23)=NOT_INUSE)
exten => 23,n,ExecIf($["${DB(TC/23)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 23,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,370,1)
exten => 23,n,Set(TCSTATE=true)
exten => 23,n,Set(TCOVERRIDE=${IF($["${DB(TC/23):0:4}" = "true"]?true:false)})
exten => 23,n,Return()

exten => 31,1,Set(DB(TC/31/INUSESTATE)=INUSE)
exten => 31,n,Set(DB(TC/31/NOT_INUSESTATE)=NOT_INUSE)
exten => 31,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 31,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,*,*,*,America/Detroit?TRUE:FALSE)})
exten => 31,n,GotoIfTime(00:00-23:59,*,*,*,America/Detroit?truestate)
exten => 31,n(falsestate),GotoIf($["${DB(TC/31):0:4}" = "true"]?truegoto)
exten => 31,n,ExecIf($["${DB(TC/31)}" = "false"]?Set(DB(TC/31)=))
exten => 31,n(falsegoto),Set(DEVICE_STATE(Custom:TC31)=INUSE)
exten => 31,n,ExecIf($["${DB(TC/31)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 31,n,GotoIf($["${TCRETURN}"!="RETURN"]?app-announcement-2,s,1)
exten => 31,n,Set(TCSTATE=false)
exten => 31,n,Set(TCOVERRIDE=${IF($["${DB(TC/31):0:5}" = "false"]?true:false)})
exten => 31,n,Return()
exten => 31,n(truestate),GotoIf($["${DB(TC/31):0:5}" = "false"]?falsegoto)
exten => 31,n,ExecIf($["${DB(TC/31)}" = "true"]?Set(DB(TC/31)=))
exten => 31,n(truegoto),Set(DEVICE_STATE(Custom:TC31)=NOT_INUSE)
exten => 31,n,ExecIf($["${DB(TC/31)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 31,n,GotoIf($["${TCRETURN}"!="RETURN"]?timeconditions,1,1)
exten => 31,n,Set(TCSTATE=true)
exten => 31,n,Set(TCOVERRIDE=${IF($["${DB(TC/31):0:4}" = "true"]?true:false)})
exten => 31,n,Return()

exten => 32,1,Set(DB(TC/32/INUSESTATE)=INUSE)
exten => 32,n,Set(DB(TC/32/NOT_INUSESTATE)=NOT_INUSE)
exten => 32,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 32,n,Noop(TIMEMATCHED: ${IFTIME(14:50-15:30,mon-fri,*,*,America/Detroit?TRUE:FALSE)})
exten => 32,n,GotoIfTime(14:50-15:30,mon-fri,*,*,America/Detroit?truestate)
exten => 32,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 32,n,Noop(TIMEMATCHED: ${IFTIME(07:30-07:50,mon-fri,*,*,America/Detroit?TRUE:FALSE)})
exten => 32,n,GotoIfTime(07:30-07:50,mon-fri,*,*,America/Detroit?truestate)
exten => 32,n(falsestate),GotoIf($["${DB(TC/32):0:4}" = "true"]?truegoto)
exten => 32,n,ExecIf($["${DB(TC/32)}" = "false"]?Set(DB(TC/32)=))
exten => 32,n(falsegoto),Set(DEVICE_STATE(Custom:TC32)=INUSE)
exten => 32,n,ExecIf($["${DB(TC/32)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 32,n,GotoIf($["${TCRETURN}"!="RETURN"]?ivr-4,s,1)
exten => 32,n,Set(TCSTATE=false)
exten => 32,n,Set(TCOVERRIDE=${IF($["${DB(TC/32):0:5}" = "false"]?true:false)})
exten => 32,n,Return()
exten => 32,n(truestate),GotoIf($["${DB(TC/32):0:5}" = "false"]?falsegoto)
exten => 32,n,ExecIf($["${DB(TC/32)}" = "true"]?Set(DB(TC/32)=))
exten => 32,n(truegoto),Set(DEVICE_STATE(Custom:TC32)=NOT_INUSE)
exten => 32,n,ExecIf($["${DB(TC/32)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 32,n,GotoIf($["${TCRETURN}"!="RETURN"]?ivr-3,s,1)
exten => 32,n,Set(TCSTATE=true)
exten => 32,n,Set(TCOVERRIDE=${IF($["${DB(TC/32):0:4}" = "true"]?true:false)})
exten => 32,n,Return()

exten => 33,1,Set(DB(TC/33/INUSESTATE)=INUSE)
exten => 33,n,Set(DB(TC/33/NOT_INUSESTATE)=NOT_INUSE)
exten => 33,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 33,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:29,mon-fri,*,*,America/Detroit?TRUE:FALSE)})
exten => 33,n,GotoIfTime(00:00-07:29,mon-fri,*,*,America/Detroit?truestate)
exten => 33,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 33,n,Noop(TIMEMATCHED: ${IFTIME(07:51-14:49,mon-fri,*,*,America/Detroit?TRUE:FALSE)})
exten => 33,n,GotoIfTime(07:51-14:49,mon-fri,*,*,America/Detroit?truestate)
exten => 33,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 33,n,Noop(TIMEMATCHED: ${IFTIME(15:31-23:59,mon-fri,*,*,America/Detroit?TRUE:FALSE)})
exten => 33,n,GotoIfTime(15:31-23:59,mon-fri,*,*,America/Detroit?truestate)
exten => 33,n(falsestate),GotoIf($["${DB(TC/33):0:4}" = "true"]?truegoto)
exten => 33,n,ExecIf($["${DB(TC/33)}" = "false"]?Set(DB(TC/33)=))
exten => 33,n(falsegoto),Set(DEVICE_STATE(Custom:TC33)=INUSE)
exten => 33,n,ExecIf($["${DB(TC/33)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 33,n,GotoIf($["${TCRETURN}"!="RETURN"]?timeconditions,32,1)
exten => 33,n,Set(TCSTATE=false)
exten => 33,n,Set(TCOVERRIDE=${IF($["${DB(TC/33):0:5}" = "false"]?true:false)})
exten => 33,n,Return()
exten => 33,n(truestate),GotoIf($["${DB(TC/33):0:5}" = "false"]?falsegoto)
exten => 33,n,ExecIf($["${DB(TC/33)}" = "true"]?Set(DB(TC/33)=))
exten => 33,n(truegoto),Set(DEVICE_STATE(Custom:TC33)=NOT_INUSE)
exten => 33,n,ExecIf($["${DB(TC/33)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 33,n,GotoIf($["${TCRETURN}"!="RETURN"]?ivr-8,s,1)
exten => 33,n,Set(TCSTATE=true)
exten => 33,n,Set(TCOVERRIDE=${IF($["${DB(TC/33):0:4}" = "true"]?true:false)})
exten => 33,n,Return()

exten => 42,1,Set(DB(TC/42/INUSESTATE)=INUSE)
exten => 42,n,Set(DB(TC/42/NOT_INUSESTATE)=NOT_INUSE)
exten => 42,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 42,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*,America/Detroit?TRUE:FALSE)})
exten => 42,n,GotoIfTime(00:00-07:49,mon-fri,*,*,America/Detroit?truestate)
exten => 42,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 42,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*,America/Detroit?TRUE:FALSE)})
exten => 42,n,GotoIfTime(14:51-23:59,mon-fri,*,*,America/Detroit?truestate)
exten => 42,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 42,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*,America/Detroit?TRUE:FALSE)})
exten => 42,n,GotoIfTime(00:00-23:59,sat,*,*,America/Detroit?truestate)
exten => 42,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 42,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*,America/Detroit?TRUE:FALSE)})
exten => 42,n,GotoIfTime(00:00-23:59,sun,*,*,America/Detroit?truestate)
exten => 42,n(falsestate),GotoIf($["${DB(TC/42):0:4}" = "true"]?truegoto)
exten => 42,n,ExecIf($["${DB(TC/42)}" = "false"]?Set(DB(TC/42)=))
exten => 42,n(falsegoto),Set(DEVICE_STATE(Custom:TC42)=INUSE)
exten => 42,n,ExecIf($["${DB(TC/42)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 42,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu100,1)
exten => 42,n,Set(TCSTATE=false)
exten => 42,n,Set(TCOVERRIDE=${IF($["${DB(TC/42):0:5}" = "false"]?true:false)})
exten => 42,n,Return()
exten => 42,n(truestate),GotoIf($["${DB(TC/42):0:5}" = "false"]?falsegoto)
exten => 42,n,ExecIf($["${DB(TC/42)}" = "true"]?Set(DB(TC/42)=))
exten => 42,n(truegoto),Set(DEVICE_STATE(Custom:TC42)=NOT_INUSE)
exten => 42,n,ExecIf($["${DB(TC/42)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 42,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,143,1)
exten => 42,n,Set(TCSTATE=true)
exten => 42,n,Set(TCOVERRIDE=${IF($["${DB(TC/42):0:4}" = "true"]?true:false)})
exten => 42,n,Return()

exten => 41,1,Set(DB(TC/41/INUSESTATE)=INUSE)
exten => 41,n,Set(DB(TC/41/NOT_INUSESTATE)=NOT_INUSE)
exten => 41,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 41,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*,America/Detroit?TRUE:FALSE)})
exten => 41,n,GotoIfTime(00:00-07:49,mon-fri,*,*,America/Detroit?truestate)
exten => 41,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 41,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*,America/Detroit?TRUE:FALSE)})
exten => 41,n,GotoIfTime(14:51-23:59,mon-fri,*,*,America/Detroit?truestate)
exten => 41,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 41,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*,America/Detroit?TRUE:FALSE)})
exten => 41,n,GotoIfTime(00:00-23:59,sat,*,*,America/Detroit?truestate)
exten => 41,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 41,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*,America/Detroit?TRUE:FALSE)})
exten => 41,n,GotoIfTime(00:00-23:59,sun,*,*,America/Detroit?truestate)
exten => 41,n(falsestate),GotoIf($["${DB(TC/41):0:4}" = "true"]?truegoto)
exten => 41,n,ExecIf($["${DB(TC/41)}" = "false"]?Set(DB(TC/41)=))
exten => 41,n(falsegoto),Set(DEVICE_STATE(Custom:TC41)=INUSE)
exten => 41,n,ExecIf($["${DB(TC/41)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 41,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu142,1)
exten => 41,n,Set(TCSTATE=false)
exten => 41,n,Set(TCOVERRIDE=${IF($["${DB(TC/41):0:5}" = "false"]?true:false)})
exten => 41,n,Return()
exten => 41,n(truestate),GotoIf($["${DB(TC/41):0:5}" = "false"]?falsegoto)
exten => 41,n,ExecIf($["${DB(TC/41)}" = "true"]?Set(DB(TC/41)=))
exten => 41,n(truegoto),Set(DEVICE_STATE(Custom:TC41)=NOT_INUSE)
exten => 41,n,ExecIf($["${DB(TC/41)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 41,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,142,1)
exten => 41,n,Set(TCSTATE=true)
exten => 41,n,Set(TCOVERRIDE=${IF($["${DB(TC/41):0:4}" = "true"]?true:false)})
exten => 41,n,Return()

exten => 40,1,Set(DB(TC/40/INUSESTATE)=INUSE)
exten => 40,n,Set(DB(TC/40/NOT_INUSESTATE)=NOT_INUSE)
exten => 40,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 40,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*,America/Detroit?TRUE:FALSE)})
exten => 40,n,GotoIfTime(00:00-07:49,mon-fri,*,*,America/Detroit?truestate)
exten => 40,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 40,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*,America/Detroit?TRUE:FALSE)})
exten => 40,n,GotoIfTime(14:51-23:59,mon-fri,*,*,America/Detroit?truestate)
exten => 40,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 40,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*,America/Detroit?TRUE:FALSE)})
exten => 40,n,GotoIfTime(00:00-23:59,sat,*,*,America/Detroit?truestate)
exten => 40,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 40,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*,America/Detroit?TRUE:FALSE)})
exten => 40,n,GotoIfTime(00:00-23:59,sun,*,*,America/Detroit?truestate)
exten => 40,n(falsestate),GotoIf($["${DB(TC/40):0:4}" = "true"]?truegoto)
exten => 40,n,ExecIf($["${DB(TC/40)}" = "false"]?Set(DB(TC/40)=))
exten => 40,n(falsegoto),Set(DEVICE_STATE(Custom:TC40)=INUSE)
exten => 40,n,ExecIf($["${DB(TC/40)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 40,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu139,1)
exten => 40,n,Set(TCSTATE=false)
exten => 40,n,Set(TCOVERRIDE=${IF($["${DB(TC/40):0:5}" = "false"]?true:false)})
exten => 40,n,Return()
exten => 40,n(truestate),GotoIf($["${DB(TC/40):0:5}" = "false"]?falsegoto)
exten => 40,n,ExecIf($["${DB(TC/40)}" = "true"]?Set(DB(TC/40)=))
exten => 40,n(truegoto),Set(DEVICE_STATE(Custom:TC40)=NOT_INUSE)
exten => 40,n,ExecIf($["${DB(TC/40)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 40,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,139,1)
exten => 40,n,Set(TCSTATE=true)
exten => 40,n,Set(TCOVERRIDE=${IF($["${DB(TC/40):0:4}" = "true"]?true:false)})
exten => 40,n,Return()

exten => 39,1,Set(DB(TC/39/INUSESTATE)=INUSE)
exten => 39,n,Set(DB(TC/39/NOT_INUSESTATE)=NOT_INUSE)
exten => 39,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 39,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*,America/Detroit?TRUE:FALSE)})
exten => 39,n,GotoIfTime(00:00-07:49,mon-fri,*,*,America/Detroit?truestate)
exten => 39,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 39,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*,America/Detroit?TRUE:FALSE)})
exten => 39,n,GotoIfTime(14:51-23:59,mon-fri,*,*,America/Detroit?truestate)
exten => 39,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 39,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*,America/Detroit?TRUE:FALSE)})
exten => 39,n,GotoIfTime(00:00-23:59,sat,*,*,America/Detroit?truestate)
exten => 39,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 39,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*,America/Detroit?TRUE:FALSE)})
exten => 39,n,GotoIfTime(00:00-23:59,sun,*,*,America/Detroit?truestate)
exten => 39,n(falsestate),GotoIf($["${DB(TC/39):0:4}" = "true"]?truegoto)
exten => 39,n,ExecIf($["${DB(TC/39)}" = "false"]?Set(DB(TC/39)=))
exten => 39,n(falsegoto),Set(DEVICE_STATE(Custom:TC39)=INUSE)
exten => 39,n,ExecIf($["${DB(TC/39)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 39,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu134,1)
exten => 39,n,Set(TCSTATE=false)
exten => 39,n,Set(TCOVERRIDE=${IF($["${DB(TC/39):0:5}" = "false"]?true:false)})
exten => 39,n,Return()
exten => 39,n(truestate),GotoIf($["${DB(TC/39):0:5}" = "false"]?falsegoto)
exten => 39,n,ExecIf($["${DB(TC/39)}" = "true"]?Set(DB(TC/39)=))
exten => 39,n(truegoto),Set(DEVICE_STATE(Custom:TC39)=NOT_INUSE)
exten => 39,n,ExecIf($["${DB(TC/39)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 39,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,134,1)
exten => 39,n,Set(TCSTATE=true)
exten => 39,n,Set(TCOVERRIDE=${IF($["${DB(TC/39):0:4}" = "true"]?true:false)})
exten => 39,n,Return()

exten => 38,1,Set(DB(TC/38/INUSESTATE)=INUSE)
exten => 38,n,Set(DB(TC/38/NOT_INUSESTATE)=NOT_INUSE)
exten => 38,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 38,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*,America/Detroit?TRUE:FALSE)})
exten => 38,n,GotoIfTime(00:00-07:49,mon-fri,*,*,America/Detroit?truestate)
exten => 38,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 38,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*,America/Detroit?TRUE:FALSE)})
exten => 38,n,GotoIfTime(14:51-23:59,mon-fri,*,*,America/Detroit?truestate)
exten => 38,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 38,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*,America/Detroit?TRUE:FALSE)})
exten => 38,n,GotoIfTime(00:00-23:59,sat,*,*,America/Detroit?truestate)
exten => 38,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 38,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*,America/Detroit?TRUE:FALSE)})
exten => 38,n,GotoIfTime(00:00-23:59,sun,*,*,America/Detroit?truestate)
exten => 38,n(falsestate),GotoIf($["${DB(TC/38):0:4}" = "true"]?truegoto)
exten => 38,n,ExecIf($["${DB(TC/38)}" = "false"]?Set(DB(TC/38)=))
exten => 38,n(falsegoto),Set(DEVICE_STATE(Custom:TC38)=INUSE)
exten => 38,n,ExecIf($["${DB(TC/38)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 38,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu132,1)
exten => 38,n,Set(TCSTATE=false)
exten => 38,n,Set(TCOVERRIDE=${IF($["${DB(TC/38):0:5}" = "false"]?true:false)})
exten => 38,n,Return()
exten => 38,n(truestate),GotoIf($["${DB(TC/38):0:5}" = "false"]?falsegoto)
exten => 38,n,ExecIf($["${DB(TC/38)}" = "true"]?Set(DB(TC/38)=))
exten => 38,n(truegoto),Set(DEVICE_STATE(Custom:TC38)=NOT_INUSE)
exten => 38,n,ExecIf($["${DB(TC/38)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 38,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,132,1)
exten => 38,n,Set(TCSTATE=true)
exten => 38,n,Set(TCOVERRIDE=${IF($["${DB(TC/38):0:4}" = "true"]?true:false)})
exten => 38,n,Return()

exten => 37,1,Set(DB(TC/37/INUSESTATE)=INUSE)
exten => 37,n,Set(DB(TC/37/NOT_INUSESTATE)=NOT_INUSE)
exten => 37,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 37,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*,America/Detroit?TRUE:FALSE)})
exten => 37,n,GotoIfTime(00:00-07:49,mon-fri,*,*,America/Detroit?truestate)
exten => 37,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 37,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*,America/Detroit?TRUE:FALSE)})
exten => 37,n,GotoIfTime(14:51-23:59,mon-fri,*,*,America/Detroit?truestate)
exten => 37,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 37,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*,America/Detroit?TRUE:FALSE)})
exten => 37,n,GotoIfTime(00:00-23:59,sat,*,*,America/Detroit?truestate)
exten => 37,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 37,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*,America/Detroit?TRUE:FALSE)})
exten => 37,n,GotoIfTime(00:00-23:59,sun,*,*,America/Detroit?truestate)
exten => 37,n(falsestate),GotoIf($["${DB(TC/37):0:4}" = "true"]?truegoto)
exten => 37,n,ExecIf($["${DB(TC/37)}" = "false"]?Set(DB(TC/37)=))
exten => 37,n(falsegoto),Set(DEVICE_STATE(Custom:TC37)=INUSE)
exten => 37,n,ExecIf($["${DB(TC/37)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 37,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu100,1)
exten => 37,n,Set(TCSTATE=false)
exten => 37,n,Set(TCOVERRIDE=${IF($["${DB(TC/37):0:5}" = "false"]?true:false)})
exten => 37,n,Return()
exten => 37,n(truestate),GotoIf($["${DB(TC/37):0:5}" = "false"]?falsegoto)
exten => 37,n,ExecIf($["${DB(TC/37)}" = "true"]?Set(DB(TC/37)=))
exten => 37,n(truegoto),Set(DEVICE_STATE(Custom:TC37)=NOT_INUSE)
exten => 37,n,ExecIf($["${DB(TC/37)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 37,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,128,1)
exten => 37,n,Set(TCSTATE=true)
exten => 37,n,Set(TCOVERRIDE=${IF($["${DB(TC/37):0:4}" = "true"]?true:false)})
exten => 37,n,Return()

exten => 36,1,Set(DB(TC/36/INUSESTATE)=INUSE)
exten => 36,n,Set(DB(TC/36/NOT_INUSESTATE)=NOT_INUSE)
exten => 36,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 36,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*,America/Detroit?TRUE:FALSE)})
exten => 36,n,GotoIfTime(00:00-07:49,mon-fri,*,*,America/Detroit?truestate)
exten => 36,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 36,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*,America/Detroit?TRUE:FALSE)})
exten => 36,n,GotoIfTime(14:51-23:59,mon-fri,*,*,America/Detroit?truestate)
exten => 36,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 36,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*,America/Detroit?TRUE:FALSE)})
exten => 36,n,GotoIfTime(00:00-23:59,sat,*,*,America/Detroit?truestate)
exten => 36,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 36,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*,America/Detroit?TRUE:FALSE)})
exten => 36,n,GotoIfTime(00:00-23:59,sun,*,*,America/Detroit?truestate)
exten => 36,n(falsestate),GotoIf($["${DB(TC/36):0:4}" = "true"]?truegoto)
exten => 36,n,ExecIf($["${DB(TC/36)}" = "false"]?Set(DB(TC/36)=))
exten => 36,n(falsegoto),Set(DEVICE_STATE(Custom:TC36)=INUSE)
exten => 36,n,ExecIf($["${DB(TC/36)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 36,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu107,1)
exten => 36,n,Set(TCSTATE=false)
exten => 36,n,Set(TCOVERRIDE=${IF($["${DB(TC/36):0:5}" = "false"]?true:false)})
exten => 36,n,Return()
exten => 36,n(truestate),GotoIf($["${DB(TC/36):0:5}" = "false"]?falsegoto)
exten => 36,n,ExecIf($["${DB(TC/36)}" = "true"]?Set(DB(TC/36)=))
exten => 36,n(truegoto),Set(DEVICE_STATE(Custom:TC36)=NOT_INUSE)
exten => 36,n,ExecIf($["${DB(TC/36)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 36,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,107,1)
exten => 36,n,Set(TCSTATE=true)
exten => 36,n,Set(TCOVERRIDE=${IF($["${DB(TC/36):0:4}" = "true"]?true:false)})
exten => 36,n,Return()

exten => 35,1,Set(DB(TC/35/INUSESTATE)=INUSE)
exten => 35,n,Set(DB(TC/35/NOT_INUSESTATE)=NOT_INUSE)
exten => 35,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 35,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*,America/Detroit?TRUE:FALSE)})
exten => 35,n,GotoIfTime(00:00-07:49,mon-fri,*,*,America/Detroit?truestate)
exten => 35,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 35,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*,America/Detroit?TRUE:FALSE)})
exten => 35,n,GotoIfTime(14:51-23:59,mon-fri,*,*,America/Detroit?truestate)
exten => 35,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 35,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*,America/Detroit?TRUE:FALSE)})
exten => 35,n,GotoIfTime(00:00-23:59,sat,*,*,America/Detroit?truestate)
exten => 35,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 35,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*,America/Detroit?TRUE:FALSE)})
exten => 35,n,GotoIfTime(00:00-23:59,sun,*,*,America/Detroit?truestate)
exten => 35,n(falsestate),GotoIf($["${DB(TC/35):0:4}" = "true"]?truegoto)
exten => 35,n,ExecIf($["${DB(TC/35)}" = "false"]?Set(DB(TC/35)=))
exten => 35,n(falsegoto),Set(DEVICE_STATE(Custom:TC35)=INUSE)
exten => 35,n,ExecIf($["${DB(TC/35)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 35,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu106,1)
exten => 35,n,Set(TCSTATE=false)
exten => 35,n,Set(TCOVERRIDE=${IF($["${DB(TC/35):0:5}" = "false"]?true:false)})
exten => 35,n,Return()
exten => 35,n(truestate),GotoIf($["${DB(TC/35):0:5}" = "false"]?falsegoto)
exten => 35,n,ExecIf($["${DB(TC/35)}" = "true"]?Set(DB(TC/35)=))
exten => 35,n(truegoto),Set(DEVICE_STATE(Custom:TC35)=NOT_INUSE)
exten => 35,n,ExecIf($["${DB(TC/35)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 35,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,106,1)
exten => 35,n,Set(TCSTATE=true)
exten => 35,n,Set(TCOVERRIDE=${IF($["${DB(TC/35):0:4}" = "true"]?true:false)})
exten => 35,n,Return()

exten => 22,1,Set(DB(TC/22/INUSESTATE)=INUSE)
exten => 22,n,Set(DB(TC/22/NOT_INUSESTATE)=NOT_INUSE)
exten => 22,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 22,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*?TRUE:FALSE)})
exten => 22,n,GotoIfTime(00:00-07:49,mon-fri,*,*?truestate)
exten => 22,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 22,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*?TRUE:FALSE)})
exten => 22,n,GotoIfTime(14:51-23:59,mon-fri,*,*?truestate)
exten => 22,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 22,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*?TRUE:FALSE)})
exten => 22,n,GotoIfTime(00:00-23:59,sat,*,*?truestate)
exten => 22,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 22,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*?TRUE:FALSE)})
exten => 22,n,GotoIfTime(00:00-23:59,sun,*,*?truestate)
exten => 22,n(falsestate),GotoIf($["${DB(TC/22):0:4}" = "true"]?truegoto)
exten => 22,n,ExecIf($["${DB(TC/22)}" = "false"]?Set(DB(TC/22)=))
exten => 22,n(falsegoto),Set(DEVICE_STATE(Custom:TC22)=INUSE)
exten => 22,n,ExecIf($["${DB(TC/22)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 22,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu369,1)
exten => 22,n,Set(TCSTATE=false)
exten => 22,n,Set(TCOVERRIDE=${IF($["${DB(TC/22):0:5}" = "false"]?true:false)})
exten => 22,n,Return()
exten => 22,n(truestate),GotoIf($["${DB(TC/22):0:5}" = "false"]?falsegoto)
exten => 22,n,ExecIf($["${DB(TC/22)}" = "true"]?Set(DB(TC/22)=))
exten => 22,n(truegoto),Set(DEVICE_STATE(Custom:TC22)=NOT_INUSE)
exten => 22,n,ExecIf($["${DB(TC/22)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 22,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,369,1)
exten => 22,n,Set(TCSTATE=true)
exten => 22,n,Set(TCOVERRIDE=${IF($["${DB(TC/22):0:4}" = "true"]?true:false)})
exten => 22,n,Return()

exten => 21,1,Set(DB(TC/21/INUSESTATE)=INUSE)
exten => 21,n,Set(DB(TC/21/NOT_INUSESTATE)=NOT_INUSE)
exten => 21,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 21,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*?TRUE:FALSE)})
exten => 21,n,GotoIfTime(00:00-07:49,mon-fri,*,*?truestate)
exten => 21,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 21,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*?TRUE:FALSE)})
exten => 21,n,GotoIfTime(14:51-23:59,mon-fri,*,*?truestate)
exten => 21,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 21,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*?TRUE:FALSE)})
exten => 21,n,GotoIfTime(00:00-23:59,sat,*,*?truestate)
exten => 21,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 21,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*?TRUE:FALSE)})
exten => 21,n,GotoIfTime(00:00-23:59,sun,*,*?truestate)
exten => 21,n(falsestate),GotoIf($["${DB(TC/21):0:4}" = "true"]?truegoto)
exten => 21,n,ExecIf($["${DB(TC/21)}" = "false"]?Set(DB(TC/21)=))
exten => 21,n(falsegoto),Set(DEVICE_STATE(Custom:TC21)=INUSE)
exten => 21,n,ExecIf($["${DB(TC/21)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 21,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu368,1)
exten => 21,n,Set(TCSTATE=false)
exten => 21,n,Set(TCOVERRIDE=${IF($["${DB(TC/21):0:5}" = "false"]?true:false)})
exten => 21,n,Return()
exten => 21,n(truestate),GotoIf($["${DB(TC/21):0:5}" = "false"]?falsegoto)
exten => 21,n,ExecIf($["${DB(TC/21)}" = "true"]?Set(DB(TC/21)=))
exten => 21,n(truegoto),Set(DEVICE_STATE(Custom:TC21)=NOT_INUSE)
exten => 21,n,ExecIf($["${DB(TC/21)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 21,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,368,1)
exten => 21,n,Set(TCSTATE=true)
exten => 21,n,Set(TCOVERRIDE=${IF($["${DB(TC/21):0:4}" = "true"]?true:false)})
exten => 21,n,Return()

exten => 9,1,Set(DB(TC/9/INUSESTATE)=INUSE)
exten => 9,n,Set(DB(TC/9/NOT_INUSESTATE)=NOT_INUSE)
exten => 9,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 9,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*?TRUE:FALSE)})
exten => 9,n,GotoIfTime(00:00-07:49,mon-fri,*,*?truestate)
exten => 9,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 9,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*?TRUE:FALSE)})
exten => 9,n,GotoIfTime(14:51-23:59,mon-fri,*,*?truestate)
exten => 9,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 9,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*?TRUE:FALSE)})
exten => 9,n,GotoIfTime(00:00-23:59,sat,*,*?truestate)
exten => 9,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 9,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*?TRUE:FALSE)})
exten => 9,n,GotoIfTime(00:00-23:59,sun,*,*?truestate)
exten => 9,n(falsestate),GotoIf($["${DB(TC/9):0:4}" = "true"]?truegoto)
exten => 9,n,ExecIf($["${DB(TC/9)}" = "false"]?Set(DB(TC/9)=))
exten => 9,n(falsegoto),Set(DEVICE_STATE(Custom:TC9)=INUSE)
exten => 9,n,ExecIf($["${DB(TC/9)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 9,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu356,1)
exten => 9,n,Set(TCSTATE=false)
exten => 9,n,Set(TCOVERRIDE=${IF($["${DB(TC/9):0:5}" = "false"]?true:false)})
exten => 9,n,Return()
exten => 9,n(truestate),GotoIf($["${DB(TC/9):0:5}" = "false"]?falsegoto)
exten => 9,n,ExecIf($["${DB(TC/9)}" = "true"]?Set(DB(TC/9)=))
exten => 9,n(truegoto),Set(DEVICE_STATE(Custom:TC9)=NOT_INUSE)
exten => 9,n,ExecIf($["${DB(TC/9)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 9,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,356,1)
exten => 9,n,Set(TCSTATE=true)
exten => 9,n,Set(TCOVERRIDE=${IF($["${DB(TC/9):0:4}" = "true"]?true:false)})
exten => 9,n,Return()

exten => 8,1,Set(DB(TC/8/INUSESTATE)=INUSE)
exten => 8,n,Set(DB(TC/8/NOT_INUSESTATE)=NOT_INUSE)
exten => 8,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 8,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*?TRUE:FALSE)})
exten => 8,n,GotoIfTime(00:00-07:49,mon-fri,*,*?truestate)
exten => 8,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 8,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*?TRUE:FALSE)})
exten => 8,n,GotoIfTime(14:51-23:59,mon-fri,*,*?truestate)
exten => 8,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 8,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*?TRUE:FALSE)})
exten => 8,n,GotoIfTime(00:00-23:59,sat,*,*?truestate)
exten => 8,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 8,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*?TRUE:FALSE)})
exten => 8,n,GotoIfTime(00:00-23:59,sun,*,*?truestate)
exten => 8,n(falsestate),GotoIf($["${DB(TC/8):0:4}" = "true"]?truegoto)
exten => 8,n,ExecIf($["${DB(TC/8)}" = "false"]?Set(DB(TC/8)=))
exten => 8,n(falsegoto),Set(DEVICE_STATE(Custom:TC8)=INUSE)
exten => 8,n,ExecIf($["${DB(TC/8)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 8,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu355,1)
exten => 8,n,Set(TCSTATE=false)
exten => 8,n,Set(TCOVERRIDE=${IF($["${DB(TC/8):0:5}" = "false"]?true:false)})
exten => 8,n,Return()
exten => 8,n(truestate),GotoIf($["${DB(TC/8):0:5}" = "false"]?falsegoto)
exten => 8,n,ExecIf($["${DB(TC/8)}" = "true"]?Set(DB(TC/8)=))
exten => 8,n(truegoto),Set(DEVICE_STATE(Custom:TC8)=NOT_INUSE)
exten => 8,n,ExecIf($["${DB(TC/8)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 8,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,355,1)
exten => 8,n,Set(TCSTATE=true)
exten => 8,n,Set(TCOVERRIDE=${IF($["${DB(TC/8):0:4}" = "true"]?true:false)})
exten => 8,n,Return()

exten => 7,1,Set(DB(TC/7/INUSESTATE)=INUSE)
exten => 7,n,Set(DB(TC/7/NOT_INUSESTATE)=NOT_INUSE)
exten => 7,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 7,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*?TRUE:FALSE)})
exten => 7,n,GotoIfTime(00:00-07:49,mon-fri,*,*?truestate)
exten => 7,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 7,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*?TRUE:FALSE)})
exten => 7,n,GotoIfTime(14:51-23:59,mon-fri,*,*?truestate)
exten => 7,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 7,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*?TRUE:FALSE)})
exten => 7,n,GotoIfTime(00:00-23:59,sat,*,*?truestate)
exten => 7,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 7,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*?TRUE:FALSE)})
exten => 7,n,GotoIfTime(00:00-23:59,sun,*,*?truestate)
exten => 7,n(falsestate),GotoIf($["${DB(TC/7):0:4}" = "true"]?truegoto)
exten => 7,n,ExecIf($["${DB(TC/7)}" = "false"]?Set(DB(TC/7)=))
exten => 7,n(falsegoto),Set(DEVICE_STATE(Custom:TC7)=INUSE)
exten => 7,n,ExecIf($["${DB(TC/7)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 7,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu354,1)
exten => 7,n,Set(TCSTATE=false)
exten => 7,n,Set(TCOVERRIDE=${IF($["${DB(TC/7):0:5}" = "false"]?true:false)})
exten => 7,n,Return()
exten => 7,n(truestate),GotoIf($["${DB(TC/7):0:5}" = "false"]?falsegoto)
exten => 7,n,ExecIf($["${DB(TC/7)}" = "true"]?Set(DB(TC/7)=))
exten => 7,n(truegoto),Set(DEVICE_STATE(Custom:TC7)=NOT_INUSE)
exten => 7,n,ExecIf($["${DB(TC/7)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 7,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,354,1)
exten => 7,n,Set(TCSTATE=true)
exten => 7,n,Set(TCOVERRIDE=${IF($["${DB(TC/7):0:4}" = "true"]?true:false)})
exten => 7,n,Return()

exten => 6,1,Set(DB(TC/6/INUSESTATE)=INUSE)
exten => 6,n,Set(DB(TC/6/NOT_INUSESTATE)=NOT_INUSE)
exten => 6,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 6,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*?TRUE:FALSE)})
exten => 6,n,GotoIfTime(00:00-07:49,mon-fri,*,*?truestate)
exten => 6,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 6,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*?TRUE:FALSE)})
exten => 6,n,GotoIfTime(14:51-23:59,mon-fri,*,*?truestate)
exten => 6,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 6,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*?TRUE:FALSE)})
exten => 6,n,GotoIfTime(00:00-23:59,sat,*,*?truestate)
exten => 6,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 6,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*?TRUE:FALSE)})
exten => 6,n,GotoIfTime(00:00-23:59,sun,*,*?truestate)
exten => 6,n(falsestate),GotoIf($["${DB(TC/6):0:4}" = "true"]?truegoto)
exten => 6,n,ExecIf($["${DB(TC/6)}" = "false"]?Set(DB(TC/6)=))
exten => 6,n(falsegoto),Set(DEVICE_STATE(Custom:TC6)=INUSE)
exten => 6,n,ExecIf($["${DB(TC/6)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 6,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu353,1)
exten => 6,n,Set(TCSTATE=false)
exten => 6,n,Set(TCOVERRIDE=${IF($["${DB(TC/6):0:5}" = "false"]?true:false)})
exten => 6,n,Return()
exten => 6,n(truestate),GotoIf($["${DB(TC/6):0:5}" = "false"]?falsegoto)
exten => 6,n,ExecIf($["${DB(TC/6)}" = "true"]?Set(DB(TC/6)=))
exten => 6,n(truegoto),Set(DEVICE_STATE(Custom:TC6)=NOT_INUSE)
exten => 6,n,ExecIf($["${DB(TC/6)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 6,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,353,1)
exten => 6,n,Set(TCSTATE=true)
exten => 6,n,Set(TCOVERRIDE=${IF($["${DB(TC/6):0:4}" = "true"]?true:false)})
exten => 6,n,Return()

exten => 5,1,Set(DB(TC/5/INUSESTATE)=INUSE)
exten => 5,n,Set(DB(TC/5/NOT_INUSESTATE)=NOT_INUSE)
exten => 5,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 5,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*?TRUE:FALSE)})
exten => 5,n,GotoIfTime(00:00-07:49,mon-fri,*,*?truestate)
exten => 5,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 5,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*?TRUE:FALSE)})
exten => 5,n,GotoIfTime(14:51-23:59,mon-fri,*,*?truestate)
exten => 5,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 5,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*?TRUE:FALSE)})
exten => 5,n,GotoIfTime(00:00-23:59,sat,*,*?truestate)
exten => 5,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 5,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*?TRUE:FALSE)})
exten => 5,n,GotoIfTime(00:00-23:59,sun,*,*?truestate)
exten => 5,n(falsestate),GotoIf($["${DB(TC/5):0:4}" = "true"]?truegoto)
exten => 5,n,ExecIf($["${DB(TC/5)}" = "false"]?Set(DB(TC/5)=))
exten => 5,n(falsegoto),Set(DEVICE_STATE(Custom:TC5)=INUSE)
exten => 5,n,ExecIf($["${DB(TC/5)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 5,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu352,1)
exten => 5,n,Set(TCSTATE=false)
exten => 5,n,Set(TCOVERRIDE=${IF($["${DB(TC/5):0:5}" = "false"]?true:false)})
exten => 5,n,Return()
exten => 5,n(truestate),GotoIf($["${DB(TC/5):0:5}" = "false"]?falsegoto)
exten => 5,n,ExecIf($["${DB(TC/5)}" = "true"]?Set(DB(TC/5)=))
exten => 5,n(truegoto),Set(DEVICE_STATE(Custom:TC5)=NOT_INUSE)
exten => 5,n,ExecIf($["${DB(TC/5)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 5,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,352,1)
exten => 5,n,Set(TCSTATE=true)
exten => 5,n,Set(TCOVERRIDE=${IF($["${DB(TC/5):0:4}" = "true"]?true:false)})
exten => 5,n,Return()

exten => 4,1,Set(DB(TC/4/INUSESTATE)=INUSE)
exten => 4,n,Set(DB(TC/4/NOT_INUSESTATE)=NOT_INUSE)
exten => 4,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 4,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*?TRUE:FALSE)})
exten => 4,n,GotoIfTime(00:00-07:49,mon-fri,*,*?truestate)
exten => 4,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 4,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*?TRUE:FALSE)})
exten => 4,n,GotoIfTime(14:51-23:59,mon-fri,*,*?truestate)
exten => 4,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 4,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*?TRUE:FALSE)})
exten => 4,n,GotoIfTime(00:00-23:59,sat,*,*?truestate)
exten => 4,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 4,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*?TRUE:FALSE)})
exten => 4,n,GotoIfTime(00:00-23:59,sun,*,*?truestate)
exten => 4,n(falsestate),GotoIf($["${DB(TC/4):0:4}" = "true"]?truegoto)
exten => 4,n,ExecIf($["${DB(TC/4)}" = "false"]?Set(DB(TC/4)=))
exten => 4,n(falsegoto),Set(DEVICE_STATE(Custom:TC4)=INUSE)
exten => 4,n,ExecIf($["${DB(TC/4)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 4,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu351,1)
exten => 4,n,Set(TCSTATE=false)
exten => 4,n,Set(TCOVERRIDE=${IF($["${DB(TC/4):0:5}" = "false"]?true:false)})
exten => 4,n,Return()
exten => 4,n(truestate),GotoIf($["${DB(TC/4):0:5}" = "false"]?falsegoto)
exten => 4,n,ExecIf($["${DB(TC/4)}" = "true"]?Set(DB(TC/4)=))
exten => 4,n(truegoto),Set(DEVICE_STATE(Custom:TC4)=NOT_INUSE)
exten => 4,n,ExecIf($["${DB(TC/4)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 4,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,351,1)
exten => 4,n,Set(TCSTATE=true)
exten => 4,n,Set(TCOVERRIDE=${IF($["${DB(TC/4):0:4}" = "true"]?true:false)})
exten => 4,n,Return()

exten => 3,1,Set(DB(TC/3/INUSESTATE)=INUSE)
exten => 3,n,Set(DB(TC/3/NOT_INUSESTATE)=NOT_INUSE)
exten => 3,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 3,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*?TRUE:FALSE)})
exten => 3,n,GotoIfTime(00:00-07:49,mon-fri,*,*?truestate)
exten => 3,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 3,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*?TRUE:FALSE)})
exten => 3,n,GotoIfTime(14:51-23:59,mon-fri,*,*?truestate)
exten => 3,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 3,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*?TRUE:FALSE)})
exten => 3,n,GotoIfTime(00:00-23:59,sat,*,*?truestate)
exten => 3,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 3,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*?TRUE:FALSE)})
exten => 3,n,GotoIfTime(00:00-23:59,sun,*,*?truestate)
exten => 3,n(falsestate),GotoIf($["${DB(TC/3):0:4}" = "true"]?truegoto)
exten => 3,n,ExecIf($["${DB(TC/3)}" = "false"]?Set(DB(TC/3)=))
exten => 3,n(falsegoto),Set(DEVICE_STATE(Custom:TC3)=INUSE)
exten => 3,n,ExecIf($["${DB(TC/3)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 3,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu350,1)
exten => 3,n,Set(TCSTATE=false)
exten => 3,n,Set(TCOVERRIDE=${IF($["${DB(TC/3):0:5}" = "false"]?true:false)})
exten => 3,n,Return()
exten => 3,n(truestate),GotoIf($["${DB(TC/3):0:5}" = "false"]?falsegoto)
exten => 3,n,ExecIf($["${DB(TC/3)}" = "true"]?Set(DB(TC/3)=))
exten => 3,n(truegoto),Set(DEVICE_STATE(Custom:TC3)=NOT_INUSE)
exten => 3,n,ExecIf($["${DB(TC/3)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 3,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,350,1)
exten => 3,n,Set(TCSTATE=true)
exten => 3,n,Set(TCOVERRIDE=${IF($["${DB(TC/3):0:4}" = "true"]?true:false)})
exten => 3,n,Return()

exten => 2,1,Set(DB(TC/2/INUSESTATE)=INUSE)
exten => 2,n,Set(DB(TC/2/NOT_INUSESTATE)=NOT_INUSE)
exten => 2,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 2,n,Noop(TIMEMATCHED: ${IFTIME(07:30-15:30,mon-fri,*,*,America/Detroit?TRUE:FALSE)})
exten => 2,n,GotoIfTime(07:30-15:30,mon-fri,*,*,America/Detroit?truestate)
exten => 2,n(falsestate),GotoIf($["${DB(TC/2):0:4}" = "true"]?truegoto)
exten => 2,n,ExecIf($["${DB(TC/2)}" = "false"]?Set(DB(TC/2)=))
exten => 2,n(falsegoto),Set(DEVICE_STATE(Custom:TC2)=INUSE)
exten => 2,n,ExecIf($["${DB(TC/2)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 2,n,GotoIf($["${TCRETURN}"!="RETURN"]?ivr-4,s,1)
exten => 2,n,Set(TCSTATE=false)
exten => 2,n,Set(TCOVERRIDE=${IF($["${DB(TC/2):0:5}" = "false"]?true:false)})
exten => 2,n,Return()
exten => 2,n(truestate),GotoIf($["${DB(TC/2):0:5}" = "false"]?falsegoto)
exten => 2,n,ExecIf($["${DB(TC/2)}" = "true"]?Set(DB(TC/2)=))
exten => 2,n(truegoto),Set(DEVICE_STATE(Custom:TC2)=NOT_INUSE)
exten => 2,n,ExecIf($["${DB(TC/2)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 2,n,GotoIf($["${TCRETURN}"!="RETURN"]?timeconditions,33,1)
exten => 2,n,Set(TCSTATE=true)
exten => 2,n,Set(TCOVERRIDE=${IF($["${DB(TC/2):0:4}" = "true"]?true:false)})
exten => 2,n,Return()

exten => 10,1,Set(DB(TC/10/INUSESTATE)=INUSE)
exten => 10,n,Set(DB(TC/10/NOT_INUSESTATE)=NOT_INUSE)
exten => 10,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 10,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*?TRUE:FALSE)})
exten => 10,n,GotoIfTime(00:00-07:49,mon-fri,*,*?truestate)
exten => 10,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 10,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*?TRUE:FALSE)})
exten => 10,n,GotoIfTime(14:51-23:59,mon-fri,*,*?truestate)
exten => 10,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 10,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*?TRUE:FALSE)})
exten => 10,n,GotoIfTime(00:00-23:59,sat,*,*?truestate)
exten => 10,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 10,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*?TRUE:FALSE)})
exten => 10,n,GotoIfTime(00:00-23:59,sun,*,*?truestate)
exten => 10,n(falsestate),GotoIf($["${DB(TC/10):0:4}" = "true"]?truegoto)
exten => 10,n,ExecIf($["${DB(TC/10)}" = "false"]?Set(DB(TC/10)=))
exten => 10,n(falsegoto),Set(DEVICE_STATE(Custom:TC10)=INUSE)
exten => 10,n,ExecIf($["${DB(TC/10)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 10,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu357,1)
exten => 10,n,Set(TCSTATE=false)
exten => 10,n,Set(TCOVERRIDE=${IF($["${DB(TC/10):0:5}" = "false"]?true:false)})
exten => 10,n,Return()
exten => 10,n(truestate),GotoIf($["${DB(TC/10):0:5}" = "false"]?falsegoto)
exten => 10,n,ExecIf($["${DB(TC/10)}" = "true"]?Set(DB(TC/10)=))
exten => 10,n(truegoto),Set(DEVICE_STATE(Custom:TC10)=NOT_INUSE)
exten => 10,n,ExecIf($["${DB(TC/10)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 10,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,357,1)
exten => 10,n,Set(TCSTATE=true)
exten => 10,n,Set(TCOVERRIDE=${IF($["${DB(TC/10):0:4}" = "true"]?true:false)})
exten => 10,n,Return()

exten => 11,1,Set(DB(TC/11/INUSESTATE)=INUSE)
exten => 11,n,Set(DB(TC/11/NOT_INUSESTATE)=NOT_INUSE)
exten => 11,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 11,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*?TRUE:FALSE)})
exten => 11,n,GotoIfTime(00:00-07:49,mon-fri,*,*?truestate)
exten => 11,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 11,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*?TRUE:FALSE)})
exten => 11,n,GotoIfTime(14:51-23:59,mon-fri,*,*?truestate)
exten => 11,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 11,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*?TRUE:FALSE)})
exten => 11,n,GotoIfTime(00:00-23:59,sat,*,*?truestate)
exten => 11,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 11,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*?TRUE:FALSE)})
exten => 11,n,GotoIfTime(00:00-23:59,sun,*,*?truestate)
exten => 11,n(falsestate),GotoIf($["${DB(TC/11):0:4}" = "true"]?truegoto)
exten => 11,n,ExecIf($["${DB(TC/11)}" = "false"]?Set(DB(TC/11)=))
exten => 11,n(falsegoto),Set(DEVICE_STATE(Custom:TC11)=INUSE)
exten => 11,n,ExecIf($["${DB(TC/11)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 11,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu358,1)
exten => 11,n,Set(TCSTATE=false)
exten => 11,n,Set(TCOVERRIDE=${IF($["${DB(TC/11):0:5}" = "false"]?true:false)})
exten => 11,n,Return()
exten => 11,n(truestate),GotoIf($["${DB(TC/11):0:5}" = "false"]?falsegoto)
exten => 11,n,ExecIf($["${DB(TC/11)}" = "true"]?Set(DB(TC/11)=))
exten => 11,n(truegoto),Set(DEVICE_STATE(Custom:TC11)=NOT_INUSE)
exten => 11,n,ExecIf($["${DB(TC/11)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 11,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,358,1)
exten => 11,n,Set(TCSTATE=true)
exten => 11,n,Set(TCOVERRIDE=${IF($["${DB(TC/11):0:4}" = "true"]?true:false)})
exten => 11,n,Return()

exten => 12,1,Set(DB(TC/12/INUSESTATE)=INUSE)
exten => 12,n,Set(DB(TC/12/NOT_INUSESTATE)=NOT_INUSE)
exten => 12,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 12,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*?TRUE:FALSE)})
exten => 12,n,GotoIfTime(00:00-07:49,mon-fri,*,*?truestate)
exten => 12,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 12,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*?TRUE:FALSE)})
exten => 12,n,GotoIfTime(14:51-23:59,mon-fri,*,*?truestate)
exten => 12,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 12,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*?TRUE:FALSE)})
exten => 12,n,GotoIfTime(00:00-23:59,sat,*,*?truestate)
exten => 12,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 12,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*?TRUE:FALSE)})
exten => 12,n,GotoIfTime(00:00-23:59,sun,*,*?truestate)
exten => 12,n(falsestate),GotoIf($["${DB(TC/12):0:4}" = "true"]?truegoto)
exten => 12,n,ExecIf($["${DB(TC/12)}" = "false"]?Set(DB(TC/12)=))
exten => 12,n(falsegoto),Set(DEVICE_STATE(Custom:TC12)=INUSE)
exten => 12,n,ExecIf($["${DB(TC/12)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 12,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu359,1)
exten => 12,n,Set(TCSTATE=false)
exten => 12,n,Set(TCOVERRIDE=${IF($["${DB(TC/12):0:5}" = "false"]?true:false)})
exten => 12,n,Return()
exten => 12,n(truestate),GotoIf($["${DB(TC/12):0:5}" = "false"]?falsegoto)
exten => 12,n,ExecIf($["${DB(TC/12)}" = "true"]?Set(DB(TC/12)=))
exten => 12,n(truegoto),Set(DEVICE_STATE(Custom:TC12)=NOT_INUSE)
exten => 12,n,ExecIf($["${DB(TC/12)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 12,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,359,1)
exten => 12,n,Set(TCSTATE=true)
exten => 12,n,Set(TCOVERRIDE=${IF($["${DB(TC/12):0:4}" = "true"]?true:false)})
exten => 12,n,Return()

exten => 20,1,Set(DB(TC/20/INUSESTATE)=INUSE)
exten => 20,n,Set(DB(TC/20/NOT_INUSESTATE)=NOT_INUSE)
exten => 20,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 20,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*?TRUE:FALSE)})
exten => 20,n,GotoIfTime(00:00-07:49,mon-fri,*,*?truestate)
exten => 20,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 20,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*?TRUE:FALSE)})
exten => 20,n,GotoIfTime(14:51-23:59,mon-fri,*,*?truestate)
exten => 20,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 20,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*?TRUE:FALSE)})
exten => 20,n,GotoIfTime(00:00-23:59,sat,*,*?truestate)
exten => 20,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 20,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*?TRUE:FALSE)})
exten => 20,n,GotoIfTime(00:00-23:59,sun,*,*?truestate)
exten => 20,n(falsestate),GotoIf($["${DB(TC/20):0:4}" = "true"]?truegoto)
exten => 20,n,ExecIf($["${DB(TC/20)}" = "false"]?Set(DB(TC/20)=))
exten => 20,n(falsegoto),Set(DEVICE_STATE(Custom:TC20)=INUSE)
exten => 20,n,ExecIf($["${DB(TC/20)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 20,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu367,1)
exten => 20,n,Set(TCSTATE=false)
exten => 20,n,Set(TCOVERRIDE=${IF($["${DB(TC/20):0:5}" = "false"]?true:false)})
exten => 20,n,Return()
exten => 20,n(truestate),GotoIf($["${DB(TC/20):0:5}" = "false"]?falsegoto)
exten => 20,n,ExecIf($["${DB(TC/20)}" = "true"]?Set(DB(TC/20)=))
exten => 20,n(truegoto),Set(DEVICE_STATE(Custom:TC20)=NOT_INUSE)
exten => 20,n,ExecIf($["${DB(TC/20)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 20,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,367,1)
exten => 20,n,Set(TCSTATE=true)
exten => 20,n,Set(TCOVERRIDE=${IF($["${DB(TC/20):0:4}" = "true"]?true:false)})
exten => 20,n,Return()

exten => 19,1,Set(DB(TC/19/INUSESTATE)=INUSE)
exten => 19,n,Set(DB(TC/19/NOT_INUSESTATE)=NOT_INUSE)
exten => 19,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 19,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*?TRUE:FALSE)})
exten => 19,n,GotoIfTime(00:00-07:49,mon-fri,*,*?truestate)
exten => 19,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 19,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*?TRUE:FALSE)})
exten => 19,n,GotoIfTime(14:51-23:59,mon-fri,*,*?truestate)
exten => 19,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 19,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*?TRUE:FALSE)})
exten => 19,n,GotoIfTime(00:00-23:59,sat,*,*?truestate)
exten => 19,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 19,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*?TRUE:FALSE)})
exten => 19,n,GotoIfTime(00:00-23:59,sun,*,*?truestate)
exten => 19,n(falsestate),GotoIf($["${DB(TC/19):0:4}" = "true"]?truegoto)
exten => 19,n,ExecIf($["${DB(TC/19)}" = "false"]?Set(DB(TC/19)=))
exten => 19,n(falsegoto),Set(DEVICE_STATE(Custom:TC19)=INUSE)
exten => 19,n,ExecIf($["${DB(TC/19)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 19,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu366,1)
exten => 19,n,Set(TCSTATE=false)
exten => 19,n,Set(TCOVERRIDE=${IF($["${DB(TC/19):0:5}" = "false"]?true:false)})
exten => 19,n,Return()
exten => 19,n(truestate),GotoIf($["${DB(TC/19):0:5}" = "false"]?falsegoto)
exten => 19,n,ExecIf($["${DB(TC/19)}" = "true"]?Set(DB(TC/19)=))
exten => 19,n(truegoto),Set(DEVICE_STATE(Custom:TC19)=NOT_INUSE)
exten => 19,n,ExecIf($["${DB(TC/19)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 19,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,366,1)
exten => 19,n,Set(TCSTATE=true)
exten => 19,n,Set(TCOVERRIDE=${IF($["${DB(TC/19):0:4}" = "true"]?true:false)})
exten => 19,n,Return()

exten => 18,1,Set(DB(TC/18/INUSESTATE)=INUSE)
exten => 18,n,Set(DB(TC/18/NOT_INUSESTATE)=NOT_INUSE)
exten => 18,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 18,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*?TRUE:FALSE)})
exten => 18,n,GotoIfTime(00:00-07:49,mon-fri,*,*?truestate)
exten => 18,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 18,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*?TRUE:FALSE)})
exten => 18,n,GotoIfTime(14:51-23:59,mon-fri,*,*?truestate)
exten => 18,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 18,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*?TRUE:FALSE)})
exten => 18,n,GotoIfTime(00:00-23:59,sat,*,*?truestate)
exten => 18,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 18,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*?TRUE:FALSE)})
exten => 18,n,GotoIfTime(00:00-23:59,sun,*,*?truestate)
exten => 18,n(falsestate),GotoIf($["${DB(TC/18):0:4}" = "true"]?truegoto)
exten => 18,n,ExecIf($["${DB(TC/18)}" = "false"]?Set(DB(TC/18)=))
exten => 18,n(falsegoto),Set(DEVICE_STATE(Custom:TC18)=INUSE)
exten => 18,n,ExecIf($["${DB(TC/18)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 18,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu365,1)
exten => 18,n,Set(TCSTATE=false)
exten => 18,n,Set(TCOVERRIDE=${IF($["${DB(TC/18):0:5}" = "false"]?true:false)})
exten => 18,n,Return()
exten => 18,n(truestate),GotoIf($["${DB(TC/18):0:5}" = "false"]?falsegoto)
exten => 18,n,ExecIf($["${DB(TC/18)}" = "true"]?Set(DB(TC/18)=))
exten => 18,n(truegoto),Set(DEVICE_STATE(Custom:TC18)=NOT_INUSE)
exten => 18,n,ExecIf($["${DB(TC/18)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 18,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,365,1)
exten => 18,n,Set(TCSTATE=true)
exten => 18,n,Set(TCOVERRIDE=${IF($["${DB(TC/18):0:4}" = "true"]?true:false)})
exten => 18,n,Return()

exten => 17,1,Set(DB(TC/17/INUSESTATE)=INUSE)
exten => 17,n,Set(DB(TC/17/NOT_INUSESTATE)=NOT_INUSE)
exten => 17,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 17,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*?TRUE:FALSE)})
exten => 17,n,GotoIfTime(00:00-07:49,mon-fri,*,*?truestate)
exten => 17,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 17,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*?TRUE:FALSE)})
exten => 17,n,GotoIfTime(14:51-23:59,mon-fri,*,*?truestate)
exten => 17,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 17,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*?TRUE:FALSE)})
exten => 17,n,GotoIfTime(00:00-23:59,sat,*,*?truestate)
exten => 17,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 17,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*?TRUE:FALSE)})
exten => 17,n,GotoIfTime(00:00-23:59,sun,*,*?truestate)
exten => 17,n(falsestate),GotoIf($["${DB(TC/17):0:4}" = "true"]?truegoto)
exten => 17,n,ExecIf($["${DB(TC/17)}" = "false"]?Set(DB(TC/17)=))
exten => 17,n(falsegoto),Set(DEVICE_STATE(Custom:TC17)=INUSE)
exten => 17,n,ExecIf($["${DB(TC/17)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 17,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu364,1)
exten => 17,n,Set(TCSTATE=false)
exten => 17,n,Set(TCOVERRIDE=${IF($["${DB(TC/17):0:5}" = "false"]?true:false)})
exten => 17,n,Return()
exten => 17,n(truestate),GotoIf($["${DB(TC/17):0:5}" = "false"]?falsegoto)
exten => 17,n,ExecIf($["${DB(TC/17)}" = "true"]?Set(DB(TC/17)=))
exten => 17,n(truegoto),Set(DEVICE_STATE(Custom:TC17)=NOT_INUSE)
exten => 17,n,ExecIf($["${DB(TC/17)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 17,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,364,1)
exten => 17,n,Set(TCSTATE=true)
exten => 17,n,Set(TCOVERRIDE=${IF($["${DB(TC/17):0:4}" = "true"]?true:false)})
exten => 17,n,Return()

exten => 16,1,Set(DB(TC/16/INUSESTATE)=INUSE)
exten => 16,n,Set(DB(TC/16/NOT_INUSESTATE)=NOT_INUSE)
exten => 16,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 16,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*?TRUE:FALSE)})
exten => 16,n,GotoIfTime(00:00-07:49,mon-fri,*,*?truestate)
exten => 16,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 16,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*?TRUE:FALSE)})
exten => 16,n,GotoIfTime(14:51-23:59,mon-fri,*,*?truestate)
exten => 16,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 16,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*?TRUE:FALSE)})
exten => 16,n,GotoIfTime(00:00-23:59,sat,*,*?truestate)
exten => 16,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 16,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*?TRUE:FALSE)})
exten => 16,n,GotoIfTime(00:00-23:59,sun,*,*?truestate)
exten => 16,n(falsestate),GotoIf($["${DB(TC/16):0:4}" = "true"]?truegoto)
exten => 16,n,ExecIf($["${DB(TC/16)}" = "false"]?Set(DB(TC/16)=))
exten => 16,n(falsegoto),Set(DEVICE_STATE(Custom:TC16)=INUSE)
exten => 16,n,ExecIf($["${DB(TC/16)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 16,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu363,1)
exten => 16,n,Set(TCSTATE=false)
exten => 16,n,Set(TCOVERRIDE=${IF($["${DB(TC/16):0:5}" = "false"]?true:false)})
exten => 16,n,Return()
exten => 16,n(truestate),GotoIf($["${DB(TC/16):0:5}" = "false"]?falsegoto)
exten => 16,n,ExecIf($["${DB(TC/16)}" = "true"]?Set(DB(TC/16)=))
exten => 16,n(truegoto),Set(DEVICE_STATE(Custom:TC16)=NOT_INUSE)
exten => 16,n,ExecIf($["${DB(TC/16)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 16,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,363,1)
exten => 16,n,Set(TCSTATE=true)
exten => 16,n,Set(TCOVERRIDE=${IF($["${DB(TC/16):0:4}" = "true"]?true:false)})
exten => 16,n,Return()

exten => 15,1,Set(DB(TC/15/INUSESTATE)=INUSE)
exten => 15,n,Set(DB(TC/15/NOT_INUSESTATE)=NOT_INUSE)
exten => 15,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 15,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*?TRUE:FALSE)})
exten => 15,n,GotoIfTime(00:00-07:49,mon-fri,*,*?truestate)
exten => 15,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 15,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*?TRUE:FALSE)})
exten => 15,n,GotoIfTime(14:51-23:59,mon-fri,*,*?truestate)
exten => 15,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 15,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*?TRUE:FALSE)})
exten => 15,n,GotoIfTime(00:00-23:59,sat,*,*?truestate)
exten => 15,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 15,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*?TRUE:FALSE)})
exten => 15,n,GotoIfTime(00:00-23:59,sun,*,*?truestate)
exten => 15,n(falsestate),GotoIf($["${DB(TC/15):0:4}" = "true"]?truegoto)
exten => 15,n,ExecIf($["${DB(TC/15)}" = "false"]?Set(DB(TC/15)=))
exten => 15,n(falsegoto),Set(DEVICE_STATE(Custom:TC15)=INUSE)
exten => 15,n,ExecIf($["${DB(TC/15)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 15,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu362,1)
exten => 15,n,Set(TCSTATE=false)
exten => 15,n,Set(TCOVERRIDE=${IF($["${DB(TC/15):0:5}" = "false"]?true:false)})
exten => 15,n,Return()
exten => 15,n(truestate),GotoIf($["${DB(TC/15):0:5}" = "false"]?falsegoto)
exten => 15,n,ExecIf($["${DB(TC/15)}" = "true"]?Set(DB(TC/15)=))
exten => 15,n(truegoto),Set(DEVICE_STATE(Custom:TC15)=NOT_INUSE)
exten => 15,n,ExecIf($["${DB(TC/15)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 15,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,362,1)
exten => 15,n,Set(TCSTATE=true)
exten => 15,n,Set(TCOVERRIDE=${IF($["${DB(TC/15):0:4}" = "true"]?true:false)})
exten => 15,n,Return()

exten => 14,1,Set(DB(TC/14/INUSESTATE)=INUSE)
exten => 14,n,Set(DB(TC/14/NOT_INUSESTATE)=NOT_INUSE)
exten => 14,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 14,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*?TRUE:FALSE)})
exten => 14,n,GotoIfTime(00:00-07:49,mon-fri,*,*?truestate)
exten => 14,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 14,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*?TRUE:FALSE)})
exten => 14,n,GotoIfTime(14:51-23:59,mon-fri,*,*?truestate)
exten => 14,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 14,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*?TRUE:FALSE)})
exten => 14,n,GotoIfTime(00:00-23:59,sat,*,*?truestate)
exten => 14,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 14,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*?TRUE:FALSE)})
exten => 14,n,GotoIfTime(00:00-23:59,sun,*,*?truestate)
exten => 14,n(falsestate),GotoIf($["${DB(TC/14):0:4}" = "true"]?truegoto)
exten => 14,n,ExecIf($["${DB(TC/14)}" = "false"]?Set(DB(TC/14)=))
exten => 14,n(falsegoto),Set(DEVICE_STATE(Custom:TC14)=INUSE)
exten => 14,n,ExecIf($["${DB(TC/14)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 14,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu361,1)
exten => 14,n,Set(TCSTATE=false)
exten => 14,n,Set(TCOVERRIDE=${IF($["${DB(TC/14):0:5}" = "false"]?true:false)})
exten => 14,n,Return()
exten => 14,n(truestate),GotoIf($["${DB(TC/14):0:5}" = "false"]?falsegoto)
exten => 14,n,ExecIf($["${DB(TC/14)}" = "true"]?Set(DB(TC/14)=))
exten => 14,n(truegoto),Set(DEVICE_STATE(Custom:TC14)=NOT_INUSE)
exten => 14,n,ExecIf($["${DB(TC/14)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 14,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,361,1)
exten => 14,n,Set(TCSTATE=true)
exten => 14,n,Set(TCOVERRIDE=${IF($["${DB(TC/14):0:4}" = "true"]?true:false)})
exten => 14,n,Return()

exten => 13,1,Set(DB(TC/13/INUSESTATE)=INUSE)
exten => 13,n,Set(DB(TC/13/NOT_INUSESTATE)=NOT_INUSE)
exten => 13,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 13,n,Noop(TIMEMATCHED: ${IFTIME(00:00-07:49,mon-fri,*,*?TRUE:FALSE)})
exten => 13,n,GotoIfTime(00:00-07:49,mon-fri,*,*?truestate)
exten => 13,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 13,n,Noop(TIMEMATCHED: ${IFTIME(14:51-23:59,mon-fri,*,*?TRUE:FALSE)})
exten => 13,n,GotoIfTime(14:51-23:59,mon-fri,*,*?truestate)
exten => 13,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 13,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sat,*,*?TRUE:FALSE)})
exten => 13,n,GotoIfTime(00:00-23:59,sat,*,*?truestate)
exten => 13,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},,%H:%M,%a,%e,%b)})
exten => 13,n,Noop(TIMEMATCHED: ${IFTIME(00:00-23:59,sun,*,*?TRUE:FALSE)})
exten => 13,n,GotoIfTime(00:00-23:59,sun,*,*?truestate)
exten => 13,n(falsestate),GotoIf($["${DB(TC/13):0:4}" = "true"]?truegoto)
exten => 13,n,ExecIf($["${DB(TC/13)}" = "false"]?Set(DB(TC/13)=))
exten => 13,n(falsegoto),Set(DEVICE_STATE(Custom:TC13)=INUSE)
exten => 13,n,ExecIf($["${DB(TC/13)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 13,n,GotoIf($["${TCRETURN}"!="RETURN"]?ext-local,vmu360,1)
exten => 13,n,Set(TCSTATE=false)
exten => 13,n,Set(TCOVERRIDE=${IF($["${DB(TC/13):0:5}" = "false"]?true:false)})
exten => 13,n,Return()
exten => 13,n(truestate),GotoIf($["${DB(TC/13):0:5}" = "false"]?falsegoto)
exten => 13,n,ExecIf($["${DB(TC/13)}" = "true"]?Set(DB(TC/13)=))
exten => 13,n(truegoto),Set(DEVICE_STATE(Custom:TC13)=NOT_INUSE)
exten => 13,n,ExecIf($["${DB(TC/13)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 13,n,GotoIf($["${TCRETURN}"!="RETURN"]?from-did-direct,360,1)
exten => 13,n,Set(TCSTATE=true)
exten => 13,n,Set(TCOVERRIDE=${IF($["${DB(TC/13):0:4}" = "true"]?true:false)})
exten => 13,n,Return()

exten => 1,1,Set(DB(TC/1/INUSESTATE)=INUSE)
exten => 1,n,Set(DB(TC/1/NOT_INUSESTATE)=NOT_INUSE)
exten => 1,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 1,n,Noop(TIMEMATCHED: ${IFTIME(*,*,1-2,jan,America/Detroit?TRUE:FALSE)})
exten => 1,n,GotoIfTime(*,*,1-2,jan,America/Detroit?truestate)
exten => 1,n,Noop(TIMENOW: ${STRFTIME(${EPOCH},America/Detroit,%H:%M,%a,%e,%b)},America/Detroit)
exten => 1,n,Noop(TIMEMATCHED: ${IFTIME(*,*,24-31,dec,America/Detroit?TRUE:FALSE)})
exten => 1,n,GotoIfTime(*,*,24-31,dec,America/Detroit?truestate)
exten => 1,n(falsestate),GotoIf($["${DB(TC/1):0:4}" = "true"]?truegoto)
exten => 1,n,ExecIf($["${DB(TC/1)}" = "false"]?Set(DB(TC/1)=))
exten => 1,n(falsegoto),Set(DEVICE_STATE(Custom:TC1)=INUSE)
exten => 1,n,ExecIf($["${DB(TC/1)}" = "false_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 1,n,GotoIf($["${TCRETURN}"!="RETURN"]?timeconditions,2,1)
exten => 1,n,Set(TCSTATE=false)
exten => 1,n,Set(TCOVERRIDE=${IF($["${DB(TC/1):0:5}" = "false"]?true:false)})
exten => 1,n,Return()
exten => 1,n(truestate),GotoIf($["${DB(TC/1):0:5}" = "false"]?falsegoto)
exten => 1,n,ExecIf($["${DB(TC/1)}" = "true"]?Set(DB(TC/1)=))
exten => 1,n(truegoto),Set(DEVICE_STATE(Custom:TC1)=NOT_INUSE)
exten => 1,n,ExecIf($["${DB(TC/1)}" = "true_sticky"]?Set(DEVICE_STATE(Custom:TCSTICKY${ARG1})=INUSE))
exten => 1,n,GotoIf($["${TCRETURN}"!="RETURN"]?ivr-5,s,1)
exten => 1,n,Set(TCSTATE=true)
exten => 1,n,Set(TCOVERRIDE=${IF($["${DB(TC/1):0:4}" = "true"]?true:false)})
exten => 1,n,Return()

;--== end of [timeconditions] ==--;


[timeconditions-toggles]
exten => *2744,1,Macro(user-callerid,)
exten => *2744,n,Macro(toggle-tc,44)
exten => *2744,n,Hangup
exten => *2744,hint,Custom:TC44

exten => *2730,1,Macro(user-callerid,)
exten => *2730,n,Macro(toggle-tc,30,1776)
exten => *2730,n,Hangup
exten => *2730,hint,Custom:TC30

exten => *2734,1,Macro(user-callerid,)
exten => *2734,n,Macro(toggle-tc,34)
exten => *2734,n,Hangup
exten => *2734,hint,Custom:TC34

exten => *2728,1,Macro(user-callerid,)
exten => *2728,n,Macro(toggle-tc,28,1776)
exten => *2728,n,Hangup
exten => *2728,hint,Custom:TC28

exten => *2727,1,Macro(user-callerid,)
exten => *2727,n,Macro(toggle-tc,27,1776)
exten => *2727,n,Hangup
exten => *2727,hint,Custom:TC27

exten => *2726,1,Macro(user-callerid,)
exten => *2726,n,Macro(toggle-tc,26,1776)
exten => *2726,n,Hangup
exten => *2726,hint,Custom:TC26

exten => *2725,1,Macro(user-callerid,)
exten => *2725,n,Macro(toggle-tc,25,1776)
exten => *2725,n,Hangup
exten => *2725,hint,Custom:TC25

exten => *2724,1,Macro(user-callerid,)
exten => *2724,n,Macro(toggle-tc,24,1776)
exten => *2724,n,Hangup
exten => *2724,hint,Custom:TC24

exten => *2723,1,Macro(user-callerid,)
exten => *2723,n,Macro(toggle-tc,23,1776)
exten => *2723,n,Hangup
exten => *2723,hint,Custom:TC23

exten => *2731,1,Macro(user-callerid,)
exten => *2731,n,Macro(toggle-tc,31)
exten => *2731,n,Hangup
exten => *2731,hint,Custom:TC31

exten => *2732,1,Macro(user-callerid,)
exten => *2732,n,Macro(toggle-tc,32)
exten => *2732,n,Hangup
exten => *2732,hint,Custom:TC32

exten => *2733,1,Macro(user-callerid,)
exten => *2733,n,Macro(toggle-tc,33)
exten => *2733,n,Hangup
exten => *2733,hint,Custom:TC33

exten => *2742,1,Macro(user-callerid,)
exten => *2742,n,Macro(toggle-tc,42)
exten => *2742,n,Hangup
exten => *2742,hint,Custom:TC42

exten => *2741,1,Macro(user-callerid,)
exten => *2741,n,Macro(toggle-tc,41)
exten => *2741,n,Hangup
exten => *2741,hint,Custom:TC41

exten => *2740,1,Macro(user-callerid,)
exten => *2740,n,Macro(toggle-tc,40)
exten => *2740,n,Hangup
exten => *2740,hint,Custom:TC40

exten => *2739,1,Macro(user-callerid,)
exten => *2739,n,Macro(toggle-tc,39)
exten => *2739,n,Hangup
exten => *2739,hint,Custom:TC39

exten => *2738,1,Macro(user-callerid,)
exten => *2738,n,Macro(toggle-tc,38)
exten => *2738,n,Hangup
exten => *2738,hint,Custom:TC38

exten => *2737,1,Macro(user-callerid,)
exten => *2737,n,Macro(toggle-tc,37)
exten => *2737,n,Hangup
exten => *2737,hint,Custom:TC37

exten => *2736,1,Macro(user-callerid,)
exten => *2736,n,Macro(toggle-tc,36)
exten => *2736,n,Hangup
exten => *2736,hint,Custom:TC36

exten => *2735,1,Macro(user-callerid,)
exten => *2735,n,Macro(toggle-tc,35)
exten => *2735,n,Hangup
exten => *2735,hint,Custom:TC35

exten => *2722,1,Macro(user-callerid,)
exten => *2722,n,Macro(toggle-tc,22,1776)
exten => *2722,n,Hangup
exten => *2722,hint,Custom:TC22

exten => *2721,1,Macro(user-callerid,)
exten => *2721,n,Macro(toggle-tc,21,1776)
exten => *2721,n,Hangup
exten => *2721,hint,Custom:TC21

exten => *279,1,Macro(user-callerid,)
exten => *279,n,Macro(toggle-tc,9,1776)
exten => *279,n,Hangup
exten => *279,hint,Custom:TC9

exten => *278,1,Macro(user-callerid,)
exten => *278,n,Macro(toggle-tc,8,1776)
exten => *278,n,Hangup
exten => *278,hint,Custom:TC8

exten => *277,1,Macro(user-callerid,)
exten => *277,n,Macro(toggle-tc,7,1776)
exten => *277,n,Hangup
exten => *277,hint,Custom:TC7

exten => *276,1,Macro(user-callerid,)
exten => *276,n,Macro(toggle-tc,6,1776)
exten => *276,n,Hangup
exten => *276,hint,Custom:TC6

exten => *275,1,Macro(user-callerid,)
exten => *275,n,Macro(toggle-tc,5,1776)
exten => *275,n,Hangup
exten => *275,hint,Custom:TC5

exten => *274,1,Macro(user-callerid,)
exten => *274,n,Macro(toggle-tc,4,1776)
exten => *274,n,Hangup
exten => *274,hint,Custom:TC4

exten => *273,1,Macro(user-callerid,)
exten => *273,n,Macro(toggle-tc,3,1776)
exten => *273,n,Hangup
exten => *273,hint,Custom:TC3

exten => *272,1,Macro(user-callerid,)
exten => *272,n,Macro(toggle-tc,2)
exten => *272,n,Hangup
exten => *272,hint,Custom:TC2

exten => *2710,1,Macro(user-callerid,)
exten => *2710,n,Macro(toggle-tc,10,1776)
exten => *2710,n,Hangup
exten => *2710,hint,Custom:TC10

exten => *2711,1,Macro(user-callerid,)
exten => *2711,n,Macro(toggle-tc,11,1776)
exten => *2711,n,Hangup
exten => *2711,hint,Custom:TC11

exten => *2712,1,Macro(user-callerid,)
exten => *2712,n,Macro(toggle-tc,12,1776)
exten => *2712,n,Hangup
exten => *2712,hint,Custom:TC12

exten => *2720,1,Macro(user-callerid,)
exten => *2720,n,Macro(toggle-tc,20,1776)
exten => *2720,n,Hangup
exten => *2720,hint,Custom:TC20

exten => *2719,1,Macro(user-callerid,)
exten => *2719,n,Macro(toggle-tc,19,1776)
exten => *2719,n,Hangup
exten => *2719,hint,Custom:TC19

exten => *2718,1,Macro(user-callerid,)
exten => *2718,n,Macro(toggle-tc,18,1776)
exten => *2718,n,Hangup
exten => *2718,hint,Custom:TC18

exten => *2717,1,Macro(user-callerid,)
exten => *2717,n,Macro(toggle-tc,17,1776)
exten => *2717,n,Hangup
exten => *2717,hint,Custom:TC17

exten => *2716,1,Macro(user-callerid,)
exten => *2716,n,Macro(toggle-tc,16,1776)
exten => *2716,n,Hangup
exten => *2716,hint,Custom:TC16

exten => *2715,1,Macro(user-callerid,)
exten => *2715,n,Macro(toggle-tc,15,1776)
exten => *2715,n,Hangup
exten => *2715,hint,Custom:TC15

exten => *2714,1,Macro(user-callerid,)
exten => *2714,n,Macro(toggle-tc,14,1776)
exten => *2714,n,Hangup
exten => *2714,hint,Custom:TC14

exten => *2713,1,Macro(user-callerid,)
exten => *2713,n,Macro(toggle-tc,13,1776)
exten => *2713,n,Hangup
exten => *2713,hint,Custom:TC13

exten => *271,1,Macro(user-callerid,)
exten => *271,n,Macro(toggle-tc,1)
exten => *271,n,Hangup
exten => *271,hint,Custom:TC1

exten => h,1,Hangup

;--== end of [timeconditions-toggles] ==--;


[macro-toggle-tc]
exten => lang-playback,1,GosubIf($[${DIALPLAN_EXISTS(macro-toggle-tc,${CHANNEL(language)})}]?macro-toggle-tc,${CHANNEL(language)},${ARG1}():macro-toggle-tc,en,${ARG1}())
exten => lang-playback,n,Return()

exten => s,1,GotoIf($[${ARG2} > 0]?hasauth:toggle)
exten => s,n(hasauth),Authenticate(${ARG2},)
exten => s,n(toggle),Set(INDEXES=${ARG1})
exten => s,n,Set(TCRETURN=RETURN)
exten => s,n,Set(TCSTATE=false)
exten => s,n,Set(TCINUSE=${DB(TC/${ARG1}/INUSESTATE)})
exten => s,n,Set(TCNOTINUSE=${DB(TC/${ARG1}/NOT_INUSESTATE)})
exten => s,n,Set(LOOPCNT=${FIELDQTY(INDEXES,&)})
exten => s,n,Set(ITER=1)
exten => s,n(begin1),Set(INDEX=${CUT(INDEXES,&,${ITER})})
exten => s,n,Gosub(timeconditions,${INDEX},1())
exten => s,n,Set(TCSTATE_${INDEX}=${TCSTATE})
exten => s,n,ExecIf($["${TCOVERRIDE}" = "true"]?Set(OVERRIDE=true))
exten => s,n(end1),Set(ITER=$[${ITER} + 1])
exten => s,n,GotoIf($[${ITER} <= ${LOOPCNT}]?begin1)
exten => s,n,Set(LOOPCNT=${FIELDQTY(INDEXES,&)})
exten => s,n,Set(ITER=1)
exten => s,n(begin2),Set(INDEX=${CUT(INDEXES,&,${ITER})})
exten => s,n,Set(DB(TC/${INDEX})=${IF($["${OVERRIDE}" = "true"]?:${IF($["${TCSTATE_${INDEX}}" == "true"]?false:true)})})
exten => s,n,Gosub(timeconditions,${INDEX},1())
exten => s,n(end2),Set(ITER=$[${ITER} + 1])
exten => s,n,GotoIf($[${ITER} <= ${LOOPCNT}]?begin2)
exten => s,n(playback),Gosub(macro-toggle-tc,lang-playback,1(hook_0))

exten => en,1(hook_0),Playback(beep&silence/1&time&${IF($["${TCSTATE}" = "true"]?de-activated:activated)})

exten => ja,1(hook_0),Playback(beep&silence/1&time-change&${IF($["${TCSTATE}" = "true"]?de-activated:activated)})

;--== end of [macro-toggle-tc] ==--;


[vm-callme]
exten => s,1,Answer
exten => s,n,Wait(1)
exten => s,n(repeat),Background(${MSG}&silence/2&vm-repeat&vm-starmain)
exten => s,n,WaitExten(15,)

exten => 5,1,Goto(s,repeat)

exten => #,1,Playback(vm-goodbye)
exten => #,n,Hangup

exten => *,1,Macro(get-vmcontext,${MBOX})
exten => *,n,VoiceMailMain(${MBOX}@${VMCONTEXT},s)

exten => i,1,Playback(pm-invalid-option)
exten => i,n,Goto(s,repeat)

exten => t,1,Playback(vm-goodbye)
exten => t,n,Hangup

exten => h,1,Hangup

;--== end of [vm-callme] ==--;


[app-dialvm]
exten => *98,1,Macro(user-callerid,)
exten => *98,n,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *98,n,Set(CONNECTEDLINE(name,i)=Dial Voicemail)
exten => *98,n,Set(CONNECTEDLINE(num,i)=${EXTEN})
exten => *98,n,Answer
exten => *98,n(start),Wait(1)
exten => *98,n,Noop(app-dialvm: Asking for mailbox)
exten => *98,n,Read(MAILBOX,vm-login,,,3,2)
exten => *98,n(check),GotoIf($["${MAILBOX}" = ""]?hangup)
exten => *98,n,Noop(app-dialvm: Got Mailbox ${MAILBOX})
exten => *98,n,Macro(get-vmcontext,${MAILBOX})
exten => *98,n,Set(VMBOXEXISTSSTATUS=${IF(${VM_INFO(${MAILBOX}@${VMCONTEXT},exists)}?SUCCESS:FAILED)})
exten => *98,n,GotoIf($["${VMBOXEXISTSSTATUS}" = "SUCCESS"]?good:bad)
exten => *98,n,Macro(hangupcall,)
exten => *98,n(good),Noop(app-dialvm: Good mailbox ${MAILBOX}@${VMCONTEXT})
exten => *98,n,VoiceMailMain(${MAILBOX}@${VMCONTEXT})
exten => *98,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?playret)
exten => *98,n,Macro(hangupcall,)
exten => *98,n(bad),Noop(app-dialvm: BAD mailbox ${MAILBOX}@${VMCONTEXT})
exten => *98,n,Wait(1)
exten => *98,n,Noop(app-dialvm: Asking for password so people can't probe for existence of a mailbox)
exten => *98,n,Read(FAKEPW,vm-password,,,3,2)
exten => *98,n,Noop(app-dialvm: Asking for mailbox again)
exten => *98,n,Read(MAILBOX,vm-incorrect-mailbox,,,3,2)
exten => *98,n,Goto(check)
exten => *98,n,Macro(hangupcall,)
exten => *98,n(hangup),Playback(vm-incorrect&vm-goodbye)
exten => *98,n,Macro(hangupcall,)
exten => *98,n(playret),Playback(beep&you-will-be-transfered-menu&silence/1)
exten => *98,n,Goto(${IVR_CONTEXT},return,1)

exten => _*98.,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => _*98.,n,Set(CONNECTEDLINE(name,i)=Dial Voicemail)
exten => _*98.,n,Set(CONNECTEDLINE(num,i)=${EXTEN:3})
exten => _*98.,n,Answer
exten => _*98.,n,Wait(1)
exten => _*98.,n,Macro(get-vmcontext,${EXTEN:3})
exten => _*98.,n,VoiceMailMain(${EXTEN:3}@${VMCONTEXT})
exten => _*98.,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?${IVR_CONTEXT},return,1)
exten => _*98.,n,Macro(hangupcall,)

;--== end of [app-dialvm] ==--;


[ext-local]
exten => *100,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *100,n,Set(CONNECTEDLINE(name,i)=100 Voicemail)
exten => *100,n,Set(CONNECTEDLINE(num,i)=100)
exten => *100,n,Macro(vm,100,DIRECTDIAL,${IVR_RETVM})
exten => *100,n,Goto(vmret,1)

exten => *102,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *102,n,Set(CONNECTEDLINE(name,i)=102 Voicemail)
exten => *102,n,Set(CONNECTEDLINE(num,i)=102)
exten => *102,n,Macro(vm,102,DIRECTDIAL,${IVR_RETVM})
exten => *102,n,Goto(vmret,1)

exten => *105,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *105,n,Set(CONNECTEDLINE(name,i)=105 Voicemail)
exten => *105,n,Set(CONNECTEDLINE(num,i)=105)
exten => *105,n,Macro(vm,105,DIRECTDIAL,${IVR_RETVM})
exten => *105,n,Goto(vmret,1)

exten => *106,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *106,n,Set(CONNECTEDLINE(name,i)=106 Voicemail)
exten => *106,n,Set(CONNECTEDLINE(num,i)=106)
exten => *106,n,Macro(vm,106,DIRECTDIAL,${IVR_RETVM})
exten => *106,n,Goto(vmret,1)

exten => *107,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *107,n,Set(CONNECTEDLINE(name,i)=107 Voicemail)
exten => *107,n,Set(CONNECTEDLINE(num,i)=107)
exten => *107,n,Macro(vm,107,DIRECTDIAL,${IVR_RETVM})
exten => *107,n,Goto(vmret,1)

exten => *127,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *127,n,Set(CONNECTEDLINE(name,i)=127 Voicemail)
exten => *127,n,Set(CONNECTEDLINE(num,i)=127)
exten => *127,n,Macro(vm,127,DIRECTDIAL,${IVR_RETVM})
exten => *127,n,Goto(vmret,1)

exten => *129,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *129,n,Set(CONNECTEDLINE(name,i)=129 Voicemail)
exten => *129,n,Set(CONNECTEDLINE(num,i)=129)
exten => *129,n,Macro(vm,129,DIRECTDIAL,${IVR_RETVM})
exten => *129,n,Goto(vmret,1)

exten => *130,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *130,n,Set(CONNECTEDLINE(name,i)=130 Voicemail)
exten => *130,n,Set(CONNECTEDLINE(num,i)=130)
exten => *130,n,Macro(vm,130,DIRECTDIAL,${IVR_RETVM})
exten => *130,n,Goto(vmret,1)

exten => *131,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *131,n,Set(CONNECTEDLINE(name,i)=131 Voicemail)
exten => *131,n,Set(CONNECTEDLINE(num,i)=131)
exten => *131,n,Macro(vm,131,DIRECTDIAL,${IVR_RETVM})
exten => *131,n,Goto(vmret,1)

exten => *132,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *132,n,Set(CONNECTEDLINE(name,i)=132 Voicemail)
exten => *132,n,Set(CONNECTEDLINE(num,i)=132)
exten => *132,n,Macro(vm,132,DIRECTDIAL,${IVR_RETVM})
exten => *132,n,Goto(vmret,1)

exten => *133,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *133,n,Set(CONNECTEDLINE(name,i)=133 Voicemail)
exten => *133,n,Set(CONNECTEDLINE(num,i)=133)
exten => *133,n,Macro(vm,133,DIRECTDIAL,${IVR_RETVM})
exten => *133,n,Goto(vmret,1)

exten => *134,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *134,n,Set(CONNECTEDLINE(name,i)=134 Voicemail)
exten => *134,n,Set(CONNECTEDLINE(num,i)=134)
exten => *134,n,Macro(vm,134,DIRECTDIAL,${IVR_RETVM})
exten => *134,n,Goto(vmret,1)

exten => *135,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *135,n,Set(CONNECTEDLINE(name,i)=135 Voicemail)
exten => *135,n,Set(CONNECTEDLINE(num,i)=135)
exten => *135,n,Macro(vm,135,DIRECTDIAL,${IVR_RETVM})
exten => *135,n,Goto(vmret,1)

exten => *136,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *136,n,Set(CONNECTEDLINE(name,i)=136 Voicemail)
exten => *136,n,Set(CONNECTEDLINE(num,i)=136)
exten => *136,n,Macro(vm,136,DIRECTDIAL,${IVR_RETVM})
exten => *136,n,Goto(vmret,1)

exten => *137,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *137,n,Set(CONNECTEDLINE(name,i)=137 Voicemail)
exten => *137,n,Set(CONNECTEDLINE(num,i)=137)
exten => *137,n,Macro(vm,137,DIRECTDIAL,${IVR_RETVM})
exten => *137,n,Goto(vmret,1)

exten => *138,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *138,n,Set(CONNECTEDLINE(name,i)=138 Voicemail)
exten => *138,n,Set(CONNECTEDLINE(num,i)=138)
exten => *138,n,Macro(vm,138,DIRECTDIAL,${IVR_RETVM})
exten => *138,n,Goto(vmret,1)

exten => *139,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *139,n,Set(CONNECTEDLINE(name,i)=139 Voicemail)
exten => *139,n,Set(CONNECTEDLINE(num,i)=139)
exten => *139,n,Macro(vm,139,DIRECTDIAL,${IVR_RETVM})
exten => *139,n,Goto(vmret,1)

exten => *140,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *140,n,Set(CONNECTEDLINE(name,i)=140 Voicemail)
exten => *140,n,Set(CONNECTEDLINE(num,i)=140)
exten => *140,n,Macro(vm,140,DIRECTDIAL,${IVR_RETVM})
exten => *140,n,Goto(vmret,1)

exten => *141,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *141,n,Set(CONNECTEDLINE(name,i)=141 Voicemail)
exten => *141,n,Set(CONNECTEDLINE(num,i)=141)
exten => *141,n,Macro(vm,141,DIRECTDIAL,${IVR_RETVM})
exten => *141,n,Goto(vmret,1)

exten => *142,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *142,n,Set(CONNECTEDLINE(name,i)=142 Voicemail)
exten => *142,n,Set(CONNECTEDLINE(num,i)=142)
exten => *142,n,Macro(vm,142,DIRECTDIAL,${IVR_RETVM})
exten => *142,n,Goto(vmret,1)

exten => *144,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *144,n,Set(CONNECTEDLINE(name,i)=144 Voicemail)
exten => *144,n,Set(CONNECTEDLINE(num,i)=144)
exten => *144,n,Macro(vm,144,DIRECTDIAL,${IVR_RETVM})
exten => *144,n,Goto(vmret,1)

exten => *145,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *145,n,Set(CONNECTEDLINE(name,i)=145 Voicemail)
exten => *145,n,Set(CONNECTEDLINE(num,i)=145)
exten => *145,n,Macro(vm,145,DIRECTDIAL,${IVR_RETVM})
exten => *145,n,Goto(vmret,1)

exten => *146,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *146,n,Set(CONNECTEDLINE(name,i)=146 Voicemail)
exten => *146,n,Set(CONNECTEDLINE(num,i)=146)
exten => *146,n,Macro(vm,146,DIRECTDIAL,${IVR_RETVM})
exten => *146,n,Goto(vmret,1)

exten => *147,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *147,n,Set(CONNECTEDLINE(name,i)=147 Voicemail)
exten => *147,n,Set(CONNECTEDLINE(num,i)=147)
exten => *147,n,Macro(vm,147,DIRECTDIAL,${IVR_RETVM})
exten => *147,n,Goto(vmret,1)

exten => *148,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *148,n,Set(CONNECTEDLINE(name,i)=148 Voicemail)
exten => *148,n,Set(CONNECTEDLINE(num,i)=148)
exten => *148,n,Macro(vm,148,DIRECTDIAL,${IVR_RETVM})
exten => *148,n,Goto(vmret,1)

exten => *149,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *149,n,Set(CONNECTEDLINE(name,i)=149 Voicemail)
exten => *149,n,Set(CONNECTEDLINE(num,i)=149)
exten => *149,n,Macro(vm,149,DIRECTDIAL,${IVR_RETVM})
exten => *149,n,Goto(vmret,1)

exten => *152,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *152,n,Set(CONNECTEDLINE(name,i)=152 Voicemail)
exten => *152,n,Set(CONNECTEDLINE(num,i)=152)
exten => *152,n,Macro(vm,152,DIRECTDIAL,${IVR_RETVM})
exten => *152,n,Goto(vmret,1)

exten => *350,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *350,n,Set(CONNECTEDLINE(name,i)=350 Voicemail)
exten => *350,n,Set(CONNECTEDLINE(num,i)=350)
exten => *350,n,Macro(vm,350,DIRECTDIAL,${IVR_RETVM})
exten => *350,n,Goto(vmret,1)

exten => *351,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *351,n,Set(CONNECTEDLINE(name,i)=351 Voicemail)
exten => *351,n,Set(CONNECTEDLINE(num,i)=351)
exten => *351,n,Macro(vm,351,DIRECTDIAL,${IVR_RETVM})
exten => *351,n,Goto(vmret,1)

exten => *352,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *352,n,Set(CONNECTEDLINE(name,i)=352 Voicemail)
exten => *352,n,Set(CONNECTEDLINE(num,i)=352)
exten => *352,n,Macro(vm,352,DIRECTDIAL,${IVR_RETVM})
exten => *352,n,Goto(vmret,1)

exten => *353,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *353,n,Set(CONNECTEDLINE(name,i)=353 Voicemail)
exten => *353,n,Set(CONNECTEDLINE(num,i)=353)
exten => *353,n,Macro(vm,353,DIRECTDIAL,${IVR_RETVM})
exten => *353,n,Goto(vmret,1)

exten => *354,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *354,n,Set(CONNECTEDLINE(name,i)=354 Voicemail)
exten => *354,n,Set(CONNECTEDLINE(num,i)=354)
exten => *354,n,Macro(vm,354,DIRECTDIAL,${IVR_RETVM})
exten => *354,n,Goto(vmret,1)

exten => *355,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *355,n,Set(CONNECTEDLINE(name,i)=355 Voicemail)
exten => *355,n,Set(CONNECTEDLINE(num,i)=355)
exten => *355,n,Macro(vm,355,DIRECTDIAL,${IVR_RETVM})
exten => *355,n,Goto(vmret,1)

exten => *356,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *356,n,Set(CONNECTEDLINE(name,i)=356 Voicemail)
exten => *356,n,Set(CONNECTEDLINE(num,i)=356)
exten => *356,n,Macro(vm,356,DIRECTDIAL,${IVR_RETVM})
exten => *356,n,Goto(vmret,1)

exten => *357,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *357,n,Set(CONNECTEDLINE(name,i)=357 Voicemail)
exten => *357,n,Set(CONNECTEDLINE(num,i)=357)
exten => *357,n,Macro(vm,357,DIRECTDIAL,${IVR_RETVM})
exten => *357,n,Goto(vmret,1)

exten => *358,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *358,n,Set(CONNECTEDLINE(name,i)=358 Voicemail)
exten => *358,n,Set(CONNECTEDLINE(num,i)=358)
exten => *358,n,Macro(vm,358,DIRECTDIAL,${IVR_RETVM})
exten => *358,n,Goto(vmret,1)

exten => *359,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *359,n,Set(CONNECTEDLINE(name,i)=359 Voicemail)
exten => *359,n,Set(CONNECTEDLINE(num,i)=359)
exten => *359,n,Macro(vm,359,DIRECTDIAL,${IVR_RETVM})
exten => *359,n,Goto(vmret,1)

exten => *360,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *360,n,Set(CONNECTEDLINE(name,i)=360 Voicemail)
exten => *360,n,Set(CONNECTEDLINE(num,i)=360)
exten => *360,n,Macro(vm,360,DIRECTDIAL,${IVR_RETVM})
exten => *360,n,Goto(vmret,1)

exten => *361,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *361,n,Set(CONNECTEDLINE(name,i)=361 Voicemail)
exten => *361,n,Set(CONNECTEDLINE(num,i)=361)
exten => *361,n,Macro(vm,361,DIRECTDIAL,${IVR_RETVM})
exten => *361,n,Goto(vmret,1)

exten => *362,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *362,n,Set(CONNECTEDLINE(name,i)=362 Voicemail)
exten => *362,n,Set(CONNECTEDLINE(num,i)=362)
exten => *362,n,Macro(vm,362,DIRECTDIAL,${IVR_RETVM})
exten => *362,n,Goto(vmret,1)

exten => *363,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *363,n,Set(CONNECTEDLINE(name,i)=363 Voicemail)
exten => *363,n,Set(CONNECTEDLINE(num,i)=363)
exten => *363,n,Macro(vm,363,DIRECTDIAL,${IVR_RETVM})
exten => *363,n,Goto(vmret,1)

exten => *364,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *364,n,Set(CONNECTEDLINE(name,i)=364 Voicemail)
exten => *364,n,Set(CONNECTEDLINE(num,i)=364)
exten => *364,n,Macro(vm,364,DIRECTDIAL,${IVR_RETVM})
exten => *364,n,Goto(vmret,1)

exten => *365,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *365,n,Set(CONNECTEDLINE(name,i)=365 Voicemail)
exten => *365,n,Set(CONNECTEDLINE(num,i)=365)
exten => *365,n,Macro(vm,365,DIRECTDIAL,${IVR_RETVM})
exten => *365,n,Goto(vmret,1)

exten => *366,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *366,n,Set(CONNECTEDLINE(name,i)=366 Voicemail)
exten => *366,n,Set(CONNECTEDLINE(num,i)=366)
exten => *366,n,Macro(vm,366,DIRECTDIAL,${IVR_RETVM})
exten => *366,n,Goto(vmret,1)

exten => *367,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *367,n,Set(CONNECTEDLINE(name,i)=367 Voicemail)
exten => *367,n,Set(CONNECTEDLINE(num,i)=367)
exten => *367,n,Macro(vm,367,DIRECTDIAL,${IVR_RETVM})
exten => *367,n,Goto(vmret,1)

exten => *368,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *368,n,Set(CONNECTEDLINE(name,i)=368 Voicemail)
exten => *368,n,Set(CONNECTEDLINE(num,i)=368)
exten => *368,n,Macro(vm,368,DIRECTDIAL,${IVR_RETVM})
exten => *368,n,Goto(vmret,1)

exten => *369,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *369,n,Set(CONNECTEDLINE(name,i)=369 Voicemail)
exten => *369,n,Set(CONNECTEDLINE(num,i)=369)
exten => *369,n,Macro(vm,369,DIRECTDIAL,${IVR_RETVM})
exten => *369,n,Goto(vmret,1)

exten => *370,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *370,n,Set(CONNECTEDLINE(name,i)=370 Voicemail)
exten => *370,n,Set(CONNECTEDLINE(num,i)=370)
exten => *370,n,Macro(vm,370,DIRECTDIAL,${IVR_RETVM})
exten => *370,n,Goto(vmret,1)

exten => *371,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *371,n,Set(CONNECTEDLINE(name,i)=371 Voicemail)
exten => *371,n,Set(CONNECTEDLINE(num,i)=371)
exten => *371,n,Macro(vm,371,DIRECTDIAL,${IVR_RETVM})
exten => *371,n,Goto(vmret,1)

exten => *372,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *372,n,Set(CONNECTEDLINE(name,i)=372 Voicemail)
exten => *372,n,Set(CONNECTEDLINE(num,i)=372)
exten => *372,n,Macro(vm,372,DIRECTDIAL,${IVR_RETVM})
exten => *372,n,Goto(vmret,1)

exten => *373,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *373,n,Set(CONNECTEDLINE(name,i)=373 Voicemail)
exten => *373,n,Set(CONNECTEDLINE(num,i)=373)
exten => *373,n,Macro(vm,373,DIRECTDIAL,${IVR_RETVM})
exten => *373,n,Goto(vmret,1)

exten => *383,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *383,n,Set(CONNECTEDLINE(name,i)=383 Voicemail)
exten => *383,n,Set(CONNECTEDLINE(num,i)=383)
exten => *383,n,Macro(vm,383,DIRECTDIAL,${IVR_RETVM})
exten => *383,n,Goto(vmret,1)

exten => *384,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *384,n,Set(CONNECTEDLINE(name,i)=384 Voicemail)
exten => *384,n,Set(CONNECTEDLINE(num,i)=384)
exten => *384,n,Macro(vm,384,DIRECTDIAL,${IVR_RETVM})
exten => *384,n,Goto(vmret,1)

exten => *9999,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *9999,n,Set(CONNECTEDLINE(name,i)=9999 Voicemail)
exten => *9999,n,Set(CONNECTEDLINE(num,i)=9999)
exten => *9999,n,Macro(vm,9999,DIRECTDIAL,${IVR_RETVM})
exten => *9999,n,Goto(vmret,1)

exten => 100,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/100/ringtimer)}" > "0"]?${DB(AMPUSER/100/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 100,n,Macro(exten-vm,100,100,0,0,0)
exten => 100,n(dest),Set(__PICKUPMARK=)
exten => 100,n,Macro(vm,100,${DIALSTATUS},${IVR_RETVM})
exten => 100,n,Goto(vmret,1)
exten => 100,hint,&Custom:DND100,CustomPresence:100

exten => vmb100,1,Macro(vm,100,BUSY,${IVR_RETVM})
exten => vmb100,n,Goto(vmret,1)

exten => vmu100,1,Macro(vm,100,NOANSWER,${IVR_RETVM})
exten => vmu100,n,Goto(vmret,1)

exten => vms100,1,Macro(vm,100,NOMESSAGE,${IVR_RETVM})
exten => vms100,n,Goto(vmret,1)

exten => vmi100,1,Macro(vm,100,INSTRUCT,${IVR_RETVM})
exten => vmi100,n,Goto(vmret,1)

exten => 101,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/101/ringtimer)}" > "0"]?${DB(AMPUSER/101/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 101,n,Macro(exten-vm,novm,101,0,0,0)
exten => 101,n(dest),Set(__PICKUPMARK=)
exten => 101,n,Goto(${IVR_CONTEXT},return,1)
exten => 101,hint,SIP/201&Custom:DND101,CustomPresence:101

exten => 102,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/102/ringtimer)}" > "0"]?${DB(AMPUSER/102/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 102,n,Macro(exten-vm,102,102,0,0,0)
exten => 102,n(dest),Set(__PICKUPMARK=)
exten => 102,n,Macro(vm,102,${DIALSTATUS},${IVR_RETVM})
exten => 102,n,Goto(vmret,1)
exten => 102,hint,SIP/202&Custom:DND102,CustomPresence:102

exten => vmb102,1,Macro(vm,102,BUSY,${IVR_RETVM})
exten => vmb102,n,Goto(vmret,1)

exten => vmu102,1,Macro(vm,102,NOANSWER,${IVR_RETVM})
exten => vmu102,n,Goto(vmret,1)

exten => vms102,1,Macro(vm,102,NOMESSAGE,${IVR_RETVM})
exten => vms102,n,Goto(vmret,1)

exten => vmi102,1,Macro(vm,102,INSTRUCT,${IVR_RETVM})
exten => vmi102,n,Goto(vmret,1)

exten => 103,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/103/ringtimer)}" > "0"]?${DB(AMPUSER/103/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 103,n,Macro(exten-vm,novm,103,0,0,0)
exten => 103,n(dest),Set(__PICKUPMARK=)
exten => 103,n,Goto(${IVR_CONTEXT},return,1)
exten => 103,hint,SIP/203&Custom:DND103,CustomPresence:103

exten => 104,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/104/ringtimer)}" > "0"]?${DB(AMPUSER/104/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 104,n,Macro(exten-vm,novm,104,0,0,0)
exten => 104,n(dest),Set(__PICKUPMARK=)
exten => 104,n,Goto(${IVR_CONTEXT},return,1)
exten => 104,hint,SIP/204&Custom:DND104,CustomPresence:104

exten => 105,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/105/ringtimer)}" > "0"]?${DB(AMPUSER/105/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 105,n,Macro(exten-vm,105,105,0,0,0)
exten => 105,n(dest),Set(__PICKUPMARK=)
exten => 105,n,Macro(vm,105,${DIALSTATUS},${IVR_RETVM})
exten => 105,n,Goto(vmret,1)
exten => 105,hint,SIP/205&Custom:DND105,CustomPresence:105

exten => vmb105,1,Macro(vm,105,BUSY,${IVR_RETVM})
exten => vmb105,n,Goto(vmret,1)

exten => vmu105,1,Macro(vm,105,NOANSWER,${IVR_RETVM})
exten => vmu105,n,Goto(vmret,1)

exten => vms105,1,Macro(vm,105,NOMESSAGE,${IVR_RETVM})
exten => vms105,n,Goto(vmret,1)

exten => vmi105,1,Macro(vm,105,INSTRUCT,${IVR_RETVM})
exten => vmi105,n,Goto(vmret,1)

exten => 106,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/106/ringtimer)}" > "0"]?${DB(AMPUSER/106/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 106,n,Macro(exten-vm,106,106,0,0,0)
exten => 106,n(dest),Set(__PICKUPMARK=)
exten => 106,n,Macro(vm,106,${DIALSTATUS},${IVR_RETVM})
exten => 106,n,Goto(vmret,1)
exten => 106,hint,SIP/206&Custom:DND106,CustomPresence:106

exten => vmb106,1,Macro(vm,106,BUSY,${IVR_RETVM})
exten => vmb106,n,Goto(vmret,1)

exten => vmu106,1,Macro(vm,106,NOANSWER,${IVR_RETVM})
exten => vmu106,n,Goto(vmret,1)

exten => vms106,1,Macro(vm,106,NOMESSAGE,${IVR_RETVM})
exten => vms106,n,Goto(vmret,1)

exten => vmi106,1,Macro(vm,106,INSTRUCT,${IVR_RETVM})
exten => vmi106,n,Goto(vmret,1)

exten => 107,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/107/ringtimer)}" > "0"]?${DB(AMPUSER/107/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 107,n,Macro(exten-vm,107,107,0,0,0)
exten => 107,n(dest),Set(__PICKUPMARK=)
exten => 107,n,Macro(vm,107,${DIALSTATUS},${IVR_RETVM})
exten => 107,n,Goto(vmret,1)
exten => 107,hint,SIP/207&Custom:DND107,CustomPresence:107

exten => vmb107,1,Macro(vm,107,BUSY,${IVR_RETVM})
exten => vmb107,n,Goto(vmret,1)

exten => vmu107,1,Macro(vm,107,NOANSWER,${IVR_RETVM})
exten => vmu107,n,Goto(vmret,1)

exten => vms107,1,Macro(vm,107,NOMESSAGE,${IVR_RETVM})
exten => vms107,n,Goto(vmret,1)

exten => vmi107,1,Macro(vm,107,INSTRUCT,${IVR_RETVM})
exten => vmi107,n,Goto(vmret,1)

exten => 127,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/127/ringtimer)}" > "0"]?${DB(AMPUSER/127/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 127,n,Macro(exten-vm,127,127,0,0,0)
exten => 127,n(dest),Set(__PICKUPMARK=)
exten => 127,n,Macro(vm,127,${DIALSTATUS},${IVR_RETVM})
exten => 127,n,Goto(vmret,1)
exten => 127,hint,SIP/227&SIP/827&Custom:DND127,CustomPresence:127

exten => vmb127,1,Macro(vm,127,BUSY,${IVR_RETVM})
exten => vmb127,n,Goto(vmret,1)

exten => vmu127,1,Macro(vm,127,NOANSWER,${IVR_RETVM})
exten => vmu127,n,Goto(vmret,1)

exten => vms127,1,Macro(vm,127,NOMESSAGE,${IVR_RETVM})
exten => vms127,n,Goto(vmret,1)

exten => vmi127,1,Macro(vm,127,INSTRUCT,${IVR_RETVM})
exten => vmi127,n,Goto(vmret,1)

exten => 128,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/128/ringtimer)}" > "0"]?${DB(AMPUSER/128/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 128,n,Macro(exten-vm,novm,128,0,0,0)
exten => 128,n(dest),Set(__PICKUPMARK=)
exten => 128,n,Goto(${IVR_CONTEXT},return,1)
exten => 128,hint,SIP/228&Custom:DND128,CustomPresence:128

exten => 129,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/129/ringtimer)}" > "0"]?${DB(AMPUSER/129/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 129,n,Macro(exten-vm,129,129,0,0,0)
exten => 129,n(dest),Set(__PICKUPMARK=)
exten => 129,n,Macro(vm,129,${DIALSTATUS},${IVR_RETVM})
exten => 129,n,Goto(vmret,1)
exten => 129,hint,SIP/229&SIP/829&Custom:DND129,CustomPresence:129

exten => vmb129,1,Macro(vm,129,BUSY,${IVR_RETVM})
exten => vmb129,n,Goto(vmret,1)

exten => vmu129,1,Macro(vm,129,NOANSWER,${IVR_RETVM})
exten => vmu129,n,Goto(vmret,1)

exten => vms129,1,Macro(vm,129,NOMESSAGE,${IVR_RETVM})
exten => vms129,n,Goto(vmret,1)

exten => vmi129,1,Macro(vm,129,INSTRUCT,${IVR_RETVM})
exten => vmi129,n,Goto(vmret,1)

exten => 130,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/130/ringtimer)}" > "0"]?${DB(AMPUSER/130/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 130,n,Macro(exten-vm,130,130,1,1,1)
exten => 130,n(dest),Set(__PICKUPMARK=)
exten => 130,n,GotoIf($["${DIALSTATUS}"="NOANSWER"]?ext-local,vmu130,1)
exten => 130,n,GotoIf($["${DIALSTATUS}"="BUSY"]?ext-local,vmu130,1)
exten => 130,n,GotoIf($["${DIALSTATUS}"="CHANUNAVAIL"]?ext-local,vmu130,1)
exten => 130,n,Macro(vm,130,${DIALSTATUS},${IVR_RETVM})
exten => 130,n,Goto(vmret,1)
exten => 130,hint,SIP/230&Custom:DND130,CustomPresence:130

exten => vmb130,1,Macro(vm,130,BUSY,${IVR_RETVM})
exten => vmb130,n,Goto(vmret,1)

exten => vmu130,1,Macro(vm,130,NOANSWER,${IVR_RETVM})
exten => vmu130,n,Goto(vmret,1)

exten => vms130,1,Macro(vm,130,NOMESSAGE,${IVR_RETVM})
exten => vms130,n,Goto(vmret,1)

exten => vmi130,1,Macro(vm,130,INSTRUCT,${IVR_RETVM})
exten => vmi130,n,Goto(vmret,1)

exten => 131,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/131/ringtimer)}" > "0"]?${DB(AMPUSER/131/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 131,n,Macro(exten-vm,131,131,0,0,0)
exten => 131,n(dest),Set(__PICKUPMARK=)
exten => 131,n,Macro(vm,131,${DIALSTATUS},${IVR_RETVM})
exten => 131,n,Goto(vmret,1)
exten => 131,hint,SIP/231&Custom:DND131,CustomPresence:131

exten => vmb131,1,Macro(vm,131,BUSY,${IVR_RETVM})
exten => vmb131,n,Goto(vmret,1)

exten => vmu131,1,Macro(vm,131,NOANSWER,${IVR_RETVM})
exten => vmu131,n,Goto(vmret,1)

exten => vms131,1,Macro(vm,131,NOMESSAGE,${IVR_RETVM})
exten => vms131,n,Goto(vmret,1)

exten => vmi131,1,Macro(vm,131,INSTRUCT,${IVR_RETVM})
exten => vmi131,n,Goto(vmret,1)

exten => 132,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/132/ringtimer)}" > "0"]?${DB(AMPUSER/132/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 132,n,Macro(exten-vm,132,132,0,0,0)
exten => 132,n(dest),Set(__PICKUPMARK=)
exten => 132,n,Macro(vm,132,${DIALSTATUS},${IVR_RETVM})
exten => 132,n,Goto(vmret,1)
exten => 132,hint,SIP/232&Custom:DND132,CustomPresence:132

exten => vmb132,1,Macro(vm,132,BUSY,${IVR_RETVM})
exten => vmb132,n,Goto(vmret,1)

exten => vmu132,1,Macro(vm,132,NOANSWER,${IVR_RETVM})
exten => vmu132,n,Goto(vmret,1)

exten => vms132,1,Macro(vm,132,NOMESSAGE,${IVR_RETVM})
exten => vms132,n,Goto(vmret,1)

exten => vmi132,1,Macro(vm,132,INSTRUCT,${IVR_RETVM})
exten => vmi132,n,Goto(vmret,1)

exten => 133,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/133/ringtimer)}" > "0"]?${DB(AMPUSER/133/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 133,n,Macro(exten-vm,133,133,0,0,0)
exten => 133,n(dest),Set(__PICKUPMARK=)
exten => 133,n,Macro(vm,133,${DIALSTATUS},${IVR_RETVM})
exten => 133,n,Goto(vmret,1)
exten => 133,hint,SIP/233&Custom:DND133,CustomPresence:133

exten => vmb133,1,Macro(vm,133,BUSY,${IVR_RETVM})
exten => vmb133,n,Goto(vmret,1)

exten => vmu133,1,Macro(vm,133,NOANSWER,${IVR_RETVM})
exten => vmu133,n,Goto(vmret,1)

exten => vms133,1,Macro(vm,133,NOMESSAGE,${IVR_RETVM})
exten => vms133,n,Goto(vmret,1)

exten => vmi133,1,Macro(vm,133,INSTRUCT,${IVR_RETVM})
exten => vmi133,n,Goto(vmret,1)

exten => 134,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/134/ringtimer)}" > "0"]?${DB(AMPUSER/134/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 134,n,Macro(exten-vm,134,134,1,1,1)
exten => 134,n(dest),Set(__PICKUPMARK=)
exten => 134,n,GotoIf($["${DIALSTATUS}"="NOANSWER"]?from-did-direct,130,1)
exten => 134,n,GotoIf($["${DIALSTATUS}"="BUSY"]?from-did-direct,130,1)
exten => 134,n,GotoIf($["${DIALSTATUS}"="CHANUNAVAIL"]?from-did-direct,130,1)
exten => 134,n,Macro(vm,134,${DIALSTATUS},${IVR_RETVM})
exten => 134,n,Goto(vmret,1)
exten => 134,hint,SIP/234&Custom:DND134,CustomPresence:134

exten => vmb134,1,Macro(vm,134,BUSY,${IVR_RETVM})
exten => vmb134,n,Goto(vmret,1)

exten => vmu134,1,Macro(vm,134,NOANSWER,${IVR_RETVM})
exten => vmu134,n,Goto(vmret,1)

exten => vms134,1,Macro(vm,134,NOMESSAGE,${IVR_RETVM})
exten => vms134,n,Goto(vmret,1)

exten => vmi134,1,Macro(vm,134,INSTRUCT,${IVR_RETVM})
exten => vmi134,n,Goto(vmret,1)

exten => 135,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/135/ringtimer)}" > "0"]?${DB(AMPUSER/135/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 135,n,Macro(exten-vm,135,135,0,0,0)
exten => 135,n(dest),Set(__PICKUPMARK=)
exten => 135,n,Macro(vm,135,${DIALSTATUS},${IVR_RETVM})
exten => 135,n,Goto(vmret,1)
exten => 135,hint,SIP/235&SIP/835&Custom:DND135,CustomPresence:135

exten => vmb135,1,Macro(vm,135,BUSY,${IVR_RETVM})
exten => vmb135,n,Goto(vmret,1)

exten => vmu135,1,Macro(vm,135,NOANSWER,${IVR_RETVM})
exten => vmu135,n,Goto(vmret,1)

exten => vms135,1,Macro(vm,135,NOMESSAGE,${IVR_RETVM})
exten => vms135,n,Goto(vmret,1)

exten => vmi135,1,Macro(vm,135,INSTRUCT,${IVR_RETVM})
exten => vmi135,n,Goto(vmret,1)

exten => 136,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/136/ringtimer)}" > "0"]?${DB(AMPUSER/136/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 136,n,Macro(exten-vm,136,136,0,0,0)
exten => 136,n(dest),Set(__PICKUPMARK=)
exten => 136,n,Macro(vm,136,${DIALSTATUS},${IVR_RETVM})
exten => 136,n,Goto(vmret,1)
exten => 136,hint,SIP/236&Custom:DND136,CustomPresence:136

exten => vmb136,1,Macro(vm,136,BUSY,${IVR_RETVM})
exten => vmb136,n,Goto(vmret,1)

exten => vmu136,1,Macro(vm,136,NOANSWER,${IVR_RETVM})
exten => vmu136,n,Goto(vmret,1)

exten => vms136,1,Macro(vm,136,NOMESSAGE,${IVR_RETVM})
exten => vms136,n,Goto(vmret,1)

exten => vmi136,1,Macro(vm,136,INSTRUCT,${IVR_RETVM})
exten => vmi136,n,Goto(vmret,1)

exten => 137,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/137/ringtimer)}" > "0"]?${DB(AMPUSER/137/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 137,n,Macro(exten-vm,137,137,0,0,0)
exten => 137,n(dest),Set(__PICKUPMARK=)
exten => 137,n,Macro(vm,137,${DIALSTATUS},${IVR_RETVM})
exten => 137,n,Goto(vmret,1)
exten => 137,hint,SIP/237&Custom:DND137,CustomPresence:137

exten => vmb137,1,Macro(vm,137,BUSY,${IVR_RETVM})
exten => vmb137,n,Goto(vmret,1)

exten => vmu137,1,Macro(vm,137,NOANSWER,${IVR_RETVM})
exten => vmu137,n,Goto(vmret,1)

exten => vms137,1,Macro(vm,137,NOMESSAGE,${IVR_RETVM})
exten => vms137,n,Goto(vmret,1)

exten => vmi137,1,Macro(vm,137,INSTRUCT,${IVR_RETVM})
exten => vmi137,n,Goto(vmret,1)

exten => 138,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/138/ringtimer)}" > "0"]?${DB(AMPUSER/138/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 138,n,Macro(exten-vm,138,138,0,0,0)
exten => 138,n(dest),Set(__PICKUPMARK=)
exten => 138,n,Macro(vm,138,${DIALSTATUS},${IVR_RETVM})
exten => 138,n,Goto(vmret,1)
exten => 138,hint,SIP/238&SIP/838&Custom:DND138,CustomPresence:138

exten => vmb138,1,Macro(vm,138,BUSY,${IVR_RETVM})
exten => vmb138,n,Goto(vmret,1)

exten => vmu138,1,Macro(vm,138,NOANSWER,${IVR_RETVM})
exten => vmu138,n,Goto(vmret,1)

exten => vms138,1,Macro(vm,138,NOMESSAGE,${IVR_RETVM})
exten => vms138,n,Goto(vmret,1)

exten => vmi138,1,Macro(vm,138,INSTRUCT,${IVR_RETVM})
exten => vmi138,n,Goto(vmret,1)

exten => 139,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/139/ringtimer)}" > "0"]?${DB(AMPUSER/139/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 139,n,Macro(exten-vm,139,139,0,0,0)
exten => 139,n(dest),Set(__PICKUPMARK=)
exten => 139,n,Macro(vm,139,${DIALSTATUS},${IVR_RETVM})
exten => 139,n,Goto(vmret,1)
exten => 139,hint,SIP/239&SIP/339&Custom:DND139,CustomPresence:139

exten => vmb139,1,Macro(vm,139,BUSY,${IVR_RETVM})
exten => vmb139,n,Goto(vmret,1)

exten => vmu139,1,Macro(vm,139,NOANSWER,${IVR_RETVM})
exten => vmu139,n,Goto(vmret,1)

exten => vms139,1,Macro(vm,139,NOMESSAGE,${IVR_RETVM})
exten => vms139,n,Goto(vmret,1)

exten => vmi139,1,Macro(vm,139,INSTRUCT,${IVR_RETVM})
exten => vmi139,n,Goto(vmret,1)

exten => 140,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/140/ringtimer)}" > "0"]?${DB(AMPUSER/140/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 140,n,Macro(exten-vm,140,140,0,0,0)
exten => 140,n(dest),Set(__PICKUPMARK=)
exten => 140,n,Macro(vm,140,${DIALSTATUS},${IVR_RETVM})
exten => 140,n,Goto(vmret,1)
exten => 140,hint,SIP/240&SIP/840&Custom:DND140,CustomPresence:140

exten => vmb140,1,Macro(vm,140,BUSY,${IVR_RETVM})
exten => vmb140,n,Goto(vmret,1)

exten => vmu140,1,Macro(vm,140,NOANSWER,${IVR_RETVM})
exten => vmu140,n,Goto(vmret,1)

exten => vms140,1,Macro(vm,140,NOMESSAGE,${IVR_RETVM})
exten => vms140,n,Goto(vmret,1)

exten => vmi140,1,Macro(vm,140,INSTRUCT,${IVR_RETVM})
exten => vmi140,n,Goto(vmret,1)

exten => 141,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/141/ringtimer)}" > "0"]?${DB(AMPUSER/141/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 141,n,Macro(exten-vm,141,141,0,0,0)
exten => 141,n(dest),Set(__PICKUPMARK=)
exten => 141,n,Macro(vm,141,${DIALSTATUS},${IVR_RETVM})
exten => 141,n,Goto(vmret,1)
exten => 141,hint,SIP/241&Custom:DND141,CustomPresence:141

exten => vmb141,1,Macro(vm,141,BUSY,${IVR_RETVM})
exten => vmb141,n,Goto(vmret,1)

exten => vmu141,1,Macro(vm,141,NOANSWER,${IVR_RETVM})
exten => vmu141,n,Goto(vmret,1)

exten => vms141,1,Macro(vm,141,NOMESSAGE,${IVR_RETVM})
exten => vms141,n,Goto(vmret,1)

exten => vmi141,1,Macro(vm,141,INSTRUCT,${IVR_RETVM})
exten => vmi141,n,Goto(vmret,1)

exten => 142,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/142/ringtimer)}" > "0"]?${DB(AMPUSER/142/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 142,n,Macro(exten-vm,142,142,0,0,0)
exten => 142,n(dest),Set(__PICKUPMARK=)
exten => 142,n,Macro(vm,142,${DIALSTATUS},${IVR_RETVM})
exten => 142,n,Goto(vmret,1)
exten => 142,hint,SIP/242&Custom:DND142,CustomPresence:142

exten => vmb142,1,Macro(vm,142,BUSY,${IVR_RETVM})
exten => vmb142,n,Goto(vmret,1)

exten => vmu142,1,Macro(vm,142,NOANSWER,${IVR_RETVM})
exten => vmu142,n,Goto(vmret,1)

exten => vms142,1,Macro(vm,142,NOMESSAGE,${IVR_RETVM})
exten => vms142,n,Goto(vmret,1)

exten => vmi142,1,Macro(vm,142,INSTRUCT,${IVR_RETVM})
exten => vmi142,n,Goto(vmret,1)

exten => 143,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/143/ringtimer)}" > "0"]?${DB(AMPUSER/143/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 143,n,Macro(exten-vm,novm,143,0,0,0)
exten => 143,n(dest),Set(__PICKUPMARK=)
exten => 143,n,Goto(${IVR_CONTEXT},return,1)
exten => 143,hint,SIP/243&Custom:DND143,CustomPresence:143

exten => 144,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/144/ringtimer)}" > "0"]?${DB(AMPUSER/144/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 144,n,Macro(exten-vm,144,144,0,0,0)
exten => 144,n(dest),Set(__PICKUPMARK=)
exten => 144,n,Macro(vm,144,${DIALSTATUS},${IVR_RETVM})
exten => 144,n,Goto(vmret,1)
exten => 144,hint,SIP/244&Custom:DND144,CustomPresence:144

exten => vmb144,1,Macro(vm,144,BUSY,${IVR_RETVM})
exten => vmb144,n,Goto(vmret,1)

exten => vmu144,1,Macro(vm,144,NOANSWER,${IVR_RETVM})
exten => vmu144,n,Goto(vmret,1)

exten => vms144,1,Macro(vm,144,NOMESSAGE,${IVR_RETVM})
exten => vms144,n,Goto(vmret,1)

exten => vmi144,1,Macro(vm,144,INSTRUCT,${IVR_RETVM})
exten => vmi144,n,Goto(vmret,1)

exten => 145,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/145/ringtimer)}" > "0"]?${DB(AMPUSER/145/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 145,n,Macro(exten-vm,145,145,0,0,0)
exten => 145,n(dest),Set(__PICKUPMARK=)
exten => 145,n,Macro(vm,145,${DIALSTATUS},${IVR_RETVM})
exten => 145,n,Goto(vmret,1)
exten => 145,hint,SIP/245&SIP/845&Custom:DND145,CustomPresence:145

exten => vmb145,1,Macro(vm,145,BUSY,${IVR_RETVM})
exten => vmb145,n,Goto(vmret,1)

exten => vmu145,1,Macro(vm,145,NOANSWER,${IVR_RETVM})
exten => vmu145,n,Goto(vmret,1)

exten => vms145,1,Macro(vm,145,NOMESSAGE,${IVR_RETVM})
exten => vms145,n,Goto(vmret,1)

exten => vmi145,1,Macro(vm,145,INSTRUCT,${IVR_RETVM})
exten => vmi145,n,Goto(vmret,1)

exten => 146,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/146/ringtimer)}" > "0"]?${DB(AMPUSER/146/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 146,n,Macro(exten-vm,146,146,0,0,0)
exten => 146,n(dest),Set(__PICKUPMARK=)
exten => 146,n,Macro(vm,146,${DIALSTATUS},${IVR_RETVM})
exten => 146,n,Goto(vmret,1)
exten => 146,hint,SIP/246&Custom:DND146,CustomPresence:146

exten => vmb146,1,Macro(vm,146,BUSY,${IVR_RETVM})
exten => vmb146,n,Goto(vmret,1)

exten => vmu146,1,Macro(vm,146,NOANSWER,${IVR_RETVM})
exten => vmu146,n,Goto(vmret,1)

exten => vms146,1,Macro(vm,146,NOMESSAGE,${IVR_RETVM})
exten => vms146,n,Goto(vmret,1)

exten => vmi146,1,Macro(vm,146,INSTRUCT,${IVR_RETVM})
exten => vmi146,n,Goto(vmret,1)

exten => 147,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/147/ringtimer)}" > "0"]?${DB(AMPUSER/147/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 147,n,Macro(exten-vm,147,147,0,0,0)
exten => 147,n(dest),Set(__PICKUPMARK=)
exten => 147,n,Macro(vm,147,${DIALSTATUS},${IVR_RETVM})
exten => 147,n,Goto(vmret,1)
exten => 147,hint,SIP/247&SIP/847&Custom:DND147,CustomPresence:147

exten => vmb147,1,Macro(vm,147,BUSY,${IVR_RETVM})
exten => vmb147,n,Goto(vmret,1)

exten => vmu147,1,Macro(vm,147,NOANSWER,${IVR_RETVM})
exten => vmu147,n,Goto(vmret,1)

exten => vms147,1,Macro(vm,147,NOMESSAGE,${IVR_RETVM})
exten => vms147,n,Goto(vmret,1)

exten => vmi147,1,Macro(vm,147,INSTRUCT,${IVR_RETVM})
exten => vmi147,n,Goto(vmret,1)

exten => 148,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/148/ringtimer)}" > "0"]?${DB(AMPUSER/148/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 148,n,Macro(exten-vm,148,148,0,0,0)
exten => 148,n(dest),Set(__PICKUPMARK=)
exten => 148,n,Macro(vm,148,${DIALSTATUS},${IVR_RETVM})
exten => 148,n,Goto(vmret,1)
exten => 148,hint,SIP/248&SIP/848&Custom:DND148,CustomPresence:148

exten => vmb148,1,Macro(vm,148,BUSY,${IVR_RETVM})
exten => vmb148,n,Goto(vmret,1)

exten => vmu148,1,Macro(vm,148,NOANSWER,${IVR_RETVM})
exten => vmu148,n,Goto(vmret,1)

exten => vms148,1,Macro(vm,148,NOMESSAGE,${IVR_RETVM})
exten => vms148,n,Goto(vmret,1)

exten => vmi148,1,Macro(vm,148,INSTRUCT,${IVR_RETVM})
exten => vmi148,n,Goto(vmret,1)

exten => 149,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/149/ringtimer)}" > "0"]?${DB(AMPUSER/149/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 149,n,Macro(exten-vm,149,149,0,0,0)
exten => 149,n(dest),Set(__PICKUPMARK=)
exten => 149,n,Macro(vm,149,${DIALSTATUS},${IVR_RETVM})
exten => 149,n,Goto(vmret,1)
exten => 149,hint,SIP/249&Custom:DND149,CustomPresence:149

exten => vmb149,1,Macro(vm,149,BUSY,${IVR_RETVM})
exten => vmb149,n,Goto(vmret,1)

exten => vmu149,1,Macro(vm,149,NOANSWER,${IVR_RETVM})
exten => vmu149,n,Goto(vmret,1)

exten => vms149,1,Macro(vm,149,NOMESSAGE,${IVR_RETVM})
exten => vms149,n,Goto(vmret,1)

exten => vmi149,1,Macro(vm,149,INSTRUCT,${IVR_RETVM})
exten => vmi149,n,Goto(vmret,1)

exten => 150,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/150/ringtimer)}" > "0"]?${DB(AMPUSER/150/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 150,n,Macro(exten-vm,novm,150,0,0,0)
exten => 150,n(dest),Set(__PICKUPMARK=)
exten => 150,n,Goto(${IVR_CONTEXT},return,1)
exten => 150,hint,SIP/450&Custom:DND150,CustomPresence:150

exten => 152,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/152/ringtimer)}" > "0"]?${DB(AMPUSER/152/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 152,n,Macro(exten-vm,152,152,0,0,0)
exten => 152,n(dest),Set(__PICKUPMARK=)
exten => 152,n,Macro(vm,152,${DIALSTATUS},${IVR_RETVM})
exten => 152,n,Goto(vmret,1)
exten => 152,hint,SIP/285&Custom:DND152,CustomPresence:152

exten => vmb152,1,Macro(vm,152,BUSY,${IVR_RETVM})
exten => vmb152,n,Goto(vmret,1)

exten => vmu152,1,Macro(vm,152,NOANSWER,${IVR_RETVM})
exten => vmu152,n,Goto(vmret,1)

exten => vms152,1,Macro(vm,152,NOMESSAGE,${IVR_RETVM})
exten => vms152,n,Goto(vmret,1)

exten => vmi152,1,Macro(vm,152,INSTRUCT,${IVR_RETVM})
exten => vmi152,n,Goto(vmret,1)

exten => 350,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/350/ringtimer)}" > "0"]?${DB(AMPUSER/350/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 350,n,Macro(exten-vm,350,350,0,0,0)
exten => 350,n(dest),Set(__PICKUPMARK=)
exten => 350,n,Macro(vm,350,${DIALSTATUS},${IVR_RETVM})
exten => 350,n,Goto(vmret,1)
exten => 350,hint,SIP/250&Custom:DND350,CustomPresence:350

exten => vmb350,1,Macro(vm,350,BUSY,${IVR_RETVM})
exten => vmb350,n,Goto(vmret,1)

exten => vmu350,1,Macro(vm,350,NOANSWER,${IVR_RETVM})
exten => vmu350,n,Goto(vmret,1)

exten => vms350,1,Macro(vm,350,NOMESSAGE,${IVR_RETVM})
exten => vms350,n,Goto(vmret,1)

exten => vmi350,1,Macro(vm,350,INSTRUCT,${IVR_RETVM})
exten => vmi350,n,Goto(vmret,1)

exten => 351,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/351/ringtimer)}" > "0"]?${DB(AMPUSER/351/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 351,n,Macro(exten-vm,351,351,0,0,0)
exten => 351,n(dest),Set(__PICKUPMARK=)
exten => 351,n,Macro(vm,351,${DIALSTATUS},${IVR_RETVM})
exten => 351,n,Goto(vmret,1)
exten => 351,hint,SIP/251&Custom:DND351,CustomPresence:351

exten => vmb351,1,Macro(vm,351,BUSY,${IVR_RETVM})
exten => vmb351,n,Goto(vmret,1)

exten => vmu351,1,Macro(vm,351,NOANSWER,${IVR_RETVM})
exten => vmu351,n,Goto(vmret,1)

exten => vms351,1,Macro(vm,351,NOMESSAGE,${IVR_RETVM})
exten => vms351,n,Goto(vmret,1)

exten => vmi351,1,Macro(vm,351,INSTRUCT,${IVR_RETVM})
exten => vmi351,n,Goto(vmret,1)

exten => 352,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/352/ringtimer)}" > "0"]?${DB(AMPUSER/352/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 352,n,Macro(exten-vm,352,352,0,0,0)
exten => 352,n(dest),Set(__PICKUPMARK=)
exten => 352,n,Macro(vm,352,${DIALSTATUS},${IVR_RETVM})
exten => 352,n,Goto(vmret,1)
exten => 352,hint,SIP/252&SIP/852&Custom:DND352,CustomPresence:352

exten => vmb352,1,Macro(vm,352,BUSY,${IVR_RETVM})
exten => vmb352,n,Goto(vmret,1)

exten => vmu352,1,Macro(vm,352,NOANSWER,${IVR_RETVM})
exten => vmu352,n,Goto(vmret,1)

exten => vms352,1,Macro(vm,352,NOMESSAGE,${IVR_RETVM})
exten => vms352,n,Goto(vmret,1)

exten => vmi352,1,Macro(vm,352,INSTRUCT,${IVR_RETVM})
exten => vmi352,n,Goto(vmret,1)

exten => 353,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/353/ringtimer)}" > "0"]?${DB(AMPUSER/353/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 353,n,Macro(exten-vm,353,353,0,0,0)
exten => 353,n(dest),Set(__PICKUPMARK=)
exten => 353,n,Macro(vm,353,${DIALSTATUS},${IVR_RETVM})
exten => 353,n,Goto(vmret,1)
exten => 353,hint,SIP/253&Custom:DND353,CustomPresence:353

exten => vmb353,1,Macro(vm,353,BUSY,${IVR_RETVM})
exten => vmb353,n,Goto(vmret,1)

exten => vmu353,1,Macro(vm,353,NOANSWER,${IVR_RETVM})
exten => vmu353,n,Goto(vmret,1)

exten => vms353,1,Macro(vm,353,NOMESSAGE,${IVR_RETVM})
exten => vms353,n,Goto(vmret,1)

exten => vmi353,1,Macro(vm,353,INSTRUCT,${IVR_RETVM})
exten => vmi353,n,Goto(vmret,1)

exten => 354,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/354/ringtimer)}" > "0"]?${DB(AMPUSER/354/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 354,n,Macro(exten-vm,354,354,0,0,0)
exten => 354,n(dest),Set(__PICKUPMARK=)
exten => 354,n,Macro(vm,354,${DIALSTATUS},${IVR_RETVM})
exten => 354,n,Goto(vmret,1)
exten => 354,hint,SIP/254&Custom:DND354,CustomPresence:354

exten => vmb354,1,Macro(vm,354,BUSY,${IVR_RETVM})
exten => vmb354,n,Goto(vmret,1)

exten => vmu354,1,Macro(vm,354,NOANSWER,${IVR_RETVM})
exten => vmu354,n,Goto(vmret,1)

exten => vms354,1,Macro(vm,354,NOMESSAGE,${IVR_RETVM})
exten => vms354,n,Goto(vmret,1)

exten => vmi354,1,Macro(vm,354,INSTRUCT,${IVR_RETVM})
exten => vmi354,n,Goto(vmret,1)

exten => 355,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/355/ringtimer)}" > "0"]?${DB(AMPUSER/355/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 355,n,Macro(exten-vm,355,355,0,0,0)
exten => 355,n(dest),Set(__PICKUPMARK=)
exten => 355,n,Macro(vm,355,${DIALSTATUS},${IVR_RETVM})
exten => 355,n,Goto(vmret,1)
exten => 355,hint,SIP/255&Custom:DND355,CustomPresence:355

exten => vmb355,1,Macro(vm,355,BUSY,${IVR_RETVM})
exten => vmb355,n,Goto(vmret,1)

exten => vmu355,1,Macro(vm,355,NOANSWER,${IVR_RETVM})
exten => vmu355,n,Goto(vmret,1)

exten => vms355,1,Macro(vm,355,NOMESSAGE,${IVR_RETVM})
exten => vms355,n,Goto(vmret,1)

exten => vmi355,1,Macro(vm,355,INSTRUCT,${IVR_RETVM})
exten => vmi355,n,Goto(vmret,1)

exten => 356,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/356/ringtimer)}" > "0"]?${DB(AMPUSER/356/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 356,n,Macro(exten-vm,356,356,0,0,0)
exten => 356,n(dest),Set(__PICKUPMARK=)
exten => 356,n,Macro(vm,356,${DIALSTATUS},${IVR_RETVM})
exten => 356,n,Goto(vmret,1)
exten => 356,hint,SIP/256&Custom:DND356,CustomPresence:356

exten => vmb356,1,Macro(vm,356,BUSY,${IVR_RETVM})
exten => vmb356,n,Goto(vmret,1)

exten => vmu356,1,Macro(vm,356,NOANSWER,${IVR_RETVM})
exten => vmu356,n,Goto(vmret,1)

exten => vms356,1,Macro(vm,356,NOMESSAGE,${IVR_RETVM})
exten => vms356,n,Goto(vmret,1)

exten => vmi356,1,Macro(vm,356,INSTRUCT,${IVR_RETVM})
exten => vmi356,n,Goto(vmret,1)

exten => 357,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/357/ringtimer)}" > "0"]?${DB(AMPUSER/357/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 357,n,Macro(exten-vm,357,357,0,0,0)
exten => 357,n(dest),Set(__PICKUPMARK=)
exten => 357,n,Macro(vm,357,${DIALSTATUS},${IVR_RETVM})
exten => 357,n,Goto(vmret,1)
exten => 357,hint,SIP/257&Custom:DND357,CustomPresence:357

exten => vmb357,1,Macro(vm,357,BUSY,${IVR_RETVM})
exten => vmb357,n,Goto(vmret,1)

exten => vmu357,1,Macro(vm,357,NOANSWER,${IVR_RETVM})
exten => vmu357,n,Goto(vmret,1)

exten => vms357,1,Macro(vm,357,NOMESSAGE,${IVR_RETVM})
exten => vms357,n,Goto(vmret,1)

exten => vmi357,1,Macro(vm,357,INSTRUCT,${IVR_RETVM})
exten => vmi357,n,Goto(vmret,1)

exten => 358,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/358/ringtimer)}" > "0"]?${DB(AMPUSER/358/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 358,n,Macro(exten-vm,358,358,0,0,0)
exten => 358,n(dest),Set(__PICKUPMARK=)
exten => 358,n,Macro(vm,358,${DIALSTATUS},${IVR_RETVM})
exten => 358,n,Goto(vmret,1)
exten => 358,hint,SIP/258&Custom:DND358,CustomPresence:358

exten => vmb358,1,Macro(vm,358,BUSY,${IVR_RETVM})
exten => vmb358,n,Goto(vmret,1)

exten => vmu358,1,Macro(vm,358,NOANSWER,${IVR_RETVM})
exten => vmu358,n,Goto(vmret,1)

exten => vms358,1,Macro(vm,358,NOMESSAGE,${IVR_RETVM})
exten => vms358,n,Goto(vmret,1)

exten => vmi358,1,Macro(vm,358,INSTRUCT,${IVR_RETVM})
exten => vmi358,n,Goto(vmret,1)

exten => 359,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/359/ringtimer)}" > "0"]?${DB(AMPUSER/359/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 359,n,Macro(exten-vm,359,359,0,0,0)
exten => 359,n(dest),Set(__PICKUPMARK=)
exten => 359,n,Macro(vm,359,${DIALSTATUS},${IVR_RETVM})
exten => 359,n,Goto(vmret,1)
exten => 359,hint,SIP/259&Custom:DND359,CustomPresence:359

exten => vmb359,1,Macro(vm,359,BUSY,${IVR_RETVM})
exten => vmb359,n,Goto(vmret,1)

exten => vmu359,1,Macro(vm,359,NOANSWER,${IVR_RETVM})
exten => vmu359,n,Goto(vmret,1)

exten => vms359,1,Macro(vm,359,NOMESSAGE,${IVR_RETVM})
exten => vms359,n,Goto(vmret,1)

exten => vmi359,1,Macro(vm,359,INSTRUCT,${IVR_RETVM})
exten => vmi359,n,Goto(vmret,1)

exten => 360,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/360/ringtimer)}" > "0"]?${DB(AMPUSER/360/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 360,n,Macro(exten-vm,360,360,0,0,0)
exten => 360,n(dest),Set(__PICKUPMARK=)
exten => 360,n,Macro(vm,360,${DIALSTATUS},${IVR_RETVM})
exten => 360,n,Goto(vmret,1)
exten => 360,hint,SIP/260&Custom:DND360,CustomPresence:360

exten => vmb360,1,Macro(vm,360,BUSY,${IVR_RETVM})
exten => vmb360,n,Goto(vmret,1)

exten => vmu360,1,Macro(vm,360,NOANSWER,${IVR_RETVM})
exten => vmu360,n,Goto(vmret,1)

exten => vms360,1,Macro(vm,360,NOMESSAGE,${IVR_RETVM})
exten => vms360,n,Goto(vmret,1)

exten => vmi360,1,Macro(vm,360,INSTRUCT,${IVR_RETVM})
exten => vmi360,n,Goto(vmret,1)

exten => 361,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/361/ringtimer)}" > "0"]?${DB(AMPUSER/361/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 361,n,Macro(exten-vm,361,361,0,0,0)
exten => 361,n(dest),Set(__PICKUPMARK=)
exten => 361,n,Macro(vm,361,${DIALSTATUS},${IVR_RETVM})
exten => 361,n,Goto(vmret,1)
exten => 361,hint,SIP/261&Custom:DND361,CustomPresence:361

exten => vmb361,1,Macro(vm,361,BUSY,${IVR_RETVM})
exten => vmb361,n,Goto(vmret,1)

exten => vmu361,1,Macro(vm,361,NOANSWER,${IVR_RETVM})
exten => vmu361,n,Goto(vmret,1)

exten => vms361,1,Macro(vm,361,NOMESSAGE,${IVR_RETVM})
exten => vms361,n,Goto(vmret,1)

exten => vmi361,1,Macro(vm,361,INSTRUCT,${IVR_RETVM})
exten => vmi361,n,Goto(vmret,1)

exten => 362,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/362/ringtimer)}" > "0"]?${DB(AMPUSER/362/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 362,n,Macro(exten-vm,362,362,0,0,0)
exten => 362,n(dest),Set(__PICKUPMARK=)
exten => 362,n,Macro(vm,362,${DIALSTATUS},${IVR_RETVM})
exten => 362,n,Goto(vmret,1)
exten => 362,hint,SIP/262&Custom:DND362,CustomPresence:362

exten => vmb362,1,Macro(vm,362,BUSY,${IVR_RETVM})
exten => vmb362,n,Goto(vmret,1)

exten => vmu362,1,Macro(vm,362,NOANSWER,${IVR_RETVM})
exten => vmu362,n,Goto(vmret,1)

exten => vms362,1,Macro(vm,362,NOMESSAGE,${IVR_RETVM})
exten => vms362,n,Goto(vmret,1)

exten => vmi362,1,Macro(vm,362,INSTRUCT,${IVR_RETVM})
exten => vmi362,n,Goto(vmret,1)

exten => 363,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/363/ringtimer)}" > "0"]?${DB(AMPUSER/363/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 363,n,Macro(exten-vm,363,363,0,0,0)
exten => 363,n(dest),Set(__PICKUPMARK=)
exten => 363,n,Macro(vm,363,${DIALSTATUS},${IVR_RETVM})
exten => 363,n,Goto(vmret,1)
exten => 363,hint,SIP/263&Custom:DND363,CustomPresence:363

exten => vmb363,1,Macro(vm,363,BUSY,${IVR_RETVM})
exten => vmb363,n,Goto(vmret,1)

exten => vmu363,1,Macro(vm,363,NOANSWER,${IVR_RETVM})
exten => vmu363,n,Goto(vmret,1)

exten => vms363,1,Macro(vm,363,NOMESSAGE,${IVR_RETVM})
exten => vms363,n,Goto(vmret,1)

exten => vmi363,1,Macro(vm,363,INSTRUCT,${IVR_RETVM})
exten => vmi363,n,Goto(vmret,1)

exten => 364,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/364/ringtimer)}" > "0"]?${DB(AMPUSER/364/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 364,n,Macro(exten-vm,364,364,0,0,0)
exten => 364,n(dest),Set(__PICKUPMARK=)
exten => 364,n,Macro(vm,364,${DIALSTATUS},${IVR_RETVM})
exten => 364,n,Goto(vmret,1)
exten => 364,hint,SIP/264&Custom:DND364,CustomPresence:364

exten => vmb364,1,Macro(vm,364,BUSY,${IVR_RETVM})
exten => vmb364,n,Goto(vmret,1)

exten => vmu364,1,Macro(vm,364,NOANSWER,${IVR_RETVM})
exten => vmu364,n,Goto(vmret,1)

exten => vms364,1,Macro(vm,364,NOMESSAGE,${IVR_RETVM})
exten => vms364,n,Goto(vmret,1)

exten => vmi364,1,Macro(vm,364,INSTRUCT,${IVR_RETVM})
exten => vmi364,n,Goto(vmret,1)

exten => 365,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/365/ringtimer)}" > "0"]?${DB(AMPUSER/365/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 365,n,Macro(exten-vm,365,365,0,0,0)
exten => 365,n(dest),Set(__PICKUPMARK=)
exten => 365,n,Macro(vm,365,${DIALSTATUS},${IVR_RETVM})
exten => 365,n,Goto(vmret,1)
exten => 365,hint,SIP/265&Custom:DND365,CustomPresence:365

exten => vmb365,1,Macro(vm,365,BUSY,${IVR_RETVM})
exten => vmb365,n,Goto(vmret,1)

exten => vmu365,1,Macro(vm,365,NOANSWER,${IVR_RETVM})
exten => vmu365,n,Goto(vmret,1)

exten => vms365,1,Macro(vm,365,NOMESSAGE,${IVR_RETVM})
exten => vms365,n,Goto(vmret,1)

exten => vmi365,1,Macro(vm,365,INSTRUCT,${IVR_RETVM})
exten => vmi365,n,Goto(vmret,1)

exten => 366,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/366/ringtimer)}" > "0"]?${DB(AMPUSER/366/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 366,n,Macro(exten-vm,366,366,0,0,0)
exten => 366,n(dest),Set(__PICKUPMARK=)
exten => 366,n,Macro(vm,366,${DIALSTATUS},${IVR_RETVM})
exten => 366,n,Goto(vmret,1)
exten => 366,hint,SIP/266&Custom:DND366,CustomPresence:366

exten => vmb366,1,Macro(vm,366,BUSY,${IVR_RETVM})
exten => vmb366,n,Goto(vmret,1)

exten => vmu366,1,Macro(vm,366,NOANSWER,${IVR_RETVM})
exten => vmu366,n,Goto(vmret,1)

exten => vms366,1,Macro(vm,366,NOMESSAGE,${IVR_RETVM})
exten => vms366,n,Goto(vmret,1)

exten => vmi366,1,Macro(vm,366,INSTRUCT,${IVR_RETVM})
exten => vmi366,n,Goto(vmret,1)

exten => 367,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/367/ringtimer)}" > "0"]?${DB(AMPUSER/367/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 367,n,Macro(exten-vm,367,367,0,0,0)
exten => 367,n(dest),Set(__PICKUPMARK=)
exten => 367,n,Macro(vm,367,${DIALSTATUS},${IVR_RETVM})
exten => 367,n,Goto(vmret,1)
exten => 367,hint,SIP/267&Custom:DND367,CustomPresence:367

exten => vmb367,1,Macro(vm,367,BUSY,${IVR_RETVM})
exten => vmb367,n,Goto(vmret,1)

exten => vmu367,1,Macro(vm,367,NOANSWER,${IVR_RETVM})
exten => vmu367,n,Goto(vmret,1)

exten => vms367,1,Macro(vm,367,NOMESSAGE,${IVR_RETVM})
exten => vms367,n,Goto(vmret,1)

exten => vmi367,1,Macro(vm,367,INSTRUCT,${IVR_RETVM})
exten => vmi367,n,Goto(vmret,1)

exten => 368,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/368/ringtimer)}" > "0"]?${DB(AMPUSER/368/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 368,n,Macro(exten-vm,368,368,0,0,0)
exten => 368,n(dest),Set(__PICKUPMARK=)
exten => 368,n,Macro(vm,368,${DIALSTATUS},${IVR_RETVM})
exten => 368,n,Goto(vmret,1)
exten => 368,hint,SIP/268&Custom:DND368,CustomPresence:368

exten => vmb368,1,Macro(vm,368,BUSY,${IVR_RETVM})
exten => vmb368,n,Goto(vmret,1)

exten => vmu368,1,Macro(vm,368,NOANSWER,${IVR_RETVM})
exten => vmu368,n,Goto(vmret,1)

exten => vms368,1,Macro(vm,368,NOMESSAGE,${IVR_RETVM})
exten => vms368,n,Goto(vmret,1)

exten => vmi368,1,Macro(vm,368,INSTRUCT,${IVR_RETVM})
exten => vmi368,n,Goto(vmret,1)

exten => 369,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/369/ringtimer)}" > "0"]?${DB(AMPUSER/369/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 369,n,Macro(exten-vm,369,369,0,0,0)
exten => 369,n(dest),Set(__PICKUPMARK=)
exten => 369,n,Macro(vm,369,${DIALSTATUS},${IVR_RETVM})
exten => 369,n,Goto(vmret,1)
exten => 369,hint,SIP/269&Custom:DND369,CustomPresence:369

exten => vmb369,1,Macro(vm,369,BUSY,${IVR_RETVM})
exten => vmb369,n,Goto(vmret,1)

exten => vmu369,1,Macro(vm,369,NOANSWER,${IVR_RETVM})
exten => vmu369,n,Goto(vmret,1)

exten => vms369,1,Macro(vm,369,NOMESSAGE,${IVR_RETVM})
exten => vms369,n,Goto(vmret,1)

exten => vmi369,1,Macro(vm,369,INSTRUCT,${IVR_RETVM})
exten => vmi369,n,Goto(vmret,1)

exten => 370,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/370/ringtimer)}" > "0"]?${DB(AMPUSER/370/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 370,n,Macro(exten-vm,370,370,0,0,0)
exten => 370,n(dest),Set(__PICKUPMARK=)
exten => 370,n,Macro(vm,370,${DIALSTATUS},${IVR_RETVM})
exten => 370,n,Goto(vmret,1)
exten => 370,hint,SIP/270&Custom:DND370,CustomPresence:370

exten => vmb370,1,Macro(vm,370,BUSY,${IVR_RETVM})
exten => vmb370,n,Goto(vmret,1)

exten => vmu370,1,Macro(vm,370,NOANSWER,${IVR_RETVM})
exten => vmu370,n,Goto(vmret,1)

exten => vms370,1,Macro(vm,370,NOMESSAGE,${IVR_RETVM})
exten => vms370,n,Goto(vmret,1)

exten => vmi370,1,Macro(vm,370,INSTRUCT,${IVR_RETVM})
exten => vmi370,n,Goto(vmret,1)

exten => 371,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/371/ringtimer)}" > "0"]?${DB(AMPUSER/371/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 371,n,Macro(exten-vm,371,371,0,0,0)
exten => 371,n(dest),Set(__PICKUPMARK=)
exten => 371,n,Macro(vm,371,${DIALSTATUS},${IVR_RETVM})
exten => 371,n,Goto(vmret,1)
exten => 371,hint,&Custom:DND371,CustomPresence:371

exten => vmb371,1,Macro(vm,371,BUSY,${IVR_RETVM})
exten => vmb371,n,Goto(vmret,1)

exten => vmu371,1,Macro(vm,371,NOANSWER,${IVR_RETVM})
exten => vmu371,n,Goto(vmret,1)

exten => vms371,1,Macro(vm,371,NOMESSAGE,${IVR_RETVM})
exten => vms371,n,Goto(vmret,1)

exten => vmi371,1,Macro(vm,371,INSTRUCT,${IVR_RETVM})
exten => vmi371,n,Goto(vmret,1)

exten => 372,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/372/ringtimer)}" > "0"]?${DB(AMPUSER/372/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 372,n,Macro(exten-vm,372,372,0,0,0)
exten => 372,n(dest),Set(__PICKUPMARK=)
exten => 372,n,Macro(vm,372,${DIALSTATUS},${IVR_RETVM})
exten => 372,n,Goto(vmret,1)
exten => 372,hint,SIP/272&Custom:DND372,CustomPresence:372

exten => vmb372,1,Macro(vm,372,BUSY,${IVR_RETVM})
exten => vmb372,n,Goto(vmret,1)

exten => vmu372,1,Macro(vm,372,NOANSWER,${IVR_RETVM})
exten => vmu372,n,Goto(vmret,1)

exten => vms372,1,Macro(vm,372,NOMESSAGE,${IVR_RETVM})
exten => vms372,n,Goto(vmret,1)

exten => vmi372,1,Macro(vm,372,INSTRUCT,${IVR_RETVM})
exten => vmi372,n,Goto(vmret,1)

exten => 373,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/373/ringtimer)}" > "0"]?${DB(AMPUSER/373/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 373,n,Macro(exten-vm,373,373,0,0,0)
exten => 373,n(dest),Set(__PICKUPMARK=)
exten => 373,n,Macro(vm,373,${DIALSTATUS},${IVR_RETVM})
exten => 373,n,Goto(vmret,1)
exten => 373,hint,SIP/273&Custom:DND373,CustomPresence:373

exten => vmb373,1,Macro(vm,373,BUSY,${IVR_RETVM})
exten => vmb373,n,Goto(vmret,1)

exten => vmu373,1,Macro(vm,373,NOANSWER,${IVR_RETVM})
exten => vmu373,n,Goto(vmret,1)

exten => vms373,1,Macro(vm,373,NOMESSAGE,${IVR_RETVM})
exten => vms373,n,Goto(vmret,1)

exten => vmi373,1,Macro(vm,373,INSTRUCT,${IVR_RETVM})
exten => vmi373,n,Goto(vmret,1)

exten => 381,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/381/ringtimer)}" > "0"]?${DB(AMPUSER/381/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 381,n,Macro(exten-vm,novm,381,0,0,0)
exten => 381,n(dest),Set(__PICKUPMARK=)
exten => 381,n,Goto(${IVR_CONTEXT},return,1)
exten => 381,hint,SIP/281&Custom:DND381,CustomPresence:381

exten => 382,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/382/ringtimer)}" > "0"]?${DB(AMPUSER/382/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 382,n,Macro(exten-vm,novm,382,0,0,0)
exten => 382,n(dest),Set(__PICKUPMARK=)
exten => 382,n,Goto(${IVR_CONTEXT},return,1)
exten => 382,hint,SIP/282&Custom:DND382,CustomPresence:382

exten => 383,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/383/ringtimer)}" > "0"]?${DB(AMPUSER/383/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 383,n,Macro(exten-vm,383,383,0,0,0)
exten => 383,n(dest),Set(__PICKUPMARK=)
exten => 383,n,Macro(vm,383,${DIALSTATUS},${IVR_RETVM})
exten => 383,n,Goto(vmret,1)
exten => 383,hint,SIP/283&Custom:DND383,CustomPresence:383

exten => vmb383,1,Macro(vm,383,BUSY,${IVR_RETVM})
exten => vmb383,n,Goto(vmret,1)

exten => vmu383,1,Macro(vm,383,NOANSWER,${IVR_RETVM})
exten => vmu383,n,Goto(vmret,1)

exten => vms383,1,Macro(vm,383,NOMESSAGE,${IVR_RETVM})
exten => vms383,n,Goto(vmret,1)

exten => vmi383,1,Macro(vm,383,INSTRUCT,${IVR_RETVM})
exten => vmi383,n,Goto(vmret,1)

exten => 384,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/384/ringtimer)}" > "0"]?${DB(AMPUSER/384/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 384,n,Macro(exten-vm,384,384,0,0,0)
exten => 384,n(dest),Set(__PICKUPMARK=)
exten => 384,n,Macro(vm,384,${DIALSTATUS},${IVR_RETVM})
exten => 384,n,Goto(vmret,1)
exten => 384,hint,SIP/284&SIP/884&Custom:DND384,CustomPresence:384

exten => vmb384,1,Macro(vm,384,BUSY,${IVR_RETVM})
exten => vmb384,n,Goto(vmret,1)

exten => vmu384,1,Macro(vm,384,NOANSWER,${IVR_RETVM})
exten => vmu384,n,Goto(vmret,1)

exten => vms384,1,Macro(vm,384,NOMESSAGE,${IVR_RETVM})
exten => vms384,n,Goto(vmret,1)

exten => vmi384,1,Macro(vm,384,INSTRUCT,${IVR_RETVM})
exten => vmi384,n,Goto(vmret,1)

exten => 800,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/800/ringtimer)}" > "0"]?${DB(AMPUSER/800/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 800,n,Macro(exten-vm,novm,800,0,0,0)
exten => 800,n(dest),Set(__PICKUPMARK=)
exten => 800,n,Goto(${IVR_CONTEXT},return,1)
exten => 800,hint,SIP/900&Custom:DND800,CustomPresence:800

exten => 9999,1,Set(__RINGTIMER=${IF($["${DB(AMPUSER/9999/ringtimer)}" > "0"]?${DB(AMPUSER/9999/ringtimer)}:${RINGTIMER_DEFAULT})})
exten => 9999,n,Macro(exten-vm,9999,9999,0,0,0)
exten => 9999,n(dest),Set(__PICKUPMARK=)
exten => 9999,n,Macro(vm,9999,${DIALSTATUS},${IVR_RETVM})
exten => 9999,n,Goto(vmret,1)
exten => 9999,hint,SIP/10999&Custom:DND9999,CustomPresence:9999

exten => vmb9999,1,Macro(vm,9999,BUSY,${IVR_RETVM})
exten => vmb9999,n,Goto(vmret,1)

exten => vmu9999,1,Macro(vm,9999,NOANSWER,${IVR_RETVM})
exten => vmu9999,n,Goto(vmret,1)

exten => vms9999,1,Macro(vm,9999,NOMESSAGE,${IVR_RETVM})
exten => vms9999,n,Goto(vmret,1)

exten => vmi9999,1,Macro(vm,9999,INSTRUCT,${IVR_RETVM})
exten => vmi9999,n,Goto(vmret,1)

exten => vmret,1,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?playret)
exten => vmret,n,Hangup
exten => vmret,n(playret),Playback(exited-vm-will-be-transfered&silence/1)
exten => vmret,n,Goto(${IVR_CONTEXT},return,1)

exten => h,1,Macro(hangupcall,)

exten => _*80X.,hint,${DB(AMPUSER/${EXTEN:3}/hint)}
;--== end of [ext-local] ==--;


[from-did-direct-ivr]
exten => *100,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *100,n,Set(CONNECTEDLINE(name,i)=100 Voicemail)
exten => *100,n,Set(CONNECTEDLINE(num,i)=100)
exten => *100,n,Macro(blkvm-clr,)
exten => *100,n,Set(__NODEST=)
exten => *100,n,Macro(vm,100,DIRECTDIAL,${IVR_RETVM})
exten => *100,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *102,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *102,n,Set(CONNECTEDLINE(name,i)=102 Voicemail)
exten => *102,n,Set(CONNECTEDLINE(num,i)=102)
exten => *102,n,Macro(blkvm-clr,)
exten => *102,n,Set(__NODEST=)
exten => *102,n,Macro(vm,102,DIRECTDIAL,${IVR_RETVM})
exten => *102,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *105,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *105,n,Set(CONNECTEDLINE(name,i)=105 Voicemail)
exten => *105,n,Set(CONNECTEDLINE(num,i)=105)
exten => *105,n,Macro(blkvm-clr,)
exten => *105,n,Set(__NODEST=)
exten => *105,n,Macro(vm,105,DIRECTDIAL,${IVR_RETVM})
exten => *105,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *106,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *106,n,Set(CONNECTEDLINE(name,i)=106 Voicemail)
exten => *106,n,Set(CONNECTEDLINE(num,i)=106)
exten => *106,n,Macro(blkvm-clr,)
exten => *106,n,Set(__NODEST=)
exten => *106,n,Macro(vm,106,DIRECTDIAL,${IVR_RETVM})
exten => *106,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *107,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *107,n,Set(CONNECTEDLINE(name,i)=107 Voicemail)
exten => *107,n,Set(CONNECTEDLINE(num,i)=107)
exten => *107,n,Macro(blkvm-clr,)
exten => *107,n,Set(__NODEST=)
exten => *107,n,Macro(vm,107,DIRECTDIAL,${IVR_RETVM})
exten => *107,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *127,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *127,n,Set(CONNECTEDLINE(name,i)=127 Voicemail)
exten => *127,n,Set(CONNECTEDLINE(num,i)=127)
exten => *127,n,Macro(blkvm-clr,)
exten => *127,n,Set(__NODEST=)
exten => *127,n,Macro(vm,127,DIRECTDIAL,${IVR_RETVM})
exten => *127,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *129,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *129,n,Set(CONNECTEDLINE(name,i)=129 Voicemail)
exten => *129,n,Set(CONNECTEDLINE(num,i)=129)
exten => *129,n,Macro(blkvm-clr,)
exten => *129,n,Set(__NODEST=)
exten => *129,n,Macro(vm,129,DIRECTDIAL,${IVR_RETVM})
exten => *129,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *130,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *130,n,Set(CONNECTEDLINE(name,i)=130 Voicemail)
exten => *130,n,Set(CONNECTEDLINE(num,i)=130)
exten => *130,n,Macro(blkvm-clr,)
exten => *130,n,Set(__NODEST=)
exten => *130,n,Macro(vm,130,DIRECTDIAL,${IVR_RETVM})
exten => *130,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *131,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *131,n,Set(CONNECTEDLINE(name,i)=131 Voicemail)
exten => *131,n,Set(CONNECTEDLINE(num,i)=131)
exten => *131,n,Macro(blkvm-clr,)
exten => *131,n,Set(__NODEST=)
exten => *131,n,Macro(vm,131,DIRECTDIAL,${IVR_RETVM})
exten => *131,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *132,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *132,n,Set(CONNECTEDLINE(name,i)=132 Voicemail)
exten => *132,n,Set(CONNECTEDLINE(num,i)=132)
exten => *132,n,Macro(blkvm-clr,)
exten => *132,n,Set(__NODEST=)
exten => *132,n,Macro(vm,132,DIRECTDIAL,${IVR_RETVM})
exten => *132,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *133,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *133,n,Set(CONNECTEDLINE(name,i)=133 Voicemail)
exten => *133,n,Set(CONNECTEDLINE(num,i)=133)
exten => *133,n,Macro(blkvm-clr,)
exten => *133,n,Set(__NODEST=)
exten => *133,n,Macro(vm,133,DIRECTDIAL,${IVR_RETVM})
exten => *133,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *134,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *134,n,Set(CONNECTEDLINE(name,i)=134 Voicemail)
exten => *134,n,Set(CONNECTEDLINE(num,i)=134)
exten => *134,n,Macro(blkvm-clr,)
exten => *134,n,Set(__NODEST=)
exten => *134,n,Macro(vm,134,DIRECTDIAL,${IVR_RETVM})
exten => *134,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *135,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *135,n,Set(CONNECTEDLINE(name,i)=135 Voicemail)
exten => *135,n,Set(CONNECTEDLINE(num,i)=135)
exten => *135,n,Macro(blkvm-clr,)
exten => *135,n,Set(__NODEST=)
exten => *135,n,Macro(vm,135,DIRECTDIAL,${IVR_RETVM})
exten => *135,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *136,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *136,n,Set(CONNECTEDLINE(name,i)=136 Voicemail)
exten => *136,n,Set(CONNECTEDLINE(num,i)=136)
exten => *136,n,Macro(blkvm-clr,)
exten => *136,n,Set(__NODEST=)
exten => *136,n,Macro(vm,136,DIRECTDIAL,${IVR_RETVM})
exten => *136,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *137,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *137,n,Set(CONNECTEDLINE(name,i)=137 Voicemail)
exten => *137,n,Set(CONNECTEDLINE(num,i)=137)
exten => *137,n,Macro(blkvm-clr,)
exten => *137,n,Set(__NODEST=)
exten => *137,n,Macro(vm,137,DIRECTDIAL,${IVR_RETVM})
exten => *137,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *138,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *138,n,Set(CONNECTEDLINE(name,i)=138 Voicemail)
exten => *138,n,Set(CONNECTEDLINE(num,i)=138)
exten => *138,n,Macro(blkvm-clr,)
exten => *138,n,Set(__NODEST=)
exten => *138,n,Macro(vm,138,DIRECTDIAL,${IVR_RETVM})
exten => *138,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *139,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *139,n,Set(CONNECTEDLINE(name,i)=139 Voicemail)
exten => *139,n,Set(CONNECTEDLINE(num,i)=139)
exten => *139,n,Macro(blkvm-clr,)
exten => *139,n,Set(__NODEST=)
exten => *139,n,Macro(vm,139,DIRECTDIAL,${IVR_RETVM})
exten => *139,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *140,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *140,n,Set(CONNECTEDLINE(name,i)=140 Voicemail)
exten => *140,n,Set(CONNECTEDLINE(num,i)=140)
exten => *140,n,Macro(blkvm-clr,)
exten => *140,n,Set(__NODEST=)
exten => *140,n,Macro(vm,140,DIRECTDIAL,${IVR_RETVM})
exten => *140,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *141,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *141,n,Set(CONNECTEDLINE(name,i)=141 Voicemail)
exten => *141,n,Set(CONNECTEDLINE(num,i)=141)
exten => *141,n,Macro(blkvm-clr,)
exten => *141,n,Set(__NODEST=)
exten => *141,n,Macro(vm,141,DIRECTDIAL,${IVR_RETVM})
exten => *141,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *142,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *142,n,Set(CONNECTEDLINE(name,i)=142 Voicemail)
exten => *142,n,Set(CONNECTEDLINE(num,i)=142)
exten => *142,n,Macro(blkvm-clr,)
exten => *142,n,Set(__NODEST=)
exten => *142,n,Macro(vm,142,DIRECTDIAL,${IVR_RETVM})
exten => *142,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *144,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *144,n,Set(CONNECTEDLINE(name,i)=144 Voicemail)
exten => *144,n,Set(CONNECTEDLINE(num,i)=144)
exten => *144,n,Macro(blkvm-clr,)
exten => *144,n,Set(__NODEST=)
exten => *144,n,Macro(vm,144,DIRECTDIAL,${IVR_RETVM})
exten => *144,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *145,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *145,n,Set(CONNECTEDLINE(name,i)=145 Voicemail)
exten => *145,n,Set(CONNECTEDLINE(num,i)=145)
exten => *145,n,Macro(blkvm-clr,)
exten => *145,n,Set(__NODEST=)
exten => *145,n,Macro(vm,145,DIRECTDIAL,${IVR_RETVM})
exten => *145,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *146,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *146,n,Set(CONNECTEDLINE(name,i)=146 Voicemail)
exten => *146,n,Set(CONNECTEDLINE(num,i)=146)
exten => *146,n,Macro(blkvm-clr,)
exten => *146,n,Set(__NODEST=)
exten => *146,n,Macro(vm,146,DIRECTDIAL,${IVR_RETVM})
exten => *146,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *147,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *147,n,Set(CONNECTEDLINE(name,i)=147 Voicemail)
exten => *147,n,Set(CONNECTEDLINE(num,i)=147)
exten => *147,n,Macro(blkvm-clr,)
exten => *147,n,Set(__NODEST=)
exten => *147,n,Macro(vm,147,DIRECTDIAL,${IVR_RETVM})
exten => *147,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *148,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *148,n,Set(CONNECTEDLINE(name,i)=148 Voicemail)
exten => *148,n,Set(CONNECTEDLINE(num,i)=148)
exten => *148,n,Macro(blkvm-clr,)
exten => *148,n,Set(__NODEST=)
exten => *148,n,Macro(vm,148,DIRECTDIAL,${IVR_RETVM})
exten => *148,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *149,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *149,n,Set(CONNECTEDLINE(name,i)=149 Voicemail)
exten => *149,n,Set(CONNECTEDLINE(num,i)=149)
exten => *149,n,Macro(blkvm-clr,)
exten => *149,n,Set(__NODEST=)
exten => *149,n,Macro(vm,149,DIRECTDIAL,${IVR_RETVM})
exten => *149,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *152,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *152,n,Set(CONNECTEDLINE(name,i)=152 Voicemail)
exten => *152,n,Set(CONNECTEDLINE(num,i)=152)
exten => *152,n,Macro(blkvm-clr,)
exten => *152,n,Set(__NODEST=)
exten => *152,n,Macro(vm,152,DIRECTDIAL,${IVR_RETVM})
exten => *152,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *350,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *350,n,Set(CONNECTEDLINE(name,i)=350 Voicemail)
exten => *350,n,Set(CONNECTEDLINE(num,i)=350)
exten => *350,n,Macro(blkvm-clr,)
exten => *350,n,Set(__NODEST=)
exten => *350,n,Macro(vm,350,DIRECTDIAL,${IVR_RETVM})
exten => *350,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *351,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *351,n,Set(CONNECTEDLINE(name,i)=351 Voicemail)
exten => *351,n,Set(CONNECTEDLINE(num,i)=351)
exten => *351,n,Macro(blkvm-clr,)
exten => *351,n,Set(__NODEST=)
exten => *351,n,Macro(vm,351,DIRECTDIAL,${IVR_RETVM})
exten => *351,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *352,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *352,n,Set(CONNECTEDLINE(name,i)=352 Voicemail)
exten => *352,n,Set(CONNECTEDLINE(num,i)=352)
exten => *352,n,Macro(blkvm-clr,)
exten => *352,n,Set(__NODEST=)
exten => *352,n,Macro(vm,352,DIRECTDIAL,${IVR_RETVM})
exten => *352,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *353,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *353,n,Set(CONNECTEDLINE(name,i)=353 Voicemail)
exten => *353,n,Set(CONNECTEDLINE(num,i)=353)
exten => *353,n,Macro(blkvm-clr,)
exten => *353,n,Set(__NODEST=)
exten => *353,n,Macro(vm,353,DIRECTDIAL,${IVR_RETVM})
exten => *353,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *354,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *354,n,Set(CONNECTEDLINE(name,i)=354 Voicemail)
exten => *354,n,Set(CONNECTEDLINE(num,i)=354)
exten => *354,n,Macro(blkvm-clr,)
exten => *354,n,Set(__NODEST=)
exten => *354,n,Macro(vm,354,DIRECTDIAL,${IVR_RETVM})
exten => *354,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *355,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *355,n,Set(CONNECTEDLINE(name,i)=355 Voicemail)
exten => *355,n,Set(CONNECTEDLINE(num,i)=355)
exten => *355,n,Macro(blkvm-clr,)
exten => *355,n,Set(__NODEST=)
exten => *355,n,Macro(vm,355,DIRECTDIAL,${IVR_RETVM})
exten => *355,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *356,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *356,n,Set(CONNECTEDLINE(name,i)=356 Voicemail)
exten => *356,n,Set(CONNECTEDLINE(num,i)=356)
exten => *356,n,Macro(blkvm-clr,)
exten => *356,n,Set(__NODEST=)
exten => *356,n,Macro(vm,356,DIRECTDIAL,${IVR_RETVM})
exten => *356,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *357,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *357,n,Set(CONNECTEDLINE(name,i)=357 Voicemail)
exten => *357,n,Set(CONNECTEDLINE(num,i)=357)
exten => *357,n,Macro(blkvm-clr,)
exten => *357,n,Set(__NODEST=)
exten => *357,n,Macro(vm,357,DIRECTDIAL,${IVR_RETVM})
exten => *357,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *358,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *358,n,Set(CONNECTEDLINE(name,i)=358 Voicemail)
exten => *358,n,Set(CONNECTEDLINE(num,i)=358)
exten => *358,n,Macro(blkvm-clr,)
exten => *358,n,Set(__NODEST=)
exten => *358,n,Macro(vm,358,DIRECTDIAL,${IVR_RETVM})
exten => *358,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *359,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *359,n,Set(CONNECTEDLINE(name,i)=359 Voicemail)
exten => *359,n,Set(CONNECTEDLINE(num,i)=359)
exten => *359,n,Macro(blkvm-clr,)
exten => *359,n,Set(__NODEST=)
exten => *359,n,Macro(vm,359,DIRECTDIAL,${IVR_RETVM})
exten => *359,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *360,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *360,n,Set(CONNECTEDLINE(name,i)=360 Voicemail)
exten => *360,n,Set(CONNECTEDLINE(num,i)=360)
exten => *360,n,Macro(blkvm-clr,)
exten => *360,n,Set(__NODEST=)
exten => *360,n,Macro(vm,360,DIRECTDIAL,${IVR_RETVM})
exten => *360,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *361,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *361,n,Set(CONNECTEDLINE(name,i)=361 Voicemail)
exten => *361,n,Set(CONNECTEDLINE(num,i)=361)
exten => *361,n,Macro(blkvm-clr,)
exten => *361,n,Set(__NODEST=)
exten => *361,n,Macro(vm,361,DIRECTDIAL,${IVR_RETVM})
exten => *361,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *362,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *362,n,Set(CONNECTEDLINE(name,i)=362 Voicemail)
exten => *362,n,Set(CONNECTEDLINE(num,i)=362)
exten => *362,n,Macro(blkvm-clr,)
exten => *362,n,Set(__NODEST=)
exten => *362,n,Macro(vm,362,DIRECTDIAL,${IVR_RETVM})
exten => *362,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *363,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *363,n,Set(CONNECTEDLINE(name,i)=363 Voicemail)
exten => *363,n,Set(CONNECTEDLINE(num,i)=363)
exten => *363,n,Macro(blkvm-clr,)
exten => *363,n,Set(__NODEST=)
exten => *363,n,Macro(vm,363,DIRECTDIAL,${IVR_RETVM})
exten => *363,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *364,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *364,n,Set(CONNECTEDLINE(name,i)=364 Voicemail)
exten => *364,n,Set(CONNECTEDLINE(num,i)=364)
exten => *364,n,Macro(blkvm-clr,)
exten => *364,n,Set(__NODEST=)
exten => *364,n,Macro(vm,364,DIRECTDIAL,${IVR_RETVM})
exten => *364,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *365,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *365,n,Set(CONNECTEDLINE(name,i)=365 Voicemail)
exten => *365,n,Set(CONNECTEDLINE(num,i)=365)
exten => *365,n,Macro(blkvm-clr,)
exten => *365,n,Set(__NODEST=)
exten => *365,n,Macro(vm,365,DIRECTDIAL,${IVR_RETVM})
exten => *365,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *366,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *366,n,Set(CONNECTEDLINE(name,i)=366 Voicemail)
exten => *366,n,Set(CONNECTEDLINE(num,i)=366)
exten => *366,n,Macro(blkvm-clr,)
exten => *366,n,Set(__NODEST=)
exten => *366,n,Macro(vm,366,DIRECTDIAL,${IVR_RETVM})
exten => *366,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *367,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *367,n,Set(CONNECTEDLINE(name,i)=367 Voicemail)
exten => *367,n,Set(CONNECTEDLINE(num,i)=367)
exten => *367,n,Macro(blkvm-clr,)
exten => *367,n,Set(__NODEST=)
exten => *367,n,Macro(vm,367,DIRECTDIAL,${IVR_RETVM})
exten => *367,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *368,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *368,n,Set(CONNECTEDLINE(name,i)=368 Voicemail)
exten => *368,n,Set(CONNECTEDLINE(num,i)=368)
exten => *368,n,Macro(blkvm-clr,)
exten => *368,n,Set(__NODEST=)
exten => *368,n,Macro(vm,368,DIRECTDIAL,${IVR_RETVM})
exten => *368,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *369,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *369,n,Set(CONNECTEDLINE(name,i)=369 Voicemail)
exten => *369,n,Set(CONNECTEDLINE(num,i)=369)
exten => *369,n,Macro(blkvm-clr,)
exten => *369,n,Set(__NODEST=)
exten => *369,n,Macro(vm,369,DIRECTDIAL,${IVR_RETVM})
exten => *369,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *370,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *370,n,Set(CONNECTEDLINE(name,i)=370 Voicemail)
exten => *370,n,Set(CONNECTEDLINE(num,i)=370)
exten => *370,n,Macro(blkvm-clr,)
exten => *370,n,Set(__NODEST=)
exten => *370,n,Macro(vm,370,DIRECTDIAL,${IVR_RETVM})
exten => *370,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *371,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *371,n,Set(CONNECTEDLINE(name,i)=371 Voicemail)
exten => *371,n,Set(CONNECTEDLINE(num,i)=371)
exten => *371,n,Macro(blkvm-clr,)
exten => *371,n,Set(__NODEST=)
exten => *371,n,Macro(vm,371,DIRECTDIAL,${IVR_RETVM})
exten => *371,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *372,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *372,n,Set(CONNECTEDLINE(name,i)=372 Voicemail)
exten => *372,n,Set(CONNECTEDLINE(num,i)=372)
exten => *372,n,Macro(blkvm-clr,)
exten => *372,n,Set(__NODEST=)
exten => *372,n,Macro(vm,372,DIRECTDIAL,${IVR_RETVM})
exten => *372,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *373,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *373,n,Set(CONNECTEDLINE(name,i)=373 Voicemail)
exten => *373,n,Set(CONNECTEDLINE(num,i)=373)
exten => *373,n,Macro(blkvm-clr,)
exten => *373,n,Set(__NODEST=)
exten => *373,n,Macro(vm,373,DIRECTDIAL,${IVR_RETVM})
exten => *373,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *383,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *383,n,Set(CONNECTEDLINE(name,i)=383 Voicemail)
exten => *383,n,Set(CONNECTEDLINE(num,i)=383)
exten => *383,n,Macro(blkvm-clr,)
exten => *383,n,Set(__NODEST=)
exten => *383,n,Macro(vm,383,DIRECTDIAL,${IVR_RETVM})
exten => *383,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *384,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *384,n,Set(CONNECTEDLINE(name,i)=384 Voicemail)
exten => *384,n,Set(CONNECTEDLINE(num,i)=384)
exten => *384,n,Macro(blkvm-clr,)
exten => *384,n,Set(__NODEST=)
exten => *384,n,Macro(vm,384,DIRECTDIAL,${IVR_RETVM})
exten => *384,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => *9999,1,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *9999,n,Set(CONNECTEDLINE(name,i)=9999 Voicemail)
exten => *9999,n,Set(CONNECTEDLINE(num,i)=9999)
exten => *9999,n,Macro(blkvm-clr,)
exten => *9999,n,Set(__NODEST=)
exten => *9999,n,Macro(vm,9999,DIRECTDIAL,${IVR_RETVM})
exten => *9999,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?ext-local,vmret,playret)

exten => _X.,1,GotoIf($[${DIALPLAN_EXISTS(from-did-direct,${EXTEN},1)} = 0]?i,1)
exten => _X.,n,Macro(blkvm-clr,)
exten => _X.,n,Set(__NODEST=)
exten => _X.,n,Goto(from-did-direct,${EXTEN},1)

;--== end of [from-did-direct-ivr] ==--;


[app-vmmain]
exten => *97,1,Macro(user-callerid,)
exten => *97,n,Set(CONNECTEDLINE(name-charset,i)=utf8)
exten => *97,n,Set(CONNECTEDLINE(name,i)=My Voicemail)
exten => *97,n,Set(CONNECTEDLINE(num,i)=${AMPUSER})
exten => *97,n,Answer
exten => *97,n,Wait(1)
exten => *97,n,Macro(get-vmcontext,${AMPUSER})
exten => *97,n(check),Set(VMBOXEXISTSSTATUS=${IF(${VM_INFO(${AMPUSER}@${VMCONTEXT},exists)}?SUCCESS:FAILED)})
exten => *97,n,GotoIf($["${VMBOXEXISTSSTATUS}" = "SUCCESS"]?mbexist)
exten => *97,n,VoiceMailMain()
exten => *97,n,GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?playret)
exten => *97,n,Macro(hangupcall,)
exten => *97,check+101(mbexist),GotoIf($["${DB(AMPUSER/${AMPUSER}/novmpw)}"!=""]?novmpw:vmpw)
exten => *97,n(novmpw),Noop(Verifying channel ${CHANNEL} is actually ${AMPUSER})
exten => *97,n,Set(DEVICES=${DB(AMPUSER/${AMPUSER}/device)})
exten => *97,n,ExecIf($["${DEVICES}" = ""]?Set(DEVICES=${AMPUSER}))
exten => *97,n,ExecIf($["${DEVICES:0:1}" = "&"]?Set(DEVICES=${DEVICES:1}))
exten => *97,n,While($["${SET(DEV=${SHIFT(DEVICES,&)})}" != ""])
exten => *97,n,GotoIf($["${DB(DEVICE/${DEV}/dial)}" = "${CUT(CHANNEL,-,1)}"]?vmpwskip)
exten => *97,n,EndWhile
exten => *97,n,Noop(Channel ${CHANNEL} is NOT ${AMPUSER} forcing VM Password)
exten => *97,n(vmpw),VoiceMailMain(${AMPUSER}@${VMCONTEXT})
exten => *97,n,Goto(vmend)
exten => *97,n(vmpwskip),VoiceMailMain(${AMPUSER}@${VMCONTEXT},s)
exten => *97,n(vmend),GotoIf($["${IVR_RETVM}" = "RETURN" & "${IVR_CONTEXT}" != ""]?playret)
exten => *97,n,Macro(hangupcall,)
exten => *97,n(playret),Playback(beep&you-will-be-transfered-menu&silence/1)
exten => *97,n,Goto(${IVR_CONTEXT},return,1)

;--== end of [app-vmmain] ==--;


[app-blacklist]
exten => s,1,Macro(user-callerid,)

exten => *30,1,Goto(app-blacklist-add,s,1)

exten => *31,1,Goto(app-blacklist-remove,s,1)

exten => *32,1,Goto(app-blacklist-last,s,1)

;--== end of [app-blacklist] ==--;


[app-blacklist-check]
exten => s,1(check),GotoIf($["${BLACKLIST()}"="1"]?blacklisted)
exten => s,n,Set(CALLED_BLACKLIST=1)
exten => s,n,Return()
exten => s,n(blacklisted),Answer
exten => s,n,Set(BLDEST=${DB(blacklist/dest)})
exten => s,n,ExecIf($["${BLDEST}"=""]?Set(BLDEST=app-blackhole,hangup,1))
exten => s,n,GotoIf($["${returnhere}"="1"]?returnto)
exten => s,n,GotoIf(${LEN(${BLDEST})}?${BLDEST}:app-blackhole,zapateller,1)
exten => s,n(returnto),Return()

;--== end of [app-blacklist-check] ==--;


[app-blacklist-add]
exten => s,1,Answer
exten => s,n,Macro(user-callerid,)
exten => s,n,Wait(1)
exten => s,n,Set(NumLoops=0)
exten => s,n(start),Set(TIMEOUT(digit)=5)
exten => s,n,Set(TIMEOUT(response)=10)
exten => s,n,Read(blacknr,enter-num-blacklist&vm-then-pound,,,,)
exten => s,n,SayDigits(${blacknr})
exten => s,n,GosubIf($[${DIALPLAN_EXISTS(app-blacklist-add,${CHANNEL(language)})}]?app-blacklist-add,${CHANNEL(language)},1():app-blacklist-add,en,1())
exten => s,n,GotoIf($[ "${confirm}" = "1" ]?app-blacklist-add,1,1)
exten => s,n,GotoIf($[ "${confirm}" = "2" ]?app-blacklist-add,2,1)
exten => s,n,Goto(app-blacklist-add-invalid,s,1)

exten => en,1,Set(TIMEOUT(digit)=1)
exten => en,n,Read(confirm,if-correct-press&digits/1&to-enter-a-diff-number&press&digits/2,,,,)
exten => en,n,Return()

exten => ja,1,Set(TIMEOUT(digit)=1)
exten => ja,n,Read(if-correct-press&digits/1&pleasepress,,,,,)
exten => ja,n,Return()

exten => 1,1,GotoIf($[ "${blacknr}" != ""]?:app-blacklist-add-invalid,s,1)
exten => 1,n,Set(DB(blacklist/${blacknr})=1)
exten => 1,n,Playback(num-was-successfully&added)
exten => 1,n,Wait(1)
exten => 1,n,Hangup

exten => 2,1,Set(NumLoops=$[${NumLoops} + 1])
exten => 2,n,GotoIf($[${NumLoops} < 3]?app-blacklist-add,s,start)
exten => 2,n,Playback(sorry-youre-having-problems&goodbye)
exten => 2,n,Hangup

;--== end of [app-blacklist-add] ==--;


[app-blacklist-add-invalid]
exten => s,1,Set(NumLoops=$[${NumLoops} + 1])
exten => s,n,Playback(pm-invalid-option)
exten => s,n,GotoIf($[${NumLoops} < 3]?app-blacklist-add,s,start)
exten => s,n,Playback(sorry-youre-having-problems&goodbye)
exten => s,n,Hangup

;--== end of [app-blacklist-add-invalid] ==--;


[app-blacklist-remove]
exten => s,1,Answer
exten => s,n,Macro(user-callerid,)
exten => s,n,Set(NumLoops=0)
exten => s,n,Wait(1)
exten => s,n(start),Set(TIMEOUT(digit)=5)
exten => s,n,Set(TIMEOUT(response)=10)
exten => s,n,Read(blacknr,entr-num-rmv-blklist&vm-then-pound,,,,)
exten => s,n,SayDigits(${blacknr})
exten => s,n,GosubIf($[${DIALPLAN_EXISTS(app-blacklist-remove,${CHANNEL(language)})}]?app-blacklist-remove,${CHANNEL(language)},1():app-blacklist-remove,en,1())
exten => s,n,GotoIf($[ "${confirm}" = "1" ]?app-blacklist-remove,1,1)
exten => s,n,GotoIf($[ "${confirm}" = "2" ]?app-blacklist-remove,2,1)
exten => s,n,Goto(app-blacklist-add-invalid,s,1)

exten => en,1,Set(TIMEOUT(digit)=1)
exten => en,n,Read(confirm,if-correct-press&digits/1&to-enter-a-diff-number&press&digits/2,,,,)
exten => en,n,Return()

exten => ja,1,Set(TIMEOUT(digit)=1)
exten => ja,n,Read(confirm,if-correct-press&digits/1&pleasepress,,,,)
exten => ja,n,Return()

exten => 1,1,Noop(Deleting: blacklist/${blacknr} ${DB_DELETE(blacklist/${blacknr})})
exten => 1,n,Playback(num-was-successfully&removed)
exten => 1,n,Wait(1)
exten => 1,n,Hangup

exten => 2,1,Set(NumLoops=$[${NumLoops} + 1])
exten => 2,n,GotoIf($[${NumLoops} < 3]?app-blacklist-remove,s,start)
exten => 2,n,Playback(goodbye)
exten => 2,n,Hangup

;--== end of [app-blacklist-remove] ==--;


[app-blacklist-remove-invalid]
exten => s,1,Set(NumLoops=$[${NumLoops} + 1])
exten => s,n,Playback(pm-invalid-option)
exten => s,n,GotoIf($[${NumLoops} < 3]?app-blacklist-remove,s,start)
exten => s,n,Playback(sorry-youre-having-problems&goodbye)
exten => s,n,Hangup

;--== end of [app-blacklist-remove-invalid] ==--;


[app-blacklist-last]
exten => s,1,Answer
exten => s,n,Macro(user-callerid,)
exten => s,n,Wait(1)
exten => s,n,Set(lastcaller=${DB(CALLTRACE/${AMPUSER})})
exten => s,n,GotoIf($[ $[ "${lastcaller}" = "" ] | $[ "${lastcaller}" = "unknown" ] ]?noinfo)
exten => s,n,Playback(privacy-to-blacklist-last-caller&telephone-number)
exten => s,n,SayDigits(${lastcaller})
exten => s,n,Set(TIMEOUT(digit)=1)
exten => s,n,Set(TIMEOUT(response)=7)
exten => s,n,GosubIf($[${DIALPLAN_EXISTS(app-blacklist-last,${CHANNEL(language)})}]?app-blacklist-last,${CHANNEL(language)},1():app-blacklist-last,en,1())
exten => s,n,GotoIf($[ "${confirm}" = "1" ]?app-blacklist-last,1,1)
exten => s,n,Goto(end)
exten => s,n(noinfo),Playback(unidentified-no-callback)
exten => s,n,Hangup
exten => s,n,Noop(Waiting for input)
exten => s,n(end),Playback(sorry-youre-having-problems&goodbye)
exten => s,n,Hangup

exten => en,1,Read(confirm,if-correct-press&digits/1,,,,)
exten => en,n,Return()

exten => ja,1,Read(confirm,if-correct-press&digits/1&pleasepress,,,,)
exten => ja,n,Return()

exten => 1,1,Set(DB(blacklist/${lastcaller})=1)
exten => 1,n,Playback(num-was-successfully)
exten => 1,n,Playback(added)
exten => 1,n,Wait(1)
exten => 1,n,Hangup

exten => i,1,Playback(sorry-youre-having-problems&goodbye)
exten => i,n,Hangup

;--== end of [app-blacklist-last] ==--;


[app-userlogonoff]
exten => *12,1,Macro(user-logoff,)
exten => *12,n(hook_off),Hangup

exten => *11,1,Macro(user-logon,)
exten => *11,n(hook_on_1),Hangup

exten => _*11.,1,Macro(user-logon,${EXTEN:3},)
exten => _*11.,n(hook_on_2),Hangup

;--== end of [app-userlogonoff] ==--;


[macro-dial]
exten => s,1,Noop(Blind Transfer: ${BLINDTRANSFER}, Attended Transfer: ${ATTENDEDTRANSFER}, User: ${AMPUSER}, Alert Info: ${ALERT_INFO})
exten => s,n,ExecIf($["${ALERT_INFO}"="" & ${LEN(${AMPUSER})}!=0 & ${LEN(${BLINDTRANSFER})}=0 & ${LEN(${ATTENDEDTRANSFER})}=0]?Set(ALERT_INFO=RingAnswer))
exten => s,n,ExecIf($[${LEN(${BLINDTRANSFER})}!=0]?Set(ALERT_INFO=))
exten => s,n,ExecIf($[${LEN(${ATTENDEDTRANSFER})}!=0]?Set(ALERT_INFO=))
exten => s,n,ExecIf($[("${MOHCLASS}"!="default") & ("${MOHCLASS}"!="")]?Set(CHANNEL(musicclass)=${MOHCLASS}))
exten => s,n(dial),AGI(dialparties.agi)
exten => s,n,Noop(Returned from dialparties with no extensions to call and DIALSTATUS: ${DIALSTATUS})
exten => s,n,MacroExit()
exten => s,n(normdial),Noop(Returned from dialparties with groups to dial)
exten => s,n,Noop(ringall array ${FMGL_DIAL} )
exten => s,n,Set(__FMGL_DIAL=${FMGL_DIAL})
exten => s,n,Set(LOOPCNT=${FIELDQTY(FILTERED_DIAL,-)})
exten => s,n,Set(ITER=1)
exten => s,n(ndloopbegin),Set(__EXTTOCALL=${CUT(FILTERED_DIAL,-,${ITER})})
exten => s,n,Noop(Working with ${EXTTOCALL})
exten => s,n,ExecIf($["${RVOL}"!=""]?Set(HASH(__SIPHEADERS,Alert-Info)=${IF($["${ALERT_INFO}"!=""]?${ALERT_INFO}:Normal)}\;volume=${RVOL}))
exten => s,n,ExecIf($["${RVOL}"="" & "${DB(AMPUSER/${EXTTOCALL}/rvolume)}" != ""]?Set(HASH(__SIPHEADERS,Alert-Info)=${IF($["${ALERT_INFO}"!=""]?${ALERT_INFO}:Normal)}\;volume=${DB(AMPUSER/${EXTTOCALL}/rvolume)}))
exten => s,n,Set(ITER=$[${ITER}+1])
exten => s,n,GotoIf($[${ITER}<=${LOOPCNT}]?ndloopbegin)
exten => s,n,Macro(dial-ringall-predial-hook,)
exten => s,n,ExecIf($["${ivrreturn}" = "1"]?Set(ds=${ds}g))
exten => s,n(nddialapp),Dial(${ds}b(func-apply-sipheaders^s^1),)
exten => s,n,Set(DIALSTATUS=${IF($["${DIALSTATUS_CW}"!="" ]?${DIALSTATUS_CW}:${DIALSTATUS})})
exten => s,n,GosubIf($[("${SCREEN}" != "" & ("${DIALSTATUS}" = "TORTURE" | "${DIALSTATUS}" = "DONTCALL"))  | "${DIALSTATUS}" = "ANSWER"]?${DIALSTATUS},1())
exten => s,n(groupnoanswer),Noop(Returning since nobody answered)
exten => s,n,MacroExit()
exten => s,n(huntdial),Noop(Returned from dialparties with ${HuntMembers} hunt members to dial)
exten => s,n,Set(HuntLoop=0)
exten => s,n,ExecIf($[${LEN(${HuntMembers})}=0]?Set(HuntMembers=0))
exten => s,n(a22),GotoIf($[${HuntMembers} >= 1]?a30)
exten => s,n(huntnoanswer),Noop(Returning as there are no members left in the hunt group to ring)
exten => s,n,MacroExit()
exten => s,n(a30),Set(HuntMember=HuntMember${HuntLoop})
exten => s,n,GotoIf($[$["${CALLTRACE_HUNT}" != "" ] & $[$["${RingGroupMethod}" = "hunt" ] | $["${RingGroupMethod}" = "firstavailable"] | $["${RingGroupMethod}" = "firstnotonphone"]]]?a32:a35)
exten => s,n(a32),Set(CT_EXTEN=${CUT(FILTERED_DIAL,,$[${HuntLoop} + 1])})
exten => s,n,Set(__EXTTOCALL=${CT_EXTEN})
exten => s,n,Set(DB(CALLTRACE/${CT_EXTEN})=${CALLTRACE_HUNT})
exten => s,n,Goto(s,huntstart)
exten => s,n(a35),GotoIf($[$["${CALLTRACE_HUNT}" != "" ] & $["${RingGroupMethod}" = "memoryhunt" ]]?a36:a50)
exten => s,n(a36),Set(CTLoop=0)
exten => s,n(a37),GotoIf($[${CTLoop} > ${HuntLoop}]?huntstart)
exten => s,n,Set(CT_EXTEN=${CUT(FILTERED_DIAL,,$[${CTLoop} + 1])})
exten => s,n,Set(__EXTTOCALL=${CT_EXTEN})
exten => s,n,Set(DB(CALLTRACE/${CT_EXTEN})=${CALLTRACE_HUNT})
exten => s,n,Set(CTLoop=$[1 + ${CTLoop}])
exten => s,n,Goto(s,a37)
exten => s,n(huntstart),Noop(Hunt Dial Start)
exten => s,n,ExecIf($["${RVOL}"!=""]?Set(HASH(__SIPHEADERS,Alert-Info)=${IF($["${ALERT_INFO}"!=""]?${ALERT_INFO}:Normal)}\;volume=${RVOL}))
exten => s,n,ExecIf($["${RVOL}"="" & "${DB(AMPUSER/${EXTTOCALL}/rvolume)}" != ""]?Set(HASH(__SIPHEADERS,Alert-Info)=${IF($["${ALERT_INFO}"!=""]?${ALERT_INFO}:Normal)}\;volume=${DB(AMPUSER/${EXTTOCALL}/rvolume)}))
exten => s,n,Macro(dial-hunt-predial-hook,)
exten => s,n,ExecIf($["${ivrreturn}" = "1"]?Set(ds=${ds}g))
exten => s,n(hsdialapp),Dial(${${HuntMember}}${ds}b(func-apply-sipheaders^s^1),)
exten => s,n,GotoIf($["${DIALSTATUS}" = "ANSWER"]?ANSWER,1)
exten => s,n,Set(HuntLoop=$[1 + ${HuntLoop}])
exten => s,n,GotoIf($[$["${RingGroupMethod}" = "firstavailable"] | $["${RingGroupMethod}" = "firstnotonphone"]] & $[$["${DIALSTATUS}" != "CHANUNAVAIL"] & $["${DIALSTATUS}" != "CONGESTION"]]?huntreset:a46)
exten => s,n(huntreset),Set(HuntMembers=1)
exten => s,n(a46),Set(HuntMembers=$[${HuntMembers} - 1])
exten => s,n,Goto(s,a22)
exten => s,n(a50),Noop(Deleting: CALLTRACE/${CT_EXTEN} ${DB_DELETE(CALLTRACE/${CT_EXTEN})})
exten => s,n,Goto(s,huntstart)

exten => NOANSWER,1,Macro(vm,${SCREEN_EXTEN},BUSY,${IVR_RETVM})
exten => NOANSWER,n,GotoIf($["${IVR_RETVM}" != "RETURN" | "${IVR_CONTEXT}" = ""]?bye)
exten => NOANSWER,n,Return()
exten => NOANSWER,n,GotoIf($["${ivrreturn}" = "1"]?${IVR_CONTEXT},return,1)
exten => NOANSWER,n(bye),Noop(checking something else to do ?${ivrreturn}? IVR return!!)
exten => NOANSWER,n,Macro(hangupcall,)

exten => TORTURE,1,Goto(app-blackhole,musiconhold,1)
exten => TORTURE,n,Macro(hangupcall,)

exten => DONTCALL,1,Answer
exten => DONTCALL,n,Wait(1)
exten => DONTCALL,n,Zapateller()
exten => DONTCALL,n,Playback(ss-noservice)
exten => DONTCALL,n,Macro(hangupcall,)

exten => ANSWER,1(answered),Noop(Call successfully answered - Hanging up now)
exten => ANSWER,n,GotoIf($["${ivrreturn}" = "1"]?${IVR_CONTEXT},return,1)
exten => ANSWER,n(bye),Noop(checking something else to do ?${ivrreturn}? IVR return!!)
exten => ANSWER,n,Macro(hangupcall,)

exten => h,1,Macro(hangupcall,)

;--== end of [macro-dial] ==--;


[ext-local-confirm]
exten => _LC-.,1,ExecIf($["${DIRECTION}" = "INBOUND"]?Set(DIAL_OPTIONS=${STRREPLACE(DIAL_OPTIONS,T)}))
exten => _LC-.,n,Set(THISDIAL=${DB(DEVICE/${EXTEN:3}/dial)})
exten => _LC-.,n,GotoIf($["${THISDIAL:0:5}"!="PJSIP"]?dial)
exten => _LC-.,n,Noop(Debug: Found PJSIP Destination ${THISDIAL}, updating with PJSIP_DIAL_CONTACTS)
exten => _LC-.,n,Set(THISDIAL=${PJSIP_DIAL_CONTACTS(${EXTEN:3})})
exten => _LC-.,n(dial),Dial(${THISDIAL},${RT},${DIAL_OPTIONS}M(auto-confirm^${RG_IDX})b(func-apply-sipheaders^s^1))

;--== end of [ext-local-confirm] ==--;


[findmefollow-ringallv2]
exten => _FMPR-.,1,Set(CDR_PROP(disable)=true)
exten => _FMPR-.,n,Set(RingGroupMethod=)
exten => _FMPR-.,n,Set(USE_CONFIRMATION=)
exten => _FMPR-.,n,Set(RINGGROUP_INDEX=)
exten => _FMPR-.,n,Macro(simple-dial,${EXTEN:5},${FMREALPRERING})
exten => _FMPR-.,n,ExecIf($["${DIALSTATUS}" = "BUSY"]?Set(SHARED(FM_DND,${FMUNIQUE})=DND))
exten => _FMPR-.,n,Hangup

exten => _FMGL-.,1,Set(CDR_PROP(disable)=true)
exten => _FMGL-.,n,Set(DIALNUMS=${IF($[${LEN(${FMGL_DIAL})}>0]?${FMGL_DIAL}:${EXTEN:5})})
exten => _FMGL-.,n,Set(ENDLOOP=$[${EPOCH} + ${FMPRERING} + 2])
exten => _FMGL-.,n(start),GotoIf($["${SHARED(FM_DND,${FMUNIQUE})}" = "DND"]?dodnd)
exten => _FMGL-.,n,Wait(1)
exten => _FMGL-.,n,GotoIf($[${EPOCH} < ${ENDLOOP}]?start)
exten => _FMGL-.,n,Set(SHARED(FM_DND,${FMUNIQUE})=)
exten => _FMGL-.,n(dodial),Macro(dial,${FMGRPTIME},${DIAL_OPTIONS},${DIALNUMS})
exten => _FMGL-.,n,Hangup
exten => _FMGL-.,n+10(dodnd),Set(SHARED(FM_DND,${FMUNIQUE})=)
exten => _FMGL-.,n,GotoIf($["${FMPRIME}" = "FALSE"]?dodial)
exten => _FMGL-.,n,Hangup

;--== end of [findmefollow-ringallv2] ==--;


[app-chanspy]
exten => 555,1,Macro(user-callerid,)
exten => 555,n,Answer
exten => 555,n,Wait(1)
exten => 555,n,ChanSpy()
exten => 555,n,Hangup

;--== end of [app-chanspy] ==--;


[ext-test]
exten => 7777,1,Macro(user-callerid,)
exten => 7777,n,Goto(from-pstn,${EXTEN},1)

exten => h,1,Macro(hangupcall,)

;--== end of [ext-test] ==--;


[ext-did]
include => ext-did-0001
include => ext-did-0002
exten => foo,1,Noop(bar)

;--== end of [ext-did] ==--;


[ext-did-0002]
exten => 2485851210,1,Set(__DIRECTION=INBOUND)
exten => 2485851210,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2485851210,n,Set(__FROM_DID=${EXTEN})
exten => 2485851210,n,Set(returnhere=1)
exten => 2485851210,n,Gosub(app-blacklist-check,s,1())
exten => 2485851210,n(did),Set(CDR(did)=${FROM_DID})
exten => 2485851210,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2485851210,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2485851210,n,Set(__MOHCLASS=)
exten => 2485851210,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2485851210,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2485851210,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2485851210,n(post-reverse-charge),Noop()
exten => 2485851210,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2485851210,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2485851210,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2485851210,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2485851210,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2485851210,n(dest-ext),Goto(timeconditions,31,1)

exten => 2486582027,1,Set(__DIRECTION=INBOUND)
exten => 2486582027,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582027,n,Set(__FROM_DID=${EXTEN})
exten => 2486582027,n,Set(returnhere=1)
exten => 2486582027,n,Gosub(app-blacklist-check,s,1())
exten => 2486582027,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582027,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582027,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582027,n,Set(__MOHCLASS=)
exten => 2486582027,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582027,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582027,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582027,n(post-reverse-charge),Noop()
exten => 2486582027,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582027,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582027,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582027,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582027,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582027,n(dest-ext),Goto(from-did-direct,127,1)

exten => 2486582028,1,Set(__DIRECTION=INBOUND)
exten => 2486582028,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582028,n,Set(__FROM_DID=${EXTEN})
exten => 2486582028,n,Set(returnhere=1)
exten => 2486582028,n,Gosub(app-blacklist-check,s,1())
exten => 2486582028,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582028,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582028,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582028,n,Set(__MOHCLASS=)
exten => 2486582028,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582028,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582028,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582028,n(post-reverse-charge),Noop()
exten => 2486582028,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582028,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582028,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582028,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582028,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582028,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582028,n(dest-ext),Goto(timeconditions,37,1)

exten => 2486582029,1,Set(__DIRECTION=INBOUND)
exten => 2486582029,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582029,n,Set(__FROM_DID=${EXTEN})
exten => 2486582029,n,Set(returnhere=1)
exten => 2486582029,n,Gosub(app-blacklist-check,s,1())
exten => 2486582029,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582029,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582029,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582029,n,Set(__MOHCLASS=)
exten => 2486582029,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582029,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582029,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582029,n(post-reverse-charge),Noop()
exten => 2486582029,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582029,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582029,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582029,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582029,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582029,n(dest-ext),Goto(from-did-direct,129,1)

exten => 2486582030,1,Set(__DIRECTION=INBOUND)
exten => 2486582030,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582030,n,Set(__FROM_DID=${EXTEN})
exten => 2486582030,n,Set(returnhere=1)
exten => 2486582030,n,Gosub(app-blacklist-check,s,1())
exten => 2486582030,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582030,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582030,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582030,n,Set(__MOHCLASS=)
exten => 2486582030,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582030,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582030,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582030,n(post-reverse-charge),Noop()
exten => 2486582030,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582030,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582030,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582030,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582030,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582030,n(dest-ext),Goto(from-did-direct,130,1)

exten => 2486582031,1,Set(__DIRECTION=INBOUND)
exten => 2486582031,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582031,n,Set(__FROM_DID=${EXTEN})
exten => 2486582031,n,Set(returnhere=1)
exten => 2486582031,n,Gosub(app-blacklist-check,s,1())
exten => 2486582031,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582031,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582031,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582031,n,Set(__MOHCLASS=)
exten => 2486582031,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582031,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582031,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582031,n(post-reverse-charge),Noop()
exten => 2486582031,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582031,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582031,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582031,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582031,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582031,n(dest-ext),Goto(ext-group,331,1)

exten => 2486582032,1,Set(__DIRECTION=INBOUND)
exten => 2486582032,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582032,n,Set(__FROM_DID=${EXTEN})
exten => 2486582032,n,Set(returnhere=1)
exten => 2486582032,n,Gosub(app-blacklist-check,s,1())
exten => 2486582032,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582032,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582032,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582032,n,Set(__MOHCLASS=)
exten => 2486582032,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582032,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582032,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582032,n(post-reverse-charge),Noop()
exten => 2486582032,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582032,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582032,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582032,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582032,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582032,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582032,n(dest-ext),Goto(timeconditions,38,1)

exten => 2486582033,1,Set(__DIRECTION=INBOUND)
exten => 2486582033,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582033,n,Set(__FROM_DID=${EXTEN})
exten => 2486582033,n,Set(returnhere=1)
exten => 2486582033,n,Gosub(app-blacklist-check,s,1())
exten => 2486582033,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582033,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582033,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582033,n,Set(__MOHCLASS=)
exten => 2486582033,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582033,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582033,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582033,n(post-reverse-charge),Noop()
exten => 2486582033,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582033,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582033,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582033,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582033,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582033,n(dest-ext),Goto(from-did-direct,133,1)

exten => 2486582034,1,Set(__DIRECTION=INBOUND)
exten => 2486582034,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582034,n,Set(__FROM_DID=${EXTEN})
exten => 2486582034,n,Set(returnhere=1)
exten => 2486582034,n,Gosub(app-blacklist-check,s,1())
exten => 2486582034,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582034,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582034,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582034,n,Set(__MOHCLASS=)
exten => 2486582034,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582034,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582034,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582034,n(post-reverse-charge),Noop()
exten => 2486582034,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582034,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582034,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582034,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582034,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582034,n(dest-ext),Goto(from-did-direct,130,1)

exten => 2486582035,1,Set(__DIRECTION=INBOUND)
exten => 2486582035,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582035,n,Set(__FROM_DID=${EXTEN})
exten => 2486582035,n,Set(returnhere=1)
exten => 2486582035,n,Gosub(app-blacklist-check,s,1())
exten => 2486582035,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582035,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582035,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582035,n,Set(__MOHCLASS=)
exten => 2486582035,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582035,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582035,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582035,n(post-reverse-charge),Noop()
exten => 2486582035,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582035,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582035,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582035,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582035,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582035,n(dest-ext),Goto(from-did-direct,135,1)

exten => 2486582036,1,Set(__DIRECTION=INBOUND)
exten => 2486582036,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582036,n,Set(__FROM_DID=${EXTEN})
exten => 2486582036,n,Set(returnhere=1)
exten => 2486582036,n,Gosub(app-blacklist-check,s,1())
exten => 2486582036,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582036,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582036,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582036,n,Set(__MOHCLASS=)
exten => 2486582036,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582036,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582036,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582036,n(post-reverse-charge),Noop()
exten => 2486582036,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582036,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582036,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582036,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582036,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582036,n(dest-ext),Goto(from-did-direct,136,1)

exten => 2486582037,1,Set(__DIRECTION=INBOUND)
exten => 2486582037,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582037,n,Set(__FROM_DID=${EXTEN})
exten => 2486582037,n,Set(returnhere=1)
exten => 2486582037,n,Gosub(app-blacklist-check,s,1())
exten => 2486582037,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582037,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582037,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582037,n,Set(__MOHCLASS=)
exten => 2486582037,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582037,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582037,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582037,n(post-reverse-charge),Noop()
exten => 2486582037,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582037,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582037,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582037,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582037,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582037,n(dest-ext),Goto(from-did-direct,137,1)

exten => 2486582038,1,Set(__DIRECTION=INBOUND)
exten => 2486582038,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582038,n,Set(__FROM_DID=${EXTEN})
exten => 2486582038,n,Set(returnhere=1)
exten => 2486582038,n,Gosub(app-blacklist-check,s,1())
exten => 2486582038,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582038,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582038,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582038,n,Set(__MOHCLASS=)
exten => 2486582038,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582038,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582038,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582038,n(post-reverse-charge),Noop()
exten => 2486582038,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582038,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582038,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582038,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582038,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582038,n(dest-ext),Goto(from-did-direct,138,1)

exten => 2486582039,1,Set(__DIRECTION=INBOUND)
exten => 2486582039,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582039,n,Set(__FROM_DID=${EXTEN})
exten => 2486582039,n,Set(returnhere=1)
exten => 2486582039,n,Gosub(app-blacklist-check,s,1())
exten => 2486582039,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582039,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582039,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582039,n,Set(__MOHCLASS=)
exten => 2486582039,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582039,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582039,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582039,n(post-reverse-charge),Noop()
exten => 2486582039,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582039,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582039,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582039,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582039,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582039,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582039,n(dest-ext),Goto(timeconditions,40,1)

exten => 2486582040,1,Set(__DIRECTION=INBOUND)
exten => 2486582040,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582040,n,Set(__FROM_DID=${EXTEN})
exten => 2486582040,n,Set(returnhere=1)
exten => 2486582040,n,Gosub(app-blacklist-check,s,1())
exten => 2486582040,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582040,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582040,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582040,n,Set(__MOHCLASS=)
exten => 2486582040,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582040,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582040,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582040,n(post-reverse-charge),Noop()
exten => 2486582040,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582040,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582040,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582040,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582040,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582040,n(dest-ext),Goto(from-did-direct,140,1)

exten => 2486582041,1,Set(__DIRECTION=INBOUND)
exten => 2486582041,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582041,n,Set(__FROM_DID=${EXTEN})
exten => 2486582041,n,Set(returnhere=1)
exten => 2486582041,n,Gosub(app-blacklist-check,s,1())
exten => 2486582041,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582041,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582041,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582041,n,Set(__MOHCLASS=)
exten => 2486582041,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582041,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582041,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582041,n(post-reverse-charge),Noop()
exten => 2486582041,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582041,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582041,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582041,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582041,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582041,n(dest-ext),Goto(from-did-direct,141,1)

exten => 2486582042,1,Set(__DIRECTION=INBOUND)
exten => 2486582042,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582042,n,Set(__FROM_DID=${EXTEN})
exten => 2486582042,n,Set(returnhere=1)
exten => 2486582042,n,Gosub(app-blacklist-check,s,1())
exten => 2486582042,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582042,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582042,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582042,n,Set(__MOHCLASS=)
exten => 2486582042,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582042,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582042,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582042,n(post-reverse-charge),Noop()
exten => 2486582042,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582042,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582042,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582042,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582042,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582042,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582042,n(dest-ext),Goto(timeconditions,41,1)

exten => 2486582043,1,Set(__DIRECTION=INBOUND)
exten => 2486582043,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582043,n,Set(__FROM_DID=${EXTEN})
exten => 2486582043,n,Set(returnhere=1)
exten => 2486582043,n,Gosub(app-blacklist-check,s,1())
exten => 2486582043,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582043,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582043,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582043,n,Set(__MOHCLASS=)
exten => 2486582043,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582043,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582043,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582043,n(post-reverse-charge),Noop()
exten => 2486582043,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582043,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582043,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582043,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582043,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582043,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582043,n(dest-ext),Goto(timeconditions,42,1)

exten => 2486582044,1,Set(__DIRECTION=INBOUND)
exten => 2486582044,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582044,n,Set(__FROM_DID=${EXTEN})
exten => 2486582044,n,Set(returnhere=1)
exten => 2486582044,n,Gosub(app-blacklist-check,s,1())
exten => 2486582044,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582044,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582044,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582044,n,Set(__MOHCLASS=)
exten => 2486582044,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582044,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582044,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582044,n(post-reverse-charge),Noop()
exten => 2486582044,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582044,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582044,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582044,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582044,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582044,n(dest-ext),Goto(from-did-direct,144,1)

exten => 2486582045,1,Set(__DIRECTION=INBOUND)
exten => 2486582045,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582045,n,Set(__FROM_DID=${EXTEN})
exten => 2486582045,n,Set(returnhere=1)
exten => 2486582045,n,Gosub(app-blacklist-check,s,1())
exten => 2486582045,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582045,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582045,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582045,n,Set(__MOHCLASS=)
exten => 2486582045,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582045,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582045,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582045,n(post-reverse-charge),Noop()
exten => 2486582045,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582045,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582045,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582045,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582045,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582045,n(dest-ext),Goto(from-did-direct,145,1)

exten => 2486582046,1,Set(__DIRECTION=INBOUND)
exten => 2486582046,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582046,n,Set(__FROM_DID=${EXTEN})
exten => 2486582046,n,Set(returnhere=1)
exten => 2486582046,n,Gosub(app-blacklist-check,s,1())
exten => 2486582046,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582046,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582046,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582046,n,Set(__MOHCLASS=)
exten => 2486582046,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582046,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582046,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582046,n(post-reverse-charge),Noop()
exten => 2486582046,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582046,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582046,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582046,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582046,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582046,n(dest-ext),Goto(from-did-direct,146,1)

exten => 2486582047,1,Set(__DIRECTION=INBOUND)
exten => 2486582047,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582047,n,Set(__FROM_DID=${EXTEN})
exten => 2486582047,n,Set(returnhere=1)
exten => 2486582047,n,Gosub(app-blacklist-check,s,1())
exten => 2486582047,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582047,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582047,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582047,n,Set(__MOHCLASS=)
exten => 2486582047,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582047,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582047,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582047,n(post-reverse-charge),Noop()
exten => 2486582047,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582047,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582047,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582047,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582047,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582047,n(dest-ext),Goto(from-did-direct,147,1)

exten => 2486582048,1,Set(__DIRECTION=INBOUND)
exten => 2486582048,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582048,n,Set(__FROM_DID=${EXTEN})
exten => 2486582048,n,Set(returnhere=1)
exten => 2486582048,n,Gosub(app-blacklist-check,s,1())
exten => 2486582048,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582048,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582048,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582048,n,Set(__MOHCLASS=)
exten => 2486582048,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582048,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582048,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582048,n(post-reverse-charge),Noop()
exten => 2486582048,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582048,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582048,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582048,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582048,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582048,n(dest-ext),Goto(from-did-direct,148,1)

exten => 2486582049,1,Set(__DIRECTION=INBOUND)
exten => 2486582049,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582049,n,Set(__FROM_DID=${EXTEN})
exten => 2486582049,n,Set(returnhere=1)
exten => 2486582049,n,Gosub(app-blacklist-check,s,1())
exten => 2486582049,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582049,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582049,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582049,n,Set(__MOHCLASS=)
exten => 2486582049,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582049,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582049,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582049,n(post-reverse-charge),Noop()
exten => 2486582049,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582049,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582049,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582049,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582049,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582049,n(dest-ext),Goto(from-did-direct,149,1)

exten => 2486582050,1,Set(__DIRECTION=INBOUND)
exten => 2486582050,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582050,n,Set(__FROM_DID=${EXTEN})
exten => 2486582050,n,Set(returnhere=1)
exten => 2486582050,n,Gosub(app-blacklist-check,s,1())
exten => 2486582050,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582050,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582050,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582050,n,Set(__MOHCLASS=)
exten => 2486582050,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582050,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582050,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582050,n(post-reverse-charge),Noop()
exten => 2486582050,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582050,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582050,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582050,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582050,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582050,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582050,n(dest-ext),Goto(timeconditions,3,1)

exten => 2486582051,1,Set(__DIRECTION=INBOUND)
exten => 2486582051,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582051,n,Set(__FROM_DID=${EXTEN})
exten => 2486582051,n,Set(returnhere=1)
exten => 2486582051,n,Gosub(app-blacklist-check,s,1())
exten => 2486582051,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582051,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582051,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582051,n,Set(__MOHCLASS=)
exten => 2486582051,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582051,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582051,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582051,n(post-reverse-charge),Noop()
exten => 2486582051,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582051,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582051,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582051,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582051,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582051,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582051,n(dest-ext),Goto(timeconditions,4,1)

exten => 2486582052,1,Set(__DIRECTION=INBOUND)
exten => 2486582052,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582052,n,Set(__FROM_DID=${EXTEN})
exten => 2486582052,n,Set(returnhere=1)
exten => 2486582052,n,Gosub(app-blacklist-check,s,1())
exten => 2486582052,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582052,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582052,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582052,n,Set(__MOHCLASS=)
exten => 2486582052,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582052,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582052,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582052,n(post-reverse-charge),Noop()
exten => 2486582052,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582052,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582052,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582052,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582052,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582052,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582052,n(dest-ext),Goto(timeconditions,5,1)

exten => 2486582053,1,Set(__DIRECTION=INBOUND)
exten => 2486582053,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582053,n,Set(__FROM_DID=${EXTEN})
exten => 2486582053,n,Set(returnhere=1)
exten => 2486582053,n,Gosub(app-blacklist-check,s,1())
exten => 2486582053,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582053,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582053,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582053,n,Set(__MOHCLASS=)
exten => 2486582053,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582053,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582053,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582053,n(post-reverse-charge),Noop()
exten => 2486582053,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582053,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582053,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582053,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582053,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582053,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582053,n(dest-ext),Goto(timeconditions,6,1)

exten => 2486582054,1,Set(__DIRECTION=INBOUND)
exten => 2486582054,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582054,n,Set(__FROM_DID=${EXTEN})
exten => 2486582054,n,Set(returnhere=1)
exten => 2486582054,n,Gosub(app-blacklist-check,s,1())
exten => 2486582054,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582054,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582054,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582054,n,Set(__MOHCLASS=)
exten => 2486582054,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582054,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582054,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582054,n(post-reverse-charge),Noop()
exten => 2486582054,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582054,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582054,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582054,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582054,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582054,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582054,n(dest-ext),Goto(timeconditions,7,1)

exten => 2486582055,1,Set(__DIRECTION=INBOUND)
exten => 2486582055,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582055,n,Set(__FROM_DID=${EXTEN})
exten => 2486582055,n,Set(returnhere=1)
exten => 2486582055,n,Gosub(app-blacklist-check,s,1())
exten => 2486582055,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582055,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582055,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582055,n,Set(__MOHCLASS=)
exten => 2486582055,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582055,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582055,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582055,n(post-reverse-charge),Noop()
exten => 2486582055,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582055,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582055,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582055,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582055,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582055,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582055,n(dest-ext),Goto(timeconditions,8,1)

exten => 2486582056,1,Set(__DIRECTION=INBOUND)
exten => 2486582056,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582056,n,Set(__FROM_DID=${EXTEN})
exten => 2486582056,n,Set(returnhere=1)
exten => 2486582056,n,Gosub(app-blacklist-check,s,1())
exten => 2486582056,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582056,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582056,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582056,n,Set(__MOHCLASS=)
exten => 2486582056,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582056,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582056,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582056,n(post-reverse-charge),Noop()
exten => 2486582056,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582056,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582056,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582056,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582056,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582056,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582056,n(dest-ext),Goto(timeconditions,9,1)

exten => 2486582057,1,Set(__DIRECTION=INBOUND)
exten => 2486582057,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582057,n,Set(__FROM_DID=${EXTEN})
exten => 2486582057,n,Set(returnhere=1)
exten => 2486582057,n,Gosub(app-blacklist-check,s,1())
exten => 2486582057,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582057,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582057,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582057,n,Set(__MOHCLASS=)
exten => 2486582057,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582057,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582057,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582057,n(post-reverse-charge),Noop()
exten => 2486582057,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582057,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582057,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582057,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582057,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582057,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582057,n(dest-ext),Goto(timeconditions,10,1)

exten => 2486582058,1,Set(__DIRECTION=INBOUND)
exten => 2486582058,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582058,n,Set(__FROM_DID=${EXTEN})
exten => 2486582058,n,Set(returnhere=1)
exten => 2486582058,n,Gosub(app-blacklist-check,s,1())
exten => 2486582058,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582058,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582058,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582058,n,Set(__MOHCLASS=)
exten => 2486582058,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582058,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582058,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582058,n(post-reverse-charge),Noop()
exten => 2486582058,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582058,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582058,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582058,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582058,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582058,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582058,n(dest-ext),Goto(timeconditions,11,1)

exten => 2486582059,1,Set(__DIRECTION=INBOUND)
exten => 2486582059,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582059,n,Set(__FROM_DID=${EXTEN})
exten => 2486582059,n,Set(returnhere=1)
exten => 2486582059,n,Gosub(app-blacklist-check,s,1())
exten => 2486582059,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582059,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582059,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582059,n,Set(__MOHCLASS=)
exten => 2486582059,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582059,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582059,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582059,n(post-reverse-charge),Noop()
exten => 2486582059,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582059,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582059,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582059,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582059,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582059,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582059,n(dest-ext),Goto(timeconditions,12,1)

exten => 2486582060,1,Set(__DIRECTION=INBOUND)
exten => 2486582060,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582060,n,Set(__FROM_DID=${EXTEN})
exten => 2486582060,n,Set(returnhere=1)
exten => 2486582060,n,Gosub(app-blacklist-check,s,1())
exten => 2486582060,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582060,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582060,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582060,n,Set(__MOHCLASS=)
exten => 2486582060,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582060,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582060,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582060,n(post-reverse-charge),Noop()
exten => 2486582060,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582060,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582060,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582060,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582060,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582060,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582060,n(dest-ext),Goto(timeconditions,13,1)

exten => 2486582061,1,Set(__DIRECTION=INBOUND)
exten => 2486582061,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582061,n,Set(__FROM_DID=${EXTEN})
exten => 2486582061,n,Set(returnhere=1)
exten => 2486582061,n,Gosub(app-blacklist-check,s,1())
exten => 2486582061,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582061,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582061,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582061,n,Set(__MOHCLASS=)
exten => 2486582061,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582061,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582061,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582061,n(post-reverse-charge),Noop()
exten => 2486582061,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582061,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582061,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582061,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582061,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582061,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582061,n(dest-ext),Goto(timeconditions,14,1)

exten => 2486582062,1,Set(__DIRECTION=INBOUND)
exten => 2486582062,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582062,n,Set(__FROM_DID=${EXTEN})
exten => 2486582062,n,Set(returnhere=1)
exten => 2486582062,n,Gosub(app-blacklist-check,s,1())
exten => 2486582062,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582062,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582062,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582062,n,Set(__MOHCLASS=)
exten => 2486582062,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582062,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582062,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582062,n(post-reverse-charge),Noop()
exten => 2486582062,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582062,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582062,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582062,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582062,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582062,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582062,n(dest-ext),Goto(timeconditions,15,1)

exten => 2486582063,1,Set(__DIRECTION=INBOUND)
exten => 2486582063,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582063,n,Set(__FROM_DID=${EXTEN})
exten => 2486582063,n,Set(returnhere=1)
exten => 2486582063,n,Gosub(app-blacklist-check,s,1())
exten => 2486582063,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582063,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582063,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582063,n,Set(__MOHCLASS=)
exten => 2486582063,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582063,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582063,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582063,n(post-reverse-charge),Noop()
exten => 2486582063,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582063,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582063,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582063,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582063,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582063,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582063,n(dest-ext),Goto(timeconditions,16,1)

exten => 2486582064,1,Set(__DIRECTION=INBOUND)
exten => 2486582064,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582064,n,Set(__FROM_DID=${EXTEN})
exten => 2486582064,n,Set(returnhere=1)
exten => 2486582064,n,Gosub(app-blacklist-check,s,1())
exten => 2486582064,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582064,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582064,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582064,n,Set(__MOHCLASS=)
exten => 2486582064,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582064,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582064,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582064,n(post-reverse-charge),Noop()
exten => 2486582064,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582064,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582064,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582064,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582064,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582064,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582064,n(dest-ext),Goto(timeconditions,17,1)

exten => 2486582065,1,Set(__DIRECTION=INBOUND)
exten => 2486582065,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582065,n,Set(__FROM_DID=${EXTEN})
exten => 2486582065,n,Set(returnhere=1)
exten => 2486582065,n,Gosub(app-blacklist-check,s,1())
exten => 2486582065,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582065,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582065,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582065,n,Set(__MOHCLASS=)
exten => 2486582065,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582065,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582065,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582065,n(post-reverse-charge),Noop()
exten => 2486582065,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582065,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582065,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582065,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582065,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582065,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582065,n(dest-ext),Goto(timeconditions,18,1)

exten => 2486582066,1,Set(__DIRECTION=INBOUND)
exten => 2486582066,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582066,n,Set(__FROM_DID=${EXTEN})
exten => 2486582066,n,Set(returnhere=1)
exten => 2486582066,n,Gosub(app-blacklist-check,s,1())
exten => 2486582066,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582066,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582066,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582066,n,Set(__MOHCLASS=)
exten => 2486582066,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582066,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582066,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582066,n(post-reverse-charge),Noop()
exten => 2486582066,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582066,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582066,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582066,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582066,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582066,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582066,n(dest-ext),Goto(timeconditions,19,1)

exten => 2486582067,1,Set(__DIRECTION=INBOUND)
exten => 2486582067,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582067,n,Set(__FROM_DID=${EXTEN})
exten => 2486582067,n,Set(returnhere=1)
exten => 2486582067,n,Gosub(app-blacklist-check,s,1())
exten => 2486582067,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582067,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582067,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582067,n,Set(__MOHCLASS=)
exten => 2486582067,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582067,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582067,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582067,n(post-reverse-charge),Noop()
exten => 2486582067,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582067,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582067,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582067,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582067,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582067,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582067,n(dest-ext),Goto(timeconditions,20,1)

exten => 2486582068,1,Set(__DIRECTION=INBOUND)
exten => 2486582068,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582068,n,Set(__FROM_DID=${EXTEN})
exten => 2486582068,n,Set(returnhere=1)
exten => 2486582068,n,Gosub(app-blacklist-check,s,1())
exten => 2486582068,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582068,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582068,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582068,n,Set(__MOHCLASS=)
exten => 2486582068,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582068,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582068,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582068,n(post-reverse-charge),Noop()
exten => 2486582068,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582068,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582068,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582068,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582068,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582068,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582068,n(dest-ext),Goto(timeconditions,21,1)

exten => 2486582069,1,Set(__DIRECTION=INBOUND)
exten => 2486582069,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582069,n,Set(__FROM_DID=${EXTEN})
exten => 2486582069,n,Set(returnhere=1)
exten => 2486582069,n,Gosub(app-blacklist-check,s,1())
exten => 2486582069,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582069,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582069,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582069,n,Set(__MOHCLASS=)
exten => 2486582069,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582069,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582069,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582069,n(post-reverse-charge),Noop()
exten => 2486582069,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582069,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582069,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582069,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582069,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582069,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582069,n(dest-ext),Goto(timeconditions,22,1)

exten => 2486582070,1,Set(__DIRECTION=INBOUND)
exten => 2486582070,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582070,n,Set(__FROM_DID=${EXTEN})
exten => 2486582070,n,Set(returnhere=1)
exten => 2486582070,n,Gosub(app-blacklist-check,s,1())
exten => 2486582070,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582070,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582070,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582070,n,Set(__MOHCLASS=)
exten => 2486582070,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582070,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582070,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582070,n(post-reverse-charge),Noop()
exten => 2486582070,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582070,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582070,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582070,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582070,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582070,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582070,n(dest-ext),Goto(timeconditions,23,1)

exten => 2486582071,1,Set(__DIRECTION=INBOUND)
exten => 2486582071,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582071,n,Set(__FROM_DID=${EXTEN})
exten => 2486582071,n,Set(returnhere=1)
exten => 2486582071,n,Gosub(app-blacklist-check,s,1())
exten => 2486582071,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582071,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582071,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582071,n,Set(__MOHCLASS=)
exten => 2486582071,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582071,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582071,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582071,n(post-reverse-charge),Noop()
exten => 2486582071,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582071,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582071,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582071,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582071,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582071,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582071,n(dest-ext),Goto(timeconditions,25,1)

exten => 2486582072,1,Set(__DIRECTION=INBOUND)
exten => 2486582072,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582072,n,Set(__FROM_DID=${EXTEN})
exten => 2486582072,n,Set(returnhere=1)
exten => 2486582072,n,Gosub(app-blacklist-check,s,1())
exten => 2486582072,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582072,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582072,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582072,n,Set(__MOHCLASS=)
exten => 2486582072,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582072,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582072,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582072,n(post-reverse-charge),Noop()
exten => 2486582072,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582072,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582072,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582072,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582072,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582072,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582072,n(dest-ext),Goto(timeconditions,24,1)

exten => 2486582073,1,Set(__DIRECTION=INBOUND)
exten => 2486582073,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582073,n,Set(__FROM_DID=${EXTEN})
exten => 2486582073,n,Set(returnhere=1)
exten => 2486582073,n,Gosub(app-blacklist-check,s,1())
exten => 2486582073,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582073,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582073,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582073,n,Set(__MOHCLASS=)
exten => 2486582073,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582073,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582073,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582073,n(post-reverse-charge),Noop()
exten => 2486582073,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582073,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582073,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582073,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582073,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582073,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582073,n(dest-ext),Goto(timeconditions,25,1)

exten => 2486582074,1,Set(__DIRECTION=INBOUND)
exten => 2486582074,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582074,n,Set(__FROM_DID=${EXTEN})
exten => 2486582074,n,Set(returnhere=1)
exten => 2486582074,n,Gosub(app-blacklist-check,s,1())
exten => 2486582074,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582074,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582074,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582074,n,Set(__MOHCLASS=)
exten => 2486582074,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582074,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582074,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582074,n(post-reverse-charge),Noop()
exten => 2486582074,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582074,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582074,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582074,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582074,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582074,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582074,n(dest-ext),Goto(timeconditions,34,1)

exten => 2486582075,1,Set(__DIRECTION=INBOUND)
exten => 2486582075,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582075,n,Set(__FROM_DID=${EXTEN})
exten => 2486582075,n,Set(returnhere=1)
exten => 2486582075,n,Gosub(app-blacklist-check,s,1())
exten => 2486582075,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582075,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582075,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582075,n,Set(__MOHCLASS=)
exten => 2486582075,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582075,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582075,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582075,n(post-reverse-charge),Noop()
exten => 2486582075,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582075,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582075,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582075,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582075,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582075,n(dest-ext),Goto(from-did-direct,105,1)

exten => 2486582076,1,Set(__DIRECTION=INBOUND)
exten => 2486582076,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582076,n,Set(__FROM_DID=${EXTEN})
exten => 2486582076,n,Set(returnhere=1)
exten => 2486582076,n,Gosub(app-blacklist-check,s,1())
exten => 2486582076,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582076,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582076,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582076,n,Set(__MOHCLASS=)
exten => 2486582076,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582076,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582076,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582076,n(post-reverse-charge),Noop()
exten => 2486582076,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582076,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582076,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582076,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582076,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582076,n(dest-ext),Goto(timeconditions,31,1)

exten => 2486582077,1,Set(__DIRECTION=INBOUND)
exten => 2486582077,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582077,n,Set(__FROM_DID=${EXTEN})
exten => 2486582077,n,Set(returnhere=1)
exten => 2486582077,n,Gosub(app-blacklist-check,s,1())
exten => 2486582077,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582077,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582077,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582077,n,Set(__MOHCLASS=)
exten => 2486582077,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582077,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582077,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582077,n(post-reverse-charge),Noop()
exten => 2486582077,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582077,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582077,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582077,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582077,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582077,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582077,n(dest-ext),Goto(timeconditions,30,1)

exten => 2486582078,1,Set(__DIRECTION=INBOUND)
exten => 2486582078,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582078,n,Set(__FROM_DID=${EXTEN})
exten => 2486582078,n,Set(returnhere=1)
exten => 2486582078,n,Gosub(app-blacklist-check,s,1())
exten => 2486582078,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582078,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582078,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582078,n,Set(__MOHCLASS=)
exten => 2486582078,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582078,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582078,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582078,n(post-reverse-charge),Noop()
exten => 2486582078,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582078,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582078,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582078,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582078,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582078,n(dest-ext),Goto(timeconditions,31,1)

exten => 2486582079,1,Set(__DIRECTION=INBOUND)
exten => 2486582079,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582079,n,Set(__FROM_DID=${EXTEN})
exten => 2486582079,n,Set(returnhere=1)
exten => 2486582079,n,Gosub(app-blacklist-check,s,1())
exten => 2486582079,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582079,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582079,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582079,n,Set(__MOHCLASS=)
exten => 2486582079,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582079,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582079,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582079,n(post-reverse-charge),Noop()
exten => 2486582079,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582079,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582079,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582079,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582079,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582079,n(dest-ext),Goto(timeconditions,31,1)

exten => 2486582080,1,Set(__DIRECTION=INBOUND)
exten => 2486582080,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582080,n,Set(__FROM_DID=${EXTEN})
exten => 2486582080,n,Set(returnhere=1)
exten => 2486582080,n,Gosub(app-blacklist-check,s,1())
exten => 2486582080,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582080,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582080,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582080,n,Set(__MOHCLASS=)
exten => 2486582080,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582080,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582080,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582080,n(post-reverse-charge),Noop()
exten => 2486582080,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582080,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582080,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582080,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582080,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582080,n(dest-ext),Goto(timeconditions,31,1)

exten => 2486582081,1,Set(__DIRECTION=INBOUND)
exten => 2486582081,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582081,n,Set(__FROM_DID=${EXTEN})
exten => 2486582081,n,Set(returnhere=1)
exten => 2486582081,n,Gosub(app-blacklist-check,s,1())
exten => 2486582081,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582081,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582081,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582081,n,Set(__MOHCLASS=)
exten => 2486582081,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582081,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582081,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582081,n(post-reverse-charge),Noop()
exten => 2486582081,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582081,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582081,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582081,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582081,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582081,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582081,n(dest-ext),Goto(timeconditions,26,1)

exten => 2486582082,1,Set(__DIRECTION=INBOUND)
exten => 2486582082,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582082,n,Set(__FROM_DID=${EXTEN})
exten => 2486582082,n,Set(returnhere=1)
exten => 2486582082,n,Gosub(app-blacklist-check,s,1())
exten => 2486582082,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582082,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582082,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582082,n,Set(__MOHCLASS=)
exten => 2486582082,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582082,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582082,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582082,n(post-reverse-charge),Noop()
exten => 2486582082,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582082,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582082,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582082,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582082,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582082,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582082,n(dest-ext),Goto(timeconditions,27,1)

exten => 2486582083,1,Set(__DIRECTION=INBOUND)
exten => 2486582083,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582083,n,Set(__FROM_DID=${EXTEN})
exten => 2486582083,n,Set(returnhere=1)
exten => 2486582083,n,Gosub(app-blacklist-check,s,1())
exten => 2486582083,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582083,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582083,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582083,n,Set(__MOHCLASS=)
exten => 2486582083,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582083,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582083,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582083,n(post-reverse-charge),Noop()
exten => 2486582083,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582083,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582083,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582083,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582083,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582083,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582083,n(dest-ext),Goto(timeconditions,28,1)

exten => 2486582084,1,Set(__DIRECTION=INBOUND)
exten => 2486582084,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582084,n,Set(__FROM_DID=${EXTEN})
exten => 2486582084,n,Set(returnhere=1)
exten => 2486582084,n,Gosub(app-blacklist-check,s,1())
exten => 2486582084,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582084,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582084,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582084,n,Set(__MOHCLASS=)
exten => 2486582084,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582084,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582084,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582084,n(post-reverse-charge),Noop()
exten => 2486582084,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582084,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582084,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582084,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582084,n,Set(__ALERT_INFO=info=Triplet)
exten => 2486582084,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582084,n(dest-ext),Goto(timeconditions,44,1)

exten => 2486582085,1,Set(__DIRECTION=INBOUND)
exten => 2486582085,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582085,n,Set(__FROM_DID=${EXTEN})
exten => 2486582085,n,Set(returnhere=1)
exten => 2486582085,n,Gosub(app-blacklist-check,s,1())
exten => 2486582085,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582085,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582085,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582085,n,Set(__MOHCLASS=)
exten => 2486582085,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582085,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582085,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582085,n(post-reverse-charge),Noop()
exten => 2486582085,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582085,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582085,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582085,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582085,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582085,n(dest-ext),Goto(ext-local,vmi127,1)

exten => 2486582086,1,Set(__DIRECTION=INBOUND)
exten => 2486582086,n,Gosub(sub-record-check,s,1(in,${EXTEN},dontcare))
exten => 2486582086,n,Set(__FROM_DID=${EXTEN})
exten => 2486582086,n,Set(returnhere=1)
exten => 2486582086,n,Gosub(app-blacklist-check,s,1())
exten => 2486582086,n(did),Set(CDR(did)=${FROM_DID})
exten => 2486582086,n,GotoIf(${LEN(${BLDEST})}?${BLDEST})
exten => 2486582086,n(callerid),ExecIf($[ "${CALLERID(name)}" = "" ] ?Set(CALLERID(name)=${CALLERID(num)}))
exten => 2486582086,n,Set(__MOHCLASS=)
exten => 2486582086,n,Set(__REVERSAL_REJECT=FALSE)
exten => 2486582086,n,GotoIf($["${REVERSAL_REJECT}"!="TRUE"]?post-reverse-charge)
exten => 2486582086,n,GotoIf($["${CHANNEL(reversecharge)}"="1"]?macro-hangupcall)
exten => 2486582086,n(post-reverse-charge),Noop()
exten => 2486582086,n,Set(__CALLINGNAMEPRES_SV=${CALLERID(name-pres)})
exten => 2486582086,n,Set(__CALLINGNUMPRES_SV=${CALLERID(num-pres)})
exten => 2486582086,n,Set(CALLERID(name-pres)=allowed_not_screened)
exten => 2486582086,n,Set(CALLERID(num-pres)=allowed_not_screened)
exten => 2486582086,n(did-cid-hook),Noop(CallerID Entry Point)
exten => 2486582086,n(dest-ext),Goto(ivr-6,s,1)

;--== end of [ext-did-0002] ==--;


[ext-did-catchall]
exten => s,1,Noop(No DID or CID Match)
exten => s,n(a2),Answer
exten => s,n,Log(WARNING,Friendly Scanner from ${CUT(CUT(SIP_HEADER(Via), ,2),:,1)})
exten => s,n,Wait(2)
exten => s,n,Playback(ss-noservice)
exten => s,n,SayAlpha(${FROM_DID})
exten => s,n,Hangup

exten => _.,1,Set(__FROM_DID=${EXTEN})
exten => _.,n,Noop(Received an unknown call with DID set to ${EXTEN})
exten => _.,n,Goto(s,a2)

exten => h,1,Hangup

;--== end of [ext-did-catchall] ==--;


[from-trunk-sip-SIP-OUT]
exten => _.,1,Set(GROUP()=OUT_2)
exten => _.,n,Goto(from-trunk,${EXTEN},1)

;--== end of [from-trunk-sip-SIP-OUT] ==--;


[ext-trunk]
exten => 2,1,Set(TDIAL_STRING=SIP/SIP-OUT)
exten => 2,n,Set(DIAL_TRUNK=2)
exten => 2,n,Goto(ext-trunk,tdial,1)

exten => tdial,1,Set(OUTBOUND_GROUP=OUT_${DIAL_TRUNK})
exten => tdial,n,GotoIf($["${OUTMAXCHANS_${DIAL_TRUNK}}" = ""]?nomax)
exten => tdial,n,GotoIf($[${GROUP_COUNT(OUT_${DIAL_TRUNK})} >= ${OUTMAXCHANS_${DIAL_TRUNK}}]?hangit)
exten => tdial,n(nomax),ExecIf($["${CALLINGNAMEPRES_SV}" != ""]?Set(CALLERPRES(name-pres)=${CALLINGNAMEPRES_SV}))
exten => tdial,n,ExecIf($["${CALLINGNUMPRES_SV}" != ""]?Set(CALLERPRES(num-pres)=${CALLINGNUMPRES_SV}))
exten => tdial,n,Set(DIAL_NUMBER=${FROM_DID})
exten => tdial,n,GosubIf($["${PREFIX_TRUNK_${DIAL_TRUNK}}" != ""]?sub-flp-${DIAL_TRUNK},s,1())
exten => tdial,n,Set(OUTNUM=${OUTPREFIX_${DIAL_TRUNK}}${DIAL_NUMBER})
exten => tdial,n,Set(DIAL_TRUNK_OPTIONS=${IF($["${DB_EXISTS(TRUNK/${DIAL_TRUNK}/dialopts)}" = "1"]?${DB_RESULT}:${TRUNK_OPTIONS})})
exten => tdial,n,Dial(${TDIAL_STRING}/${OUTNUM}${TDIAL_SUFFIX},${TRUNK_RING_TIMER},${DIAL_TRUNK_OPTIONS})
exten => tdial,n,Set(CALLERID(number)=${CALLERID(number):0:40})
exten => tdial,n,Set(CALLERID(name)=${CALLERID(name):0:40})
exten => tdial,n(hangit),Hangup

;--== end of [ext-trunk] ==--;


[macro-prepend-cid]
exten => s,1,GotoIf($["${RGPREFIX}" = ""]?REPCID)
exten => s,n,GotoIf($["${RGPREFIX}" != "${CALLERID(name):0:${LEN(${RGPREFIX})}}"]?REPCID)
exten => s,n,Set(CALLERID(name)=${CALLERID(name):${LEN(${RGPREFIX})}})
exten => s,n,Set(_RGPREFIX=)
exten => s,n(REPCID),Set(_RGPREFIX=${ARG1})
exten => s,n,Set(CALLERID(name)=${RGPREFIX}${CALLERID(name)})

;--== end of [macro-prepend-cid] ==--;


[outbound-allroutes]
include => outrt-6 ; FCC And Emergency
include => outrt-4 ; 922
include => outrt-1 ; NANPA
include => outrt-5 ; INTNAT
exten => foo,1,Noop(bar)

;--== end of [outbound-allroutes] ==--;


[outrt-6] ; FCC And Emergency
exten => 111,1,Macro(user-callerid,LIMIT,EXTERNAL,)
exten => 111,n,Gosub(sub-record-check,s,1(out,${EXTEN},dontcare))
exten => 111,n,ExecIf($[ "${CALLEE_ACCOUNCODE}" != "" ] ?Set(CDR(accountcode)=${CALLEE_ACCOUNCODE}))
exten => 111,n,Set(_ROUTEID=6)
exten => 111,n,Set(_ROUTENAME=FCC And Emergency)
exten => 111,n,Set(EMERGENCYROUTE=YES)
exten => 111,n,Set(MOHCLASS=${IF($["${MOHCLASS}"=""]?default:${MOHCLASS})})
exten => 111,n,Set(_CALLERIDNAMEINTERNAL=${CALLERID(name)})
exten => 111,n,Set(_CALLERIDNUMINTERNAL=${CALLERID(num)})
exten => 111,n,Set(_EMAILNOTIFICATION=FALSE)
exten => 111,n,Set(_NODEST=)
exten => 111,n,Macro(dialout-trunk,2,${EXTEN},,off)
exten => 111,n,Macro(outisbusy,)

exten => 988,1,Macro(user-callerid,LIMIT,EXTERNAL,)
exten => 988,n,Gosub(sub-record-check,s,1(out,${EXTEN},dontcare))
exten => 988,n,ExecIf($[ "${CALLEE_ACCOUNCODE}" != "" ] ?Set(CDR(accountcode)=${CALLEE_ACCOUNCODE}))
exten => 988,n,Set(_ROUTEID=6)
exten => 988,n,Set(_ROUTENAME=FCC And Emergency)
exten => 988,n,Set(EMERGENCYROUTE=YES)
exten => 988,n,Set(MOHCLASS=${IF($["${MOHCLASS}"=""]?default:${MOHCLASS})})
exten => 988,n,Set(_CALLERIDNAMEINTERNAL=${CALLERID(name)})
exten => 988,n,Set(_CALLERIDNUMINTERNAL=${CALLERID(num)})
exten => 988,n,Set(_EMAILNOTIFICATION=FALSE)
exten => 988,n,Set(_NODEST=)
exten => 988,n,Macro(dialout-trunk,2,${EXTEN},,off)
exten => 988,n,Macro(outisbusy,)

exten => _N11,1,Macro(user-callerid,LIMIT,EXTERNAL,)
exten => _N11,n,Gosub(sub-record-check,s,1(out,${EXTEN},dontcare))
exten => _N11,n,ExecIf($[ "${CALLEE_ACCOUNCODE}" != "" ] ?Set(CDR(accountcode)=${CALLEE_ACCOUNCODE}))
exten => _N11,n,Set(_ROUTEID=6)
exten => _N11,n,Set(_ROUTENAME=FCC And Emergency)
exten => _N11,n,Set(EMERGENCYROUTE=YES)
exten => _N11,n,Set(MOHCLASS=${IF($["${MOHCLASS}"=""]?default:${MOHCLASS})})
exten => _N11,n,Set(_CALLERIDNAMEINTERNAL=${CALLERID(name)})
exten => _N11,n,Set(_CALLERIDNUMINTERNAL=${CALLERID(num)})
exten => _N11,n,Set(_EMAILNOTIFICATION=FALSE)
exten => _N11,n,Set(_NODEST=)
exten => _N11,n,Macro(dialout-trunk,2,${EXTEN},,off)
exten => _N11,n,Macro(outisbusy,)

exten => 8111,1,Macro(user-callerid,LIMIT,EXTERNAL,)
exten => 8111,n,Gosub(sub-record-check,s,1(out,${EXTEN},dontcare))
exten => 8111,n,ExecIf($[ "${CALLEE_ACCOUNCODE}" != "" ] ?Set(CDR(accountcode)=${CALLEE_ACCOUNCODE}))
exten => 8111,n,Set(_ROUTEID=6)
exten => 8111,n,Set(_ROUTENAME=FCC And Emergency)
exten => 8111,n,Set(EMERGENCYROUTE=YES)
exten => 8111,n,Set(MOHCLASS=${IF($["${MOHCLASS}"=""]?default:${MOHCLASS})})
exten => 8111,n,Set(_CALLERIDNAMEINTERNAL=${CALLERID(name)})
exten => 8111,n,Set(_CALLERIDNUMINTERNAL=${CALLERID(num)})
exten => 8111,n,Set(_EMAILNOTIFICATION=FALSE)
exten => 8111,n,Set(_NODEST=)
exten => 8111,n,Macro(dialout-trunk,2,${EXTEN:1},,off)
exten => 8111,n,Macro(outisbusy,)

exten => 8988,1,Macro(user-callerid,LIMIT,EXTERNAL,)
exten => 8988,n,Gosub(sub-record-check,s,1(out,${EXTEN},dontcare))
exten => 8988,n,ExecIf($[ "${CALLEE_ACCOUNCODE}" != "" ] ?Set(CDR(accountcode)=${CALLEE_ACCOUNCODE}))
exten => 8988,n,Set(_ROUTEID=6)
exten => 8988,n,Set(_ROUTENAME=FCC And Emergency)
exten => 8988,n,Set(EMERGENCYROUTE=YES)
exten => 8988,n,Set(MOHCLASS=${IF($["${MOHCLASS}"=""]?default:${MOHCLASS})})
exten => 8988,n,Set(_CALLERIDNAMEINTERNAL=${CALLERID(name)})
exten => 8988,n,Set(_CALLERIDNUMINTERNAL=${CALLERID(num)})
exten => 8988,n,Set(_EMAILNOTIFICATION=FALSE)
exten => 8988,n,Set(_NODEST=)
exten => 8988,n,Macro(dialout-trunk,2,${EXTEN:1},,off)
exten => 8988,n,Macro(outisbusy,)

exten => _8N11,1,Macro(user-callerid,LIMIT,EXTERNAL,)
exten => _8N11,n,Gosub(sub-record-check,s,1(out,${EXTEN},dontcare))
exten => _8N11,n,ExecIf($[ "${CALLEE_ACCOUNCODE}" != "" ] ?Set(CDR(accountcode)=${CALLEE_ACCOUNCODE}))
exten => _8N11,n,Set(_ROUTEID=6)
exten => _8N11,n,Set(_ROUTENAME=FCC And Emergency)
exten => _8N11,n,Set(EMERGENCYROUTE=YES)
exten => _8N11,n,Set(MOHCLASS=${IF($["${MOHCLASS}"=""]?default:${MOHCLASS})})
exten => _8N11,n,Set(_CALLERIDNAMEINTERNAL=${CALLERID(name)})
exten => _8N11,n,Set(_CALLERIDNUMINTERNAL=${CALLERID(num)})
exten => _8N11,n,Set(_EMAILNOTIFICATION=FALSE)
exten => _8N11,n,Set(_NODEST=)
exten => _8N11,n,Macro(dialout-trunk,2,${EXTEN:1},,off)
exten => _8N11,n,Macro(outisbusy,)

exten => 9111,1,Macro(user-callerid,LIMIT,EXTERNAL,)
exten => 9111,n,Gosub(sub-record-check,s,1(out,${EXTEN},dontcare))
exten => 9111,n,ExecIf($[ "${CALLEE_ACCOUNCODE}" != "" ] ?Set(CDR(accountcode)=${CALLEE_ACCOUNCODE}))
exten => 9111,n,Set(_ROUTEID=6)
exten => 9111,n,Set(_ROUTENAME=FCC And Emergency)
exten => 9111,n,Set(EMERGENCYROUTE=YES)
exten => 9111,n,Set(MOHCLASS=${IF($["${MOHCLASS}"=""]?default:${MOHCLASS})})
exten => 9111,n,Set(_CALLERIDNAMEINTERNAL=${CALLERID(name)})
exten => 9111,n,Set(_CALLERIDNUMINTERNAL=${CALLERID(num)})
exten => 9111,n,Set(_EMAILNOTIFICATION=FALSE)
exten => 9111,n,Set(_NODEST=)
exten => 9111,n,Macro(dialout-trunk,2,${EXTEN:1},,off)
exten => 9111,n,Macro(outisbusy,)

exten => 9988,1,Macro(user-callerid,LIMIT,EXTERNAL,)
exten => 9988,n,Gosub(sub-record-check,s,1(out,${EXTEN},dontcare))
exten => 9988,n,ExecIf($[ "${CALLEE_ACCOUNCODE}" != "" ] ?Set(CDR(accountcode)=${CALLEE_ACCOUNCODE}))
exten => 9988,n,Set(_ROUTEID=6)
exten => 9988,n,Set(_ROUTENAME=FCC And Emergency)
exten => 9988,n,Set(EMERGENCYROUTE=YES)
exten => 9988,n,Set(MOHCLASS=${IF($["${MOHCLASS}"=""]?default:${MOHCLASS})})
exten => 9988,n,Set(_CALLERIDNAMEINTERNAL=${CALLERID(name)})
exten => 9988,n,Set(_CALLERIDNUMINTERNAL=${CALLERID(num)})
exten => 9988,n,Set(_EMAILNOTIFICATION=FALSE)
exten => 9988,n,Set(_NODEST=)
exten => 9988,n,Macro(dialout-trunk,2,${EXTEN:1},,off)
exten => 9988,n,Macro(outisbusy,)

exten => _9N11,1,Macro(user-callerid,LIMIT,EXTERNAL,)
exten => _9N11,n,Gosub(sub-record-check,s,1(out,${EXTEN},dontcare))
exten => _9N11,n,ExecIf($[ "${CALLEE_ACCOUNCODE}" != "" ] ?Set(CDR(accountcode)=${CALLEE_ACCOUNCODE}))
exten => _9N11,n,Set(_ROUTEID=6)
exten => _9N11,n,Set(_ROUTENAME=FCC And Emergency)
exten => _9N11,n,Set(EMERGENCYROUTE=YES)
exten => _9N11,n,Set(MOHCLASS=${IF($["${MOHCLASS}"=""]?default:${MOHCLASS})})
exten => _9N11,n,Set(_CALLERIDNAMEINTERNAL=${CALLERID(name)})
exten => _9N11,n,Set(_CALLERIDNUMINTERNAL=${CALLERID(num)})
exten => _9N11,n,Set(_EMAILNOTIFICATION=FALSE)
exten => _9N11,n,Set(_NODEST=)
exten => _9N11,n,Macro(dialout-trunk,2,${EXTEN:1},,off)
exten => _9N11,n,Macro(outisbusy,)

;--== end of [outrt-6] ==--;


[outrt-4] ; 922
exten => 922,1,Macro(user-callerid,LIMIT,EXTERNAL,)
exten => 922,n,Gosub(sub-record-check,s,1(out,${EXTEN},dontcare))
exten => 922,n,ExecIf($[ "${CALLEE_ACCOUNCODE}" != "" ] ?Set(CDR(accountcode)=${CALLEE_ACCOUNCODE}))
exten => 922,n,Set(_ROUTEID=4)
exten => 922,n,Set(_ROUTENAME=922)
exten => 922,n,Set(EMERGENCYROUTE=YES)
exten => 922,n,Set(MOHCLASS=${IF($["${MOHCLASS}"=""]?default:${MOHCLASS})})
exten => 922,n,Set(_CALLERIDNAMEINTERNAL=${CALLERID(name)})
exten => 922,n,Set(_CALLERIDNUMINTERNAL=${CALLERID(num)})
exten => 922,n,Set(_EMAILNOTIFICATION=FALSE)
exten => 922,n,Set(_NODEST=)
exten => 922,n,Macro(dialout-trunk,2,${EXTEN},,off)
exten => 922,n,Macro(outisbusy,)

;--== end of [outrt-4] ==--;


[outrt-1] ; NANPA
exten => _NXXNXXXXXX,1,Macro(user-callerid,LIMIT,EXTERNAL,)
exten => _NXXNXXXXXX,n,Gosub(sub-record-check,s,1(out,${EXTEN},dontcare))
exten => _NXXNXXXXXX,n,ExecIf($[ "${CALLEE_ACCOUNCODE}" != "" ] ?Set(CDR(accountcode)=${CALLEE_ACCOUNCODE}))
exten => _NXXNXXXXXX,n,Set(_ROUTEID=1)
exten => _NXXNXXXXXX,n,Set(_ROUTENAME=NANPA)
exten => _NXXNXXXXXX,n,Set(MOHCLASS=${IF($["${MOHCLASS}"=""]?default:${MOHCLASS})})
exten => _NXXNXXXXXX,n,ExecIf($["${KEEPCID}"!="TRUE" & ${LEN(${DB(AMPUSER/${AMPUSER}/outboundcid)})}=0 & ${LEN(${TRUNKCIDOVERRIDE})}=0]?Set(TRUNKCIDOVERRIDE=2485851210))
exten => _NXXNXXXXXX,n,Set(_CALLERIDNAMEINTERNAL=${CALLERID(name)})
exten => _NXXNXXXXXX,n,Set(_CALLERIDNUMINTERNAL=${CALLERID(num)})
exten => _NXXNXXXXXX,n,Set(_EMAILNOTIFICATION=FALSE)
exten => _NXXNXXXXXX,n,Set(_NODEST=)
exten => _NXXNXXXXXX,n,Macro(dialout-trunk,2,${EXTEN},,off)
exten => _NXXNXXXXXX,n,Macro(outisbusy,)

exten => _NXXXXXX,1,Macro(user-callerid,LIMIT,EXTERNAL,)
exten => _NXXXXXX,n,Gosub(sub-record-check,s,1(out,${EXTEN},dontcare))
exten => _NXXXXXX,n,ExecIf($[ "${CALLEE_ACCOUNCODE}" != "" ] ?Set(CDR(accountcode)=${CALLEE_ACCOUNCODE}))
exten => _NXXXXXX,n,Set(_ROUTEID=1)
exten => _NXXXXXX,n,Set(_ROUTENAME=NANPA)
exten => _NXXXXXX,n,Set(MOHCLASS=${IF($["${MOHCLASS}"=""]?default:${MOHCLASS})})
exten => _NXXXXXX,n,ExecIf($["${KEEPCID}"!="TRUE" & ${LEN(${DB(AMPUSER/${AMPUSER}/outboundcid)})}=0 & ${LEN(${TRUNKCIDOVERRIDE})}=0]?Set(TRUNKCIDOVERRIDE=2485851210))
exten => _NXXXXXX,n,Set(_CALLERIDNAMEINTERNAL=${CALLERID(name)})
exten => _NXXXXXX,n,Set(_CALLERIDNUMINTERNAL=${CALLERID(num)})
exten => _NXXXXXX,n,Set(_EMAILNOTIFICATION=FALSE)
exten => _NXXXXXX,n,Set(_NODEST=)
exten => _NXXXXXX,n,Macro(dialout-trunk,2,248${EXTEN},,off)
exten => _NXXXXXX,n,Macro(outisbusy,)

exten => _+NXXNXXXXXX,1,Macro(user-callerid,LIMIT,EXTERNAL,)
exten => _+NXXNXXXXXX,n,Gosub(sub-record-check,s,1(out,${EXTEN},dontcare))
exten => _+NXXNXXXXXX,n,ExecIf($[ "${CALLEE_ACCOUNCODE}" != "" ] ?Set(CDR(accountcode)=${CALLEE_ACCOUNCODE}))
exten => _+NXXNXXXXXX,n,Set(_ROUTEID=1)
exten => _+NXXNXXXXXX,n,Set(_ROUTENAME=NANPA)
exten => _+NXXNXXXXXX,n,Set(MOHCLASS=${IF($["${MOHCLASS}"=""]?default:${MOHCLASS})})
exten => _+NXXNXXXXXX,n,ExecIf($["${KEEPCID}"!="TRUE" & ${LEN(${DB(AMPUSER/${AMPUSER}/outboundcid)})}=0 & ${LEN(${TRUNKCIDOVERRIDE})}=0]?Set(TRUNKCIDOVERRIDE=2485851210))
exten => _+NXXNXXXXXX,n,Set(_CALLERIDNAMEINTERNAL=${CALLERID(name)})
exten => _+NXXNXXXXXX,n,Set(_CALLERIDNUMINTERNAL=${CALLERID(num)})
exten => _+NXXNXXXXXX,n,Set(_EMAILNOTIFICATION=FALSE)
exten => _+NXXNXXXXXX,n,Set(_NODEST=)
exten => _+NXXNXXXXXX,n,Macro(dialout-trunk,2,${EXTEN:1},,off)
exten => _+NXXNXXXXXX,n,Macro(outisbusy,)

exten => _+NXXXXXX,1,Macro(user-callerid,LIMIT,EXTERNAL,)
exten => _+NXXXXXX,n,Gosub(sub-record-check,s,1(out,${EXTEN},dontcare))
exten => _+NXXXXXX,n,ExecIf($[ "${CALLEE_ACCOUNCODE}" != "" ] ?Set(CDR(accountcode)=${CALLEE_ACCOUNCODE}))
exten => _+NXXXXXX,n,Set(_ROUTEID=1)
exten => _+NXXXXXX,n,Set(_ROUTENAME=NANPA)
exten => _+NXXXXXX,n,Set(MOHCLASS=${IF($["${MOHCLASS}"=""]?default:${MOHCLASS})})
exten => _+NXXXXXX,n,ExecIf($["${KEEPCID}"!="TRUE" & ${LEN(${DB(AMPUSER/${AMPUSER}/outboundcid)})}=0 & ${LEN(${TRUNKCIDOVERRIDE})}=0]?Set(TRUNKCIDOVERRIDE=2485851210))
exten => _+NXXXXXX,n,Set(_CALLERIDNAMEINTERNAL=${CALLERID(name)})
exten => _+NXXXXXX,n,Set(_CALLERIDNUMINTERNAL=${CALLERID(num)})
exten => _+NXXXXXX,n,Set(_EMAILNOTIFICATION=FALSE)
exten => _+NXXXXXX,n,Set(_NODEST=)
exten => _+NXXXXXX,n,Macro(dialout-trunk,2,248${EXTEN:1},,off)
exten => _+NXXXXXX,n,Macro(outisbusy,)

exten => _+1NXXNXXXXXX,1,Macro(user-callerid,LIMIT,EXTERNAL,)
exten => _+1NXXNXXXXXX,n,Gosub(sub-record-check,s,1(out,${EXTEN},dontcare))
exten => _+1NXXNXXXXXX,n,ExecIf($[ "${CALLEE_ACCOUNCODE}" != "" ] ?Set(CDR(accountcode)=${CALLEE_ACCOUNCODE}))
exten => _+1NXXNXXXXXX,n,Set(_ROUTEID=1)
exten => _+1NXXNXXXXXX,n,Set(_ROUTENAME=NANPA)
exten => _+1NXXNXXXXXX,n,Set(MOHCLASS=${IF($["${MOHCLASS}"=""]?default:${MOHCLASS})})
exten => _+1NXXNXXXXXX,n,ExecIf($["${KEEPCID}"!="TRUE" & ${LEN(${DB(AMPUSER/${AMPUSER}/outboundcid)})}=0 & ${LEN(${TRUNKCIDOVERRIDE})}=0]?Set(TRUNKCIDOVERRIDE=2485851210))
exten => _+1NXXNXXXXXX,n,Set(_CALLERIDNAMEINTERNAL=${CALLERID(name)})
exten => _+1NXXNXXXXXX,n,Set(_CALLERIDNUMINTERNAL=${CALLERID(num)})
exten => _+1NXXNXXXXXX,n,Set(_EMAILNOTIFICATION=FALSE)
exten => _+1NXXNXXXXXX,n,Set(_NODEST=)
exten => _+1NXXNXXXXXX,n,Macro(dialout-trunk,2,${EXTEN:2},,off)
exten => _+1NXXNXXXXXX,n,Macro(outisbusy,)

exten => _1NXXNXXXXXX,1,Macro(user-callerid,LIMIT,EXTERNAL,)
exten => _1NXXNXXXXXX,n,Gosub(sub-record-check,s,1(out,${EXTEN},dontcare))
exten => _1NXXNXXXXXX,n,ExecIf($[ "${CALLEE_ACCOUNCODE}" != "" ] ?Set(CDR(accountcode)=${CALLEE_ACCOUNCODE}))
exten => _1NXXNXXXXXX,n,Set(_ROUTEID=1)
exten => _1NXXNXXXXXX,n,Set(_ROUTENAME=NANPA)
exten => _1NXXNXXXXXX,n,Set(MOHCLASS=${IF($["${MOHCLASS}"=""]?default:${MOHCLASS})})
exten => _1NXXNXXXXXX,n,ExecIf($["${KEEPCID}"!="TRUE" & ${LEN(${DB(AMPUSER/${AMPUSER}/outboundcid)})}=0 & ${LEN(${TRUNKCIDOVERRIDE})}=0]?Set(TRUNKCIDOVERRIDE=2485851210))
exten => _1NXXNXXXXXX,n,Set(_CALLERIDNAMEINTERNAL=${CALLERID(name)})
exten => _1NXXNXXXXXX,n,Set(_CALLERIDNUMINTERNAL=${CALLERID(num)})
exten => _1NXXNXXXXXX,n,Set(_EMAILNOTIFICATION=FALSE)
exten => _1NXXNXXXXXX,n,Set(_NODEST=)
exten => _1NXXNXXXXXX,n,Macro(dialout-trunk,2,${EXTEN:1},,off)
exten => _1NXXNXXXXXX,n,Macro(outisbusy,)

;--== end of [outrt-1] ==--;


[outrt-5] ; INTNAT
exten => _011.,1,Macro(user-callerid,LIMIT,EXTERNAL,)
exten => _011.,n,Gosub(sub-record-check,s,1(out,${EXTEN},dontcare))
exten => _011.,n,ExecIf($[ "${CALLEE_ACCOUNCODE}" != "" ] ?Set(CDR(accountcode)=${CALLEE_ACCOUNCODE}))
exten => _011.,n,Set(_ROUTEID=5)
exten => _011.,n,Set(_ROUTENAME=INTNAT)
exten => _011.,n,Set(MOHCLASS=${IF($["${MOHCLASS}"=""]?default:${MOHCLASS})})
exten => _011.,n,ExecIf($["${KEEPCID}"!="TRUE" & ${LEN(${DB(AMPUSER/${AMPUSER}/outboundcid)})}=0 & ${LEN(${TRUNKCIDOVERRIDE})}=0]?Set(TRUNKCIDOVERRIDE=2485851210))
exten => _011.,n,Set(_CALLERIDNAMEINTERNAL=${CALLERID(name)})
exten => _011.,n,Set(_CALLERIDNUMINTERNAL=${CALLERID(num)})
exten => _011.,n,Set(_EMAILNOTIFICATION=FALSE)
exten => _011.,n,Set(_NODEST=)
exten => _011.,n,Macro(dialout-trunk,2,${EXTEN},,off)
exten => _011.,n,Macro(outisbusy,)

exten => _+011.,1,Macro(user-callerid,LIMIT,EXTERNAL,)
exten => _+011.,n,Gosub(sub-record-check,s,1(out,${EXTEN},dontcare))
exten => _+011.,n,ExecIf($[ "${CALLEE_ACCOUNCODE}" != "" ] ?Set(CDR(accountcode)=${CALLEE_ACCOUNCODE}))
exten => _+011.,n,Set(_ROUTEID=5)
exten => _+011.,n,Set(_ROUTENAME=INTNAT)
exten => _+011.,n,Set(MOHCLASS=${IF($["${MOHCLASS}"=""]?default:${MOHCLASS})})
exten => _+011.,n,ExecIf($["${KEEPCID}"!="TRUE" & ${LEN(${DB(AMPUSER/${AMPUSER}/outboundcid)})}=0 & ${LEN(${TRUNKCIDOVERRIDE})}=0]?Set(TRUNKCIDOVERRIDE=2485851210))
exten => _+011.,n,Set(_CALLERIDNAMEINTERNAL=${CALLERID(name)})
exten => _+011.,n,Set(_CALLERIDNUMINTERNAL=${CALLERID(num)})
exten => _+011.,n,Set(_EMAILNOTIFICATION=FALSE)
exten => _+011.,n,Set(_NODEST=)
exten => _+011.,n,Macro(dialout-trunk,2,${EXTEN:1},,off)
exten => _+011.,n,Macro(outisbusy,)

;--== end of [outrt-5] ==--;


[macro-outisbusy]
exten => s,1,Progress
exten => s,n,GotoIf($["${EMERGENCYROUTE}" = "YES"]?emergency,1)
exten => s,n,GotoIf($["${INTRACOMPANYROUTE}" = "YES"]?intracompany,1)
exten => s,n,Playback(all-circuits-busy-now&please-try-call-later, noanswer)
exten => s,n,Congestion(20)
exten => s,n,Hangup

exten => intracompany,1,Playback(all-circuits-busy-now&please-try-call-later, noanswer)
exten => intracompany,n,Congestion(20)
exten => intracompany,n,Hangup

exten => emergency,1,Playback(all-circuits-busy-now&please-try-call-later)
exten => emergency,n,Congestion(20)
exten => emergency,n,Hangup

;--== end of [macro-outisbusy] ==--;


[app-blackhole]
exten => hangup,1,Noop(Blackhole Dest: Hangup)
exten => hangup,n,Hangup

exten => zapateller,1,Noop(Blackhole Dest: Play SIT Tone)
exten => zapateller,n,Answer
exten => zapateller,n,Zapateller()

exten => musiconhold,1,Noop(Blackhole Dest: Put caller on hold forever)
exten => musiconhold,n,Answer
exten => musiconhold,n,MusicOnHold()

exten => congestion,1,Noop(Blackhole Dest: Congestion)
exten => congestion,n,Progress
exten => congestion,n,Playtones(congestion)
exten => congestion,n,Congestion(20)
exten => congestion,n,Hangup

exten => busy,1,Noop(Blackhole Dest: Busy)
exten => busy,n,Progress
exten => busy,n,Busy(20)
exten => busy,n,Hangup

exten => ring,1,Noop(Blackhole Dest: Ring)
exten => ring,n,Answer
exten => ring,n,Playtones(ring)
exten => ring,n,Wait(300)
exten => ring,n,Hangup

exten => no-service,1,Noop(Blackhole Dest: No service)
exten => no-service,n,Answer
exten => no-service,n,Wait(1)
exten => no-service,n,Zapateller()
exten => no-service,n,Playback(ss-noservice)
exten => no-service,n,Hangup

;--== end of [app-blackhole] ==--;


[bad-number]
exten => _X.,1,ResetCDR()
exten => _X.,n,NoCDR()
exten => _X.,n,Progress
exten => _X.,n,Wait(1)
exten => _X.,n,Playback(silence/1&cannot-complete-as-dialed&check-number-dial-again,noanswer)
exten => _X.,n,Wait(1)
exten => _X.,n,Congestion(20)
exten => _X.,n,Hangup

exten => s,1,Goto(11,1)

;--== end of [bad-number] ==--;


[sub-presencestate-display]
exten => s,1,Goto(state-${TOLOWER(${PRESENCE_STATE(CustomPresence:${ARG1},value)})},1)

exten => state-available,1,Set(PRESENCESTATE_DISPLAY=(Available))
exten => state-available,n,Return()

exten => state-chat,1,Set(PRESENCESTATE_DISPLAY=(Chat))
exten => state-chat,n,Return()

exten => state-away,1,Set(PRESENCESTATE_DISPLAY=(Away))
exten => state-away,n,Return()

exten => state-dnd,1,Set(PRESENCESTATE_DISPLAY=(DND))
exten => state-dnd,n,Return()

exten => state-xa,1,Set(PRESENCESTATE_DISPLAY=(Extended Away))
exten => state-xa,n,Return()

exten => state-unavailable,1,Set(PRESENCESTATE_DISPLAY=(Unavailable))
exten => state-unavailable,n,Return()

exten => _state-.,1,Set(PRESENCESTATE_DISPLAY=)
exten => _state-.,n,Return()

exten => state-,1,Set(PRESENCESTATE_DISPLAY=)
exten => state-,n,Return()

;--== end of [sub-presencestate-display] ==--;


[macro-confirm]
exten => s,1,Set(LOOPCOUNT=0)
exten => s,n,Set(__MACRO_RESULT=ABORT)
exten => s,n,Set(MSG1=${IF($["${ARG1}${ALT_CONFIRM_MSG}"=""]?incoming-call-1-accept-2-decline:${IF($[${LEN(${ALT_CONFIRM_MSG})}>0]?${ALT_CONFIRM_MSG}:${ARG1})})})
exten => s,n(start),Background(${MSG1},m,${CHANNEL(language)},macro-confirm)
exten => s,n,Read(INPUT,,1,,,4)
exten => s,n,GotoIf($[${LEN(${INPUT})} > 0]?${INPUT},1:t,1)

exten => 1,1,GotoIf($["${DB_EXISTS(RG/${ARG3}/${UNIQCHAN})}"="0" & "${SHARED(ANSWER_STATUS,${FORCE_CONFIRM})}"=""]?toolate,1)
exten => 1,n,Noop(Deleting: RG/${ARG3}/${UNIQCHAN} ${DB_DELETE(RG/${ARG3}/${UNIQCHAN})})
exten => 1,n,Macro(blkvm-clr,)
exten => 1,n,Set(SHARED(ANSWER_STATUS,${FORCE_CONFIRM})=)
exten => 1,n(skip),Set(__MACRO_RESULT=)
exten => 1,n,ExecIf($[("${MOHCLASS}"!="default") & ("${MOHCLASS}"!="")]?Set(CHANNEL(musicclass)=${MOHCLASS}))
exten => 1,n(exitopt1),MacroExit()

exten => 2,1,Goto(noanswer,1)

exten => 3,1,SayDigits(${CALLCONFIRMCID})
exten => 3,n,GotoIf($["${DB_EXISTS(RG/${ARG3}/${UNIQCHAN})}"="0" & "${SHARED(ANSWER_STATUS,${FORCE_CONFIRM})}"=""]?toolate,1:s,start)

exten => t,1,GotoIf($["${DB_EXISTS(RG/${ARG3}/${UNIQCHAN})}"="0" & "${SHARED(ANSWER_STATUS,${FORCE_CONFIRM})}"=""]?toolate,1)
exten => t,n,Set(LOOPCOUNT=$[ ${LOOPCOUNT} + 1 ])
exten => t,n,GotoIf($[ ${LOOPCOUNT} < 5 ]?s,start:noanswer,1)

exten => _X,1,Background(invalid,m,${CHANNEL(language)},macro-confirm)
exten => _X,n,GotoIf($["${DB_EXISTS(RG/${ARG3}/${UNIQCHAN})}"="0" | "${SHARED(ANSWER_STATUS,${FORCE_CONFIRM})}"=""]?toolate,1)
exten => _X,n,Set(LOOPCOUNT=$[ ${LOOPCOUNT} + 1 ])
exten => _X,n,GotoIf($[ ${LOOPCOUNT} < 5 ]?s,start:noanswer,1)

exten => noanswer,1,Set(__MACRO_RESULT=ABORT)
exten => noanswer,n(exitnoanswer),MacroExit()

exten => toolate,1,Set(MSG2=${IF($["foo${ARG2}" != "foo"]?${ARG2}:"incoming-call-no-longer-avail")})
exten => toolate,n,Playback(${MSG2})
exten => toolate,n,Set(__MACRO_RESULT=ABORT)
exten => toolate,n(exittoolate),MacroExit()

exten => h,1,Macro(hangupcall,)

;--== end of [macro-confirm] ==--;


[macro-auto-confirm]
exten => s,1,Set(__MACRO_RESULT=)
exten => s,n,Set(CFIGNORE=)
exten => s,n,Set(MASTER_CHANNEL(CFIGNORE)=)
exten => s,n,Set(FORWARD_CONTEXT=from-internal)
exten => s,n,Set(MASTER_CHANNEL(FORWARD_CONTEXT)=from-internal)
exten => s,n,Macro(blkvm-clr,)
exten => s,n,Noop(Deleting: RG/${ARG1}/${UNIQCHAN} ${DB_DELETE(RG/${ARG1}/${UNIQCHAN})})
exten => s,n,ExecIf($[!${REGEX("[^0-9]" ${DIALEDPEERNUMBER})} && "${DB(AMPUSER/${AMPUSER}/cidname)}" != ""]?Set(MASTER_CHANNEL(CONNECTEDLINE(num))=${DIALEDPEERNUMBER}))
exten => s,n,ExecIf($[!${REGEX("[^0-9]" ${DIALEDPEERNUMBER})} && "${DB(AMPUSER/${AMPUSER}/cidname)}" != ""]?Set(MASTER_CHANNEL(CONNECTEDLINE(name))=${DB(AMPUSER/${DIALEDPEERNUMBER}/cidname)}))

;--== end of [macro-auto-confirm] ==--;


[sub-pincheck]
exten => s,1,Authenticate(${ARG3},)
exten => s,n,ResetCDR()
exten => s,n,Return()

;--== end of [sub-pincheck] ==--;


[sub-send-obroute-email]
exten => s,1,GotoIf($["${EMAILNOTIFICATION}" = "TRUE"]?sendEmail)
exten => s,n,Noop(email notifications disabled..exiting.)
exten => s,n,Return()
exten => s,n(sendEmail),AGI(outboundRouteEmail.php,${ARG1},${ARG2},${ARG3},${ARG4},${ARG5},${ARG6},${ROUTEID},${ROUTENAME},${CALLERIDNAMEINTERNAL},${CALLERIDNUMINTERNAL},${CHANNEL(LINKEDID)})
exten => s,n,Return()

;--== end of [sub-send-obroute-email] ==--;


[macro-dialout-trunk]
exten => s,1,Set(DIAL_TRUNK=${ARG1})
exten => s,n,ExecIf($["${DIRECTION}" = "INBOUND"]?Set(DIAL_OPTIONS=${STRREPLACE(DIAL_OPTIONS,T)}))
exten => s,n,GosubIf($[$["${ARG3}" != ""] & $["${DB(AMPUSER/${AMPUSER}/pinless)}" != "NOPASSWD"]]?sub-pincheck,s,1())
exten => s,n,GotoIf($["x${OUTDISABLE_${DIAL_TRUNK}}" = "xon"]?disabletrunk,1)
exten => s,n,Set(DIAL_NUMBER=${ARG2})
exten => s,n,Set(DIAL_TRUNK_OPTIONS=${DIAL_OPTIONS})
exten => s,n,Set(OUTBOUND_GROUP=OUT_${DIAL_TRUNK})
exten => s,n,Set(DIAL_TRUNK_OPTIONS=${IF($["${DB_EXISTS(TRUNK/${DIAL_TRUNK}/dialopts)}" = "1"]?${DB_RESULT}:${TRUNK_OPTIONS})})
exten => s,n,GotoIf($["${OUTMAXCHANS_${DIAL_TRUNK}}" = ""]?nomax)
exten => s,n,GotoIf($[ ${GROUP_COUNT(OUT_${DIAL_TRUNK})} >= ${OUTMAXCHANS_${DIAL_TRUNK}} ]?chanfull)
exten => s,n(nomax),GotoIf($["${INTRACOMPANYROUTE}" = "YES"]?skipoutcid)
exten => s,n,Macro(outbound-callerid,${DIAL_TRUNK})
exten => s,n(skipoutcid),GosubIf($["${PREFIX_TRUNK_${DIAL_TRUNK}}" != ""]?sub-flp-${DIAL_TRUNK},s,1())
exten => s,n,Set(OUTNUM=${OUTPREFIX_${DIAL_TRUNK}}${DIAL_NUMBER})
exten => s,n,Set(custom=${CUT(OUT_${DIAL_TRUNK},:,1)})
exten => s,n,ExecIf($["${MOHCLASS}"!="default" & "${MOHCLASS}"!="" & "${FORCE_CONFIRM}"="" ]?Set(DIAL_TRUNK_OPTIONS=M(setmusic^${MOHCLASS})${DIAL_TRUNK_OPTIONS}))
exten => s,n,ExecIf($["${FORCE_CONFIRM}"!="" ]?Set(DIAL_TRUNK_OPTIONS=${DIAL_TRUNK_OPTIONS}M(confirm)))
exten => s,n(gocall),Macro(dialout-trunk-predial-hook,)
exten => s,n,GotoIf($["${PREDIAL_HOOK_RET}" = "BYPASS"]?bypass,1)
exten => s,n,ExecIf($["${DB(AMPUSER/${AMPUSER}/cidname)}" != ""]?Set(CONNECTEDLINE(num,i)=${DIAL_NUMBER}))
exten => s,n,ExecIf($[$["${DB(AMPUSER/${AMPUSER}/cidname)}" != ""] & $["${CALLERID(name)}"!="hidden"]]?Set(CONNECTEDLINE(name,i)=CID:${CALLERID(number)}))
exten => s,n,ExecIf($[$["${DB(AMPUSER/${AMPUSER}/cidname)}" != ""] & $["${CALLERID(name)}"="hidden"]]?Set(CONNECTEDLINE(name,i)=CID:(Hidden)${CALLERID(number)}))
exten => s,n,GotoIf($["${custom}" = "AMP"]?customtrunk)
exten => s,n,ExecIf($["${DIRECTION}" = "INBOUND"]?Set(DIAL_TRUNK_OPTIONS=${STRREPLACE(DIAL_TRUNK_OPTIONS,T)}))
exten => s,n,Set(HASH(__SIPHEADERS,Alert-Info)=unset)
exten => s,n,Dial(${OUT_${DIAL_TRUNK}}/${OUTNUM}${OUT_${DIAL_TRUNK}_SUFFIX},${TRUNK_RING_TIMER},${DIAL_TRUNK_OPTIONS}b(func-apply-sipheaders^s^1,(${DIAL_TRUNK}))U(sub-send-obroute-email^${DIAL_NUMBER}^${MACRO_EXTEN}^${DIAL_TRUNK}^${NOW}^${CALLERID(name)}^${CALLERID(number)}))
exten => s,n,Noop(Dial failed for some reason with DIALSTATUS = ${DIALSTATUS} and HANGUPCAUSE = ${HANGUPCAUSE})
exten => s,n,GotoIf($["${ARG4}" = "on"]?continue,1:s-${DIALSTATUS},1)
exten => s,n(customtrunk),Set(pre_num=${CUT(OUT_${DIAL_TRUNK},$,1)})
exten => s,n,Set(the_num=${CUT(OUT_${DIAL_TRUNK},$,2)})
exten => s,n,Set(post_num=${CUT(OUT_${DIAL_TRUNK},$,3)})
exten => s,n,GotoIf($["${the_num}" = "OUTNUM"]?outnum:skipoutnum)
exten => s,n(outnum),Set(the_num=${OUTNUM})
exten => s,n(skipoutnum),Dial(${pre_num:4}${the_num}${post_num},${TRUNK_RING_TIMER},${DIAL_TRUNK_OPTIONS})
exten => s,n,Noop(Dial failed for some reason with DIALSTATUS = ${DIALSTATUS} and HANGUPCAUSE = ${HANGUPCAUSE})
exten => s,n,GotoIf($["${ARG4}" = "on"]?continue,1:s-${DIALSTATUS},1)
exten => s,n(chanfull),Noop(max channels used up)

exten => s-BUSY,1,Noop(Dial failed due to trunk reporting BUSY - giving up)
exten => s-BUSY,n,Playtones(busy)
exten => s-BUSY,n,Busy(20)

exten => s-ANSWER,1,Noop(Call successfully answered - Hanging up now)
exten => s-ANSWER,n,Macro(hangupcall,)

exten => s-NOANSWER,1,Noop(Dial failed due to trunk reporting NOANSWER - giving up)
exten => s-NOANSWER,n,Progress
exten => s-NOANSWER,n,Playback(number-not-answering,noanswer)
exten => s-NOANSWER,n,Congestion(20)

exten => s-INVALIDNMBR,1,Noop(Dial failed due to trunk reporting Address Incomplete - giving up)
exten => s-INVALIDNMBR,n,Progress
exten => s-INVALIDNMBR,n,Playback(ss-noservice,noanswer)
exten => s-INVALIDNMBR,n,Busy(20)

exten => s-CHANGED,1,Noop(Dial failed due to trunk reporting Number Changed - giving up)
exten => s-CHANGED,n,Playtones(busy)
exten => s-CHANGED,n,Busy(20)

exten => _s-.,1,Set(RC=${IF($[${ISNULL(${HANGUPCAUSE})}]?0:${HANGUPCAUSE})})
exten => _s-.,n,Goto(${RC},1)

exten => 17,1,Goto(s-BUSY,1)

exten => 18,1,Goto(s-NOANSWER,1)

exten => 22,1,Goto(s-CHANGED,1)

exten => 23,1,Goto(s-CHANGED,1)

exten => 1,1,Goto(s-INVALIDNMBR,1)

exten => 28,1,Goto(s-INVALIDNMBR,1)

exten => _X,1,Goto(continue,1)

exten => _X.,1,Goto(continue,1)

exten => continue,1(noreport),Noop(TRUNK Dial failed due to ${DIALSTATUS} HANGUPCAUSE: ${HANGUPCAUSE} - failing through to other trunks)
exten => continue,n,ExecIf($["${AMPUSER}"!="" ]?Set(CALLERID(number)=${AMPUSER}))

exten => disabletrunk,1,Noop(TRUNK: ${OUT_${DIAL_TRUNK}} DISABLED - falling through to next trunk)

exten => bypass,1,Noop(TRUNK: ${OUT_${DIAL_TRUNK}} BYPASSING because dialout-trunk-predial-hook)

exten => h,1,Macro(hangupcall,)

;--== end of [macro-dialout-trunk] ==--;


[macro-privacy-mgr]
exten => s,1,Set(KEEPCID=${CALLERID(num)})
exten => s,n,Set(TESTCID=${IF($["${CALLERID(num):0:1}"="+"]?${MATH(1+${CALLERID(num):1})}:${MATH(1+${CALLERID(num)})})})
exten => s,n,ExecIf($[${LEN(${TESTCID})}=0]?Set(CALLERID(num)=))
exten => s,n,PrivacyManager(${ARG1},${ARG2})
exten => s,n,GotoIf($["${PRIVACYMGRSTATUS}"="FAILED"]?fail)
exten => s,n,GosubIf($["${CALLED_BLACKLIST}"="1"]?app-blacklist-check,s,1())
exten => s,n,Set(CALLERID(num-pres)=allowed_passed_screen)
exten => s,n,MacroExit()
exten => s,n(fail),Noop(STATUS: ${PRIVACYMGRSTATUS} CID: ${CALLERID(num)} ${CALLERID(name)} CALLPRES: ${CALLLINGPRES})
exten => s,n,Playback(sorry-youre-having-problems&goodbye)
exten => s,n,Playtones(congestion)
exten => s,n,Congestion(20)

exten => h,1,Hangup

;--== end of [macro-privacy-mgr] ==--;


[macro-user-callerid]
exten => lang-playback,1,GosubIf($[${DIALPLAN_EXISTS(macro-user-callerid,${CHANNEL(language)})}]?macro-user-callerid,${CHANNEL(language)},${ARG1}():macro-user-callerid,en,${ARG1}())
exten => lang-playback,n,Return()

exten => s,1,Set(TOUCH_MONITOR=${UNIQUEID})
exten => s,n,Set(AMPUSER=${IF($["${AMPUSER}" = ""]?${CALLERID(number)}:${AMPUSER})})
exten => s,n,Set(HOTDESCKCHAN=${CUT(CHANNEL,/,2)})
exten => s,n,Set(HOTDESKEXTEN=${CUT(HOTDESCKCHAN,-,1)})
exten => s,n,Set(HOTDESKCALL=0)
exten => s,n,ExecIf($["${DB(EDEVICE/${HOTDESKEXTEN}/user)}"="DummyUser"]?Set(HOTDESKCALL=1))
exten => s,n,ExecIf($[${HOTDESKCALL}=1]?Set(CALLERID(name)=${DB(EDEVICE/${HOTDESKEXTEN}/location)}))
exten => s,n,GotoIf($["${CUT(CHANNEL,@,2):5:5}"="queue" | ${LEN(${AMPUSERCIDNAME})}]?report)
exten => s,n,ExecIf($["${REALCALLERIDNUM:1:2}" = ""]?Set(REALCALLERIDNUM=${CALLERID(number)}))
exten => s,n,Set(AMPUSER=${DB(DEVICE/${REALCALLERIDNUM}/user)})
exten => s,n,GotoIf($["${AMPUSER}" = "none"]?limit)
exten => s,n,Set(AMPUSERCIDNAME=${DB(AMPUSER/${AMPUSER}/cidname)})
exten => s,n,ExecIf($["${ARG2}" != "EXTERNAL" & ${DB_EXISTS(AMPUSER/${AMPUSER}/cidnum)} & "${AMPUSER}" != "${DB(AMPUSER/${AMPUSER}/cidnum)}"]?Set(__CIDMASQUERADING=TRUE))
exten => s,n,GotoIf($["${AMPUSERCIDNAME:1:2}" = ""]?report)
exten => s,n,Set(AMPUSERCID=${IF($["${ARG2}" != "EXTERNAL" & "${DB_EXISTS(AMPUSER/${AMPUSER}/cidnum)}" = "1"]?${DB_RESULT}:${AMPUSER})})
exten => s,n,Set(__DIAL_OPTIONS=${IF($["${DB_EXISTS(AMPUSER/${AMPUSER}/dialopts)}" = "1"]?${DB_RESULT}:${DIAL_OPTIONS})})
exten => s,n,Set(CALLERID(all)="${AMPUSERCIDNAME}" <${AMPUSERCID}>)
exten => s,n,GotoIf($["${ARG1}"="LIMIT" & ${LEN(${AMPUSER})} & ${DB_EXISTS(AMPUSER/${AMPUSER}/concurrency_limit)} & ${DB(AMPUSER/${AMPUSER}/concurrency_limit)}>0 & ${GROUP_COUNT(${AMPUSER}@concurrency_limit)}>=${DB(AMPUSER/${AMPUSER}/concurrency_limit)}]?limit)
exten => s,n,ExecIf($["${ARG1}"="LIMIT" & ${LEN(${AMPUSER})}]?Set(GROUP(concurrency_limit)=${AMPUSER}))
exten => s,n,ExecIf($["${DB(AMPUSER/${AMPUSER}/language)}" != ""]?Set(CHANNEL(language)=${DB(AMPUSER/${AMPUSER}/language)}))
exten => s,n(report),Noop(Macro Depth is ${MACRO_DEPTH})
exten => s,n,GotoIf($["${MACRO_DEPTH}" = "" | ${MACRO_DEPTH} < 6 ]?report2:macroerror)
exten => s,n(report2),GotoIf($[ "${ARG1}" = "SKIPTTL" | "${ARG1}" = "LIMIT" ]?continue)
exten => s,n,ExecIf($["${CALLEE_ACCOUNCODE}" = ""]?Set(__CALLEE_ACCOUNCODE=${DB(AMPUSER/${IF($["${MACRO_CONTEXT}"="macro-exten-vm"]?${ARG2}:${MACRO_EXTEN})}/accountcode)}))
exten => s,n(report3),Set(__TTL=${IF($["foo${TTL}" = "foo"]?64:$[ ${TTL} - 1 ])})
exten => s,n,GotoIf($[ ${TTL} > 0 ]?continue)
exten => s,n,Wait(${RINGTIMER})
exten => s,n,Answer
exten => s,n,Wait(1)
exten => s,n,Gosub(macro-user-callerid,lang-playback,1(hook_0))
exten => s,n,Macro(hangupcall,)
exten => s,n(macroerror),Noop(Macro Limit Reached. Aborting Call)
exten => s,n,Answer
exten => s,n,Wait(1)
exten => s,n,Gosub(macro-user-callerid,lang-playback,1(hook_2))
exten => s,n,Macro(hangupcall,)
exten => s,n(limit),Answer
exten => s,n,Wait(1)
exten => s,n,Gosub(macro-user-callerid,lang-playback,1(hook_1))
exten => s,n,Macro(hangupcall,)
exten => s,n,Congestion(20)
exten => s,n(continue),Set(CALLERID(number)=${CALLERID(number):0:40})
exten => s,n,Set(CALLERID(name)=${CALLERID(name):0:40})
exten => s,n,GotoIf($["${CALLERID(name)}" = ""]?cnum)
exten => s,n,Set(CDR(cnam)=${CALLERID(name)})
exten => s,n(cnum),Set(CDR(cnum)=${CALLERID(num)})
exten => s,n,Set(CHANNEL(language)=${MASTER_CHANNEL(CHANNEL(language))})

exten => h,1,Macro(hangupcall,)

exten => en,1(hook_0),Playback(im-sorry&an-error-has-occurred&with&call-forwarding)
exten => en,n,Return()
exten => en,n(hook_1),Playback(beep&im-sorry&your&simul-call-limit-reached&goodbye)
exten => en,n,Return()
exten => en,n(hook_2),Playback(im-sorry&an-error-has-occurred)
exten => en,n,Return()

exten => ja,1(hook_0),Playback(im-sorry&call-forwarding&jp-no&an-error-has-occured)
exten => ja,n,Return()
exten => ja,n(hook_1),Playback(beep&im-sorry&simul-call-limit-reached)
exten => ja,n,Return()
exten => ja,n(hook_2),Playback(im-sorry&an-error-has-occured)
exten => ja,n,Return()

;--== end of [macro-user-callerid] ==--;


[macro-outbound-callerid]
exten => s,1,ExecIf($["${CALLINGNAMEPRES_SV}" != ""]?Set(CALLERPRES(name-pres)=${CALLINGNAMEPRES_SV}))
exten => s,n,ExecIf($["${CALLINGNUMPRES_SV}" != ""]?Set(CALLERPRES(num-pres)=${CALLINGNUMPRES_SV}))
exten => s,n,Set(ALLOWTHISROUTE=NO)
exten => s,n,ExecIf($["${EMERGENCYROUTE}" = "YES"]?Set(ALLOWTHISROUTE=YES))
exten => s,n,ExecIf($[${HOTDESKCALL}= 1 & ${ALLOWTHISROUTE} = NO ]?Hangup())
exten => s,n,ExecIf($["${REALCALLERIDNUM:1:2}" = ""]?Set(REALCALLERIDNUM=${CALLERID(number)}))
exten => s,n,ExecIf($[$["${CIDMASQUERADING}" = "TRUE"] & $[$["${AMPUSER}" = ""] | $["${AMPUSER}" = "${DB(AMPUSER/${FROMEXTEN}/cidnum)}"]]]?Set(AMPUSER=${FROMEXTEN}))
exten => s,n(start),GotoIf($[ $["${REALCALLERIDNUM}" = ""] | $["${KEEPCID}" != "TRUE"] | $["${OUTKEEPCID_${ARG1}}" = "on"] ]?normcid)
exten => s,n,Set(USEROUTCID=${CALLERID(name)} <${REALCALLERIDNUM}>)
exten => s,n,GotoIf($["${CIDMASQUERADING}" = "TRUE"]?normcid)
exten => s,n,GotoIf($["foo${DB(AMPUSER/${REALCALLERIDNUM}/device)}" = "foo"]?bypass)
exten => s,n(normcid),Set(USEROUTCID=${DB(AMPUSER/${AMPUSER}/outboundcid)})
exten => s,n(bypass),Set(EMERGENCYCID=${DB(DEVICE/${REALCALLERIDNUM}/emergency_cid)})
exten => s,n,ExecIf($[${HOTDESKCALL}= 1]?Set(EMERGENCYCID=${DB(EDEVICE/${HOTDESKEXTEN}/emergency_cid)}))
exten => s,n,Set(TRUNKOUTCID=${OUTCID_${ARG1}})
exten => s,n,GotoIf($["${EMERGENCYROUTE:1:2}" = "" | "${EMERGENCYCID:1:2}" = ""]?trunkcid)
exten => s,n,Set(CALLERID(all)=${EMERGENCYCID})
exten => s,n,GotoIf($["${CALLERID(name)}" = ""]?cnum)
exten => s,n,Set(CDR(outbound_cnam)=${CALLERID(name)})
exten => s,n(cnum),Set(CDR(outbound_cnum)=${CALLERID(num)})
exten => s,n(exit),MacroExit()
exten => s,n(trunkcid),ExecIf($[${LEN(${TRUNKOUTCID})} != 0]?Set(CALLERID(all)=${TRUNKOUTCID}))
exten => s,n(usercid),ExecIf($[${LEN(${USEROUTCID})} != 0]?Set(CALLERID(all)=${USEROUTCID}))
exten => s,n,ExecIf($[${LEN(${TRUNKCIDOVERRIDE})} != 0 | ${LEN(${FORCEDOUTCID_${ARG1}})} != 0]?Set(CALLERID(all)=${IF($[${LEN(${FORCEDOUTCID_${ARG1}})}=0]?${TRUNKCIDOVERRIDE}:${FORCEDOUTCID_${ARG1}})}))
exten => s,n(hidecid),ExecIf($["${CALLERID(name)}"="hidden"]?Set(CALLERPRES(name-pres)=prohib_passed_screen))
exten => s,n,ExecIf($["${CALLERID(name)}"="hidden"]?Set(CALLERPRES(num-pres)=prohib_passed_screen))
exten => s,n,Set(CDR(outbound_cnum)=${CALLERID(num)})
exten => s,n,Set(CDR(outbound_cnam)=${CALLERID(name)})

;--== end of [macro-outbound-callerid] ==--;


[from-zaptel]
include => from-dahdi
exten => foo,1,Noop(bar)

;--== end of [from-zaptel] ==--;


[from-dahdi]
exten => _X.,1,Set(DID=${EXTEN})
exten => _X.,n,Goto(s,1)

exten => s,1,Noop(Entering from-dahdi with DID == ${DID})
exten => s,n,Ringing()
exten => s,n,Set(DID=${IF($["${DID}"= ""]?s:${DID})})
exten => s,n,Noop(DID is now ${DID})
exten => s,n,GotoIf($["${CHANNEL:0:5}"="DAHDI"]?dahdiok:checkzap)
exten => s,n(checkzap),GotoIf($["${CHANNEL:0:3}"="Zap"]?zapok:neither)
exten => s,n(neither),Goto(from-pstn,${DID},1)
exten => s,n,Macro(Hangupcall,dummy)
exten => s,n(dahdiok),Noop(Is a DAHDi Channel)
exten => s,n,Set(CHAN=${CHANNEL:6})
exten => s,n,Set(CHAN=${CUT(CHAN,-,1)})
exten => s,n,Macro(from-dahdi-${CHAN},${DID},1)
exten => s,n,Noop(Returned from Macro from-dahdi-${CHAN})
exten => s,n,Goto(from-pstn,${DID},1)
exten => s,n(zapok),Noop(Is a Zaptel Channel)
exten => s,n,Set(CHAN=${CHANNEL:4})
exten => s,n,Set(CHAN=${CUT(CHAN,-,1)})
exten => s,n,Macro(from-dahdi-${CHAN},${DID},1)
exten => s,n,Noop(Returned from Macro from-dahdi-${CHAN})
exten => s,n,Goto(from-pstn,${DID},1)

;--== end of [from-dahdi] ==--;


[macro-dial-confirm]
exten => s,1,Set(DB(RG/${ARG4}/${CHANNEL})=RINGING)
exten => s,n,Set(__UNIQCHAN=${CHANNEL})
exten => s,n,Set(USE_CONFIRMATION=TRUE)
exten => s,n,Set(RINGGROUP_INDEX=${ARG4})
exten => s,n,Set(FORCE_CONFIRM=)
exten => s,n,Set(ARG4=)
exten => s,n,Macro(dial,${ARG1},${ARG2},${ARG3})
exten => s,n,Noop(Deleting: RG/${RINGGROUP_INDEX}/${CHANNEL} ${DB_DELETE(RG/${RINGGROUP_INDEX}/${CHANNEL})})
exten => s,n,Set(USE_CONFIRMATION=)
exten => s,n,Set(RINGGROUP_INDEX=)

;--== end of [macro-dial-confirm] ==--;


[macro-setmusic]
exten => s,1,Set(CHANNEL(musicclass)=${ARG1})

;--== end of [macro-setmusic] ==--;


[macro-block-cf]
exten => _X.,1,Hangup

;--== end of [macro-block-cf] ==--;


[macro-vm]
exten => s,1,Macro(user-callerid,SKIPTTL)
exten => s,n,Set(VMGAIN=${IF($["foo${VM_GAIN}"!="foo"]?"g(${VM_GAIN})": )})
exten => s,n,Macro(blkvm-check,)
exten => s,n,GotoIf($["${GOSUB_RETVAL}" != "TRUE"]?vmx,1)
exten => s,n,Hangup

exten => vmx,1,Set(MEXTEN=${ARG1})
exten => vmx,n,Set(MMODE=${ARG2})
exten => vmx,n,Set(RETVM=${ARG3})
exten => vmx,n,Set(MODE=${IF($["${MMODE}"="BUSY"]?busy:unavail)})
exten => vmx,n,Macro(get-vmcontext,${MEXTEN})
exten => vmx,n,Set(MODE=${IF($[(${STAT(f,${ASTSPOOLDIR}/voicemail/${VMCONTEXT}/${MEXTEN}/temp.wav)} = 1) || (${STAT(f,${ASTSPOOLDIR}/voicemail/${VMCONTEXT}/${MEXTEN}/temp.WAV)} = 1)]?temp:${MODE})})
exten => vmx,n,Noop(MODE IS: ${MODE})
exten => vmx,n,GotoIf($["${DB(AMPUSER/${MEXTEN}/vmx/${MODE}/state)}" != "enabled"]?chknomsg)
exten => vmx,n,Set(VM_OPTS=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/vmxopts/timeout)}" = "1"]?${DB_RESULT}:${VM_OPTS})})
exten => vmx,n(chknomsg),GotoIf($["${MMODE}"="NOMESSAGE"]?s-${MMODE},1)
exten => vmx,n,GotoIf($["${MMODE}" != "DIRECTDIAL"]?notdirect)
exten => vmx,n,Set(MODE=${IF($["${REGEX("[b]" ${VM_DDTYPE})}" = "1"]?busy:${MODE})})
exten => vmx,n(notdirect),Noop(Checking if ext ${MEXTEN} is enabled: ${DB(AMPUSER/${MEXTEN}/vmx/${MODE}/state)})
exten => vmx,n,GotoIf($["${DB(AMPUSER/${MEXTEN}/vmx/${MODE}/state)}" != "enabled"]?s-${MMODE},1)
exten => vmx,n,GotoIf($[(${STAT(f,${ASTSPOOLDIR}/voicemail/${VMCONTEXT}/${MEXTEN}/temp.wav)} = 1) || (${STAT(f,${ASTSPOOLDIR}/voicemail/${VMCONTEXT}/${MEXTEN}/temp.WAV)} = 1)]?tmpgreet)
exten => vmx,n,GotoIf($[(${STAT(f,${ASTSPOOLDIR}/voicemail/${VMCONTEXT}/${MEXTEN}/${MODE}.wav)} = 0) && (${STAT(f,${ASTSPOOLDIR}/voicemail/${VMCONTEXT}/${MEXTEN}/${MODE}.WAV)} = 0)]?nofile)
exten => vmx,n,Set(VMX_TIMEOUT=2)
exten => vmx,n,Set(VMX_REPEAT=1)
exten => vmx,n,Set(VMX_LOOPS=1)
exten => vmx,n,Set(LOOPCOUNT=0)
exten => vmx,n,Set(VMX_REPEAT=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/repeat)}" = "1"]?${DB_RESULT}:${VMX_REPEAT})})
exten => vmx,n(vmxtime),Set(VMX_TIMEOUT=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/timeout)}" = "1"]?${DB_RESULT}:${VMX_TIMEOUT})})
exten => vmx,n(vmxloops),Set(VMX_LOOPS=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/loops)}" = "1"]?${DB_RESULT}:${VMX_LOOPS})})
exten => vmx,n(vmxanswer),Answer
exten => vmx,n(loopstart),Read(ACTION,${ASTSPOOLDIR}/voicemail/${VMCONTEXT}/${MEXTEN}/${MODE},1,skip,${VMX_REPEAT},${VMX_TIMEOUT})
exten => vmx,n,GotoIf($["${EXISTS(${ACTION})}" = "1"]?checkopt)
exten => vmx,n(noopt),Noop(Timeout: going to timeout dest)
exten => vmx,n,Set(VMX_OPTS=${DB(AMPUSER/${MEXTEN}/vmx/${MODE}/vmxopts/timeout)})
exten => vmx,n(chktime),GotoIf($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/timedest/ext)}" = "0"]?dotime)
exten => vmx,n,Set(VMX_TIMEDEST_EXT=${DB_RESULT})
exten => vmx,n,Set(VMX_TIMEDEST_CONTEXT=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/timedest/context)}" = "1"]?${DB_RESULT}:${VMX_TIMEDEST_CONTEXT})})
exten => vmx,n(timepri),Set(VMX_TIMEDEST_PRI=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/timedest/pri)}" = "1"]?${DB_RESULT}:${VMX_TIMEDEST_PRI})})
exten => vmx,n(dotime),Goto(${VMX_TIMEDEST_CONTEXT},${VMX_TIMEDEST_EXT},${VMX_TIMEDEST_PRI})
exten => vmx,n(checkopt),GotoIf($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/${ACTION}/ext)}" = "1"]?doopt)
exten => vmx,n,GotoIf($["${ACTION}" = "0"]?o,1)
exten => vmx,n,GotoIf($["${ACTION}" = "*"]?adef,1)
exten => vmx,n,Set(LOOPCOUNT=$[${LOOPCOUNT} + 1])
exten => vmx,n,GotoIf($["${LOOPCOUNT}" > "${VMX_LOOPS}"]?toomany)
exten => vmx,n,Playback(pm-invalid-option&please-try-again)
exten => vmx,n,Goto(loopstart)
exten => vmx,n(toomany),Noop(Too Many invalid entries, got to invalid dest)
exten => vmx,n,Set(VMX_OPTS=${VMX_OPTS_LOOP})
exten => vmx,n,Set(VMX_OPTS=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/vmxopts/loops)}" = "1"]?${DB_RESULT}:${VMX_OPTS})})
exten => vmx,n(chkloop),GotoIf($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/loopdest/ext)}" = "0"]?doloop)
exten => vmx,n,Set(VMX_LOOPDEST_EXT=${DB_RESULT})
exten => vmx,n,Set(VMX_LOOPDEST_CONTEXT=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/loopdest/context)}" = "1"]?${DB_RESULT}:${VMX_LOOPDEST_CONTEXT})})
exten => vmx,n(looppri),Set(VMX_LOOPDEST_PRI=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/loopdest/pri)}" = "1"]?${DB_RESULT}:${VMX_LOOPDEST_PRI})})
exten => vmx,n(doloop),Goto(${VMX_LOOPDEST_CONTEXT},${VMX_LOOPDEST_EXT},${VMX_LOOPDEST_PRI})
exten => vmx,n(doopt),Noop(Got a valid option: ${DB_RESULT})
exten => vmx,n,Set(VMX_EXT=${DB_RESULT})
exten => vmx,n,GotoIf($["${VMX_EXT}" != "dovm"]?getdest)
exten => vmx,n(vmxopts),Set(VMX_OPTS=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/vmxopts/dovm)}" = "1"]?${DB_RESULT}:${VMX_OPTS_DOVM})})
exten => vmx,n(vmxdovm),Goto(dovm,1)
exten => vmx,n(getdest),Set(VMX_CONTEXT=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/${ACTION}/context)}" = "1"]?${DB_RESULT}:${VMX_CONTEXT})})
exten => vmx,n(vmxpri),Set(VMX_PRI=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/${ACTION}/pri)}" = "1"]?${DB_RESULT}:${VMX_PRI})})
exten => vmx,n(vmxgoto),Goto(${VMX_CONTEXT},${VMX_EXT},${VMX_PRI})
exten => vmx,n(nofile),Noop(File for mode: ${MODE} does not exist, SYSTEMSTATUS: ${SYSTEMSTATUS}, going to normal voicemail)
exten => vmx,n,Goto(s-${MMODE},1)
exten => vmx,n(tmpgreet),Noop(Temporary Greeting Detected, going to normal voicemail)
exten => vmx,n,Goto(s-${MMODE},1)

exten => dovm,1,Noop(VMX Timeout - go to voicemail)
exten => dovm,n,VoiceMail(${MEXTEN}@${VMCONTEXT},${VMX_OPTS}${VMGAIN})
exten => dovm,n,Goto(exit-${VMSTATUS},1)

exten => s-BUSY,1,Noop(BUSY voicemail)
exten => s-BUSY,n,Macro(get-vmcontext,${MEXTEN})
exten => s-BUSY,n,VoiceMail(${MEXTEN}@${VMCONTEXT},${VM_OPTS}b${VMGAIN})
exten => s-BUSY,n,Goto(exit-${VMSTATUS},1)

exten => s-NOMESSAGE,1,Noop(NOMESSAGE (beep only) voicemail)
exten => s-NOMESSAGE,n,Macro(get-vmcontext,${MEXTEN})
exten => s-NOMESSAGE,n,VoiceMail(${MEXTEN}@${VMCONTEXT},s${VM_OPTS}${VMGAIN})
exten => s-NOMESSAGE,n,Goto(exit-${VMSTATUS},1)

exten => s-INSTRUCT,1,Noop(NOMESSAGE (beeb only) voicemail)
exten => s-INSTRUCT,n,Macro(get-vmcontext,${MEXTEN})
exten => s-INSTRUCT,n,VoiceMail(${MEXTEN}@${VMCONTEXT},${VM_OPTS}${VMGAIN})
exten => s-INSTRUCT,n,Goto(exit-${VMSTATUS},1)

exten => s-DIRECTDIAL,1,Noop(DIRECTDIAL voicemail)
exten => s-DIRECTDIAL,n,Macro(get-vmcontext,${MEXTEN})
exten => s-DIRECTDIAL,n,VoiceMail(${MEXTEN}@${VMCONTEXT},${VM_OPTS}${VM_DDTYPE}${VMGAIN})
exten => s-DIRECTDIAL,n,Goto(exit-${VMSTATUS},1)

exten => _s-.,1,Macro(get-vmcontext,${MEXTEN})
exten => _s-.,n,VoiceMail(${MEXTEN}@${VMCONTEXT},${VM_OPTS}u${VMGAIN})
exten => _s-.,n,Goto(exit-${VMSTATUS},1)

exten => o,1,Playback(one-moment-please)
exten => o,n,GotoIf($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/0/ext)}" = "0"]?doopdef)
exten => o,n,Set(VMX_OPDEST_EXT=${DB_RESULT})
exten => o,n(opcontext),Set(VMX_OPDEST_CONTEXT=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/0/context)}" = "1"]?${DB_RESULT}:${VMX_CONTEXT})})
exten => o,n(oppri),Set(VMX_OPDEST_PRI=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/0/pri)}" = "1"]?${DB_RESULT}:${VMX_PRI})})
exten => o,n,Goto(${VMX_OPDEST_CONTEXT},${VMX_OPDEST_EXT},${VMX_OPDEST_PRI})
exten => o,n(doopdef),GotoIf($["x${OPERATOR_XTN}"="x"]?nooper:from-internal,${OPERATOR_XTN},1)
exten => o,n(nooper),GotoIf($["x${FROM_DID}"="x"]?nodid)
exten => o,n,Dial(Local/${FROM_DID}@from-pstn,)
exten => o,n,Macro(hangup,)
exten => o,n(nodid),Dial(Local/s@from-pstn,)
exten => o,n,Macro(hangup,)

exten => a,1,Macro(get-vmcontext,${MEXTEN})
exten => a,n,GotoIf($["${DB_EXISTS(AMPUSER/${MEXTEN}/novmstar)}" = "1"]?s,1)
exten => a,n,GotoIf($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/*/ext)}" = "0"]?adef,1)
exten => a,n,Set(VMX_ADEST_EXT=${DB_RESULT})
exten => a,n(acontext),Set(VMX_ADEST_CONTEXT=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/*/context)}" = "1"]?${DB_RESULT}:${VMX_CONTEXT})})
exten => a,n(apri),Set(VMX_ADEST_PRI=${IF($["${DB_EXISTS(AMPUSER/${MEXTEN}/vmx/${MODE}/*/pri)}" = "1"]?${DB_RESULT}:${VMX_PRI})})
exten => a,n,Goto(${VMX_ADEST_CONTEXT},${VMX_ADEST_EXT},${VMX_ADEST_PRI})

exten => adef,1,VoiceMailMain(${MEXTEN}@${VMCONTEXT})
exten => adef,n,GotoIf($["${RETVM}" = "RETURN"]?exit-RETURN,1)
exten => adef,n,Hangup

exten => exit-FAILED,1,Playback(im-sorry&an-error-has-occurred)
exten => exit-FAILED,n,GotoIf($["${RETVM}" = "RETURN"]?exit-RETURN,1)
exten => exit-FAILED,n,Hangup

exten => exit-SUCCESS,1,GotoIf($["${RETVM}" = "RETURN"]?exit-RETURN,1)
exten => exit-SUCCESS,n,Playback(goodbye)
exten => exit-SUCCESS,n,Hangup

exten => exit-USEREXIT,1,GotoIf($["${RETVM}" = "RETURN"]?exit-RETURN,1)
exten => exit-USEREXIT,n,Playback(goodbye)
exten => exit-USEREXIT,n,Hangup

exten => exit-RETURN,1,Noop(Returning From Voicemail because macro)
exten => exit-RETURN,n,GotoIf($["${RETVM}" = "RETURN"]?ext-local,vmret,1)

exten => t,1,Hangup

;--== end of [macro-vm] ==--;


[macro-exten-vm]
exten => s,1,Macro(user-callerid,)
exten => s,n,Set(RingGroupMethod=none)
exten => s,n,Set(__EXTTOCALL=${ARG2})
exten => s,n,Set(__PICKUPMARK=${ARG2})
exten => s,n,Set(RT=${IF($["${ARG1}"!="novm" | "${DB(CFU/${EXTTOCALL})}"!="" | "${DB(CFB/${EXTTOCALL})}"!="" | "${ARG3}"="1" | "${ARG4}"="1" | "${ARG5}"="1"]?${RINGTIMER}:)})
exten => s,n(checkrecord),Gosub(sub-record-check,s,1(exten,${EXTTOCALL},dontcare))
exten => s,n,GotoIf($["${CUT(CHANNEL,@,2):5:5}"="queue"|"${AMPUSER}"=""|${LEN(${FROM_DID})}|"${DB(AMPUSER/${EXTTOCALL}/answermode)}"!="intercom"|${LEN(${BLINDTRANSFER})}|"${EXTENSION_STATE(${EXTTOCALL})}"!="NOT_INUSE"|"${CC_RECALL}"!=""]?macrodial)
exten => s,n,Set(INTERCOM_EXT_DOPTIONS=${DIAL_OPTIONS})
exten => s,n,Set(INTERCOM_RETURN=TRUE)
exten => s,n,Gosub(ext-intercom,*80${EXTTOCALL},1())
exten => s,n,Set(INTERCOM_RETURN=)
exten => s,n,Set(INTERCOM_EXT_DOPTIONS=)
exten => s,n(macrodial),GosubIf($["${INTERCOM_CALL}"="TRUE" & ${LEN(${BLINDTRANSFER})}]?clrheader,1())
exten => s,n,Macro(dial-one,${RT},${DIAL_OPTIONS},${EXTTOCALL})
exten => s,n,Set(SV_DIALSTATUS=${DIALSTATUS})
exten => s,n(calldocfu),GosubIf($[("${SV_DIALSTATUS}"="NOANSWER"|"${SV_DIALSTATUS}"="CHANUNAVAIL") & "${DB(CFU/${EXTTOCALL})}"!="" & "${SCREEN}"=""]?docfu,1())
exten => s,n(calldocfb),GosubIf($["${SV_DIALSTATUS}"="BUSY" & "${DB(CFB/${EXTTOCALL})}"!="" & "${SCREEN}"=""]?docfb,1())
exten => s,n,Set(DIALSTATUS=${SV_DIALSTATUS})
exten => s,n,ExecIf($[("${DIALSTATUS}"="NOANSWER"&"${ARG3}"="1")|("${DIALSTATUS}"="BUSY"&"${ARG4}"="1")|("${DIALSTATUS}"="CHANUNAVAIL"&"${ARG5}"="1")]?MacroExit())
exten => s,n,GotoIf($["${ARG1}"="novm"]?s-${DIALSTATUS},1)
exten => s,n,Macro(vm,${ARG1},${DIALSTATUS},${IVR_RETVM})

exten => docfu,1(docfu),ExecIf($["${DB(AMPUSER/${EXTTOCALL}/cfringtimer)}"="-1"|("${ARG1}"="novm"&"${ARG3}"="1")]?StackPop())
exten => docfu,n,GotoIf($["${DB(AMPUSER/${EXTTOCALL}/cfringtimer)}"="-1"|("${ARG1}"="novm"&"${ARG3}"="1")]?from-internal,${DB(CFU/${EXTTOCALL})},1)
exten => docfu,n,Set(RTCF=${IF($["${DB(AMPUSER/${EXTTOCALL}/cfringtimer)}"="0"]?${RT}:${DB(AMPUSER/${EXTTOCALL}/cfringtimer)})})
exten => docfu,n,ExecIf($["${DIRECTION}" = "INBOUND"]?Set(DIAL_OPTIONS=${STRREPLACE(DIAL_OPTIONS,T)}))
exten => docfu,n,Dial(Local/${DB(CFU/${EXTTOCALL})}@from-internal/n,${RTCF},${DIAL_OPTIONS})
exten => docfu,n,Return()

exten => docfb,1(docfu),ExecIf($["${DB(AMPUSER/${EXTTOCALL}/cfringtimer)}"="-1"|("${ARG1}"="novm"&"${ARG4}"="1")]?StackPop())
exten => docfb,n,GotoIf($["${DB(AMPUSER/${EXTTOCALL}/cfringtimer)}"="-1"|("${ARG1}"="novm"&"${ARG4}"="1")]?from-internal,${DB(CFB/${EXTTOCALL})},1)
exten => docfb,n,Set(RTCF=${IF($["${DB(AMPUSER/${EXTTOCALL}/cfringtimer)}"="0"]?${RT}:${DB(AMPUSER/${EXTTOCALL}/cfringtimer)})})
exten => docfb,n,ExecIf($["${DIRECTION}" = "INBOUND"]?Set(DIAL_OPTIONS=${STRREPLACE(DIAL_OPTIONS,T)}))
exten => docfb,n,Dial(Local/${DB(CFB/${EXTTOCALL})}@from-internal/n,${RTCF},${DIAL_OPTIONS})
exten => docfb,n,Return()

exten => clrheader,1,ExecIf($[${LEN(${SIPURI})}&"${SIPURI}"="${SIP_URI_OPTIONS}"]?Set(SIP_URI_OPTIONS=))
exten => clrheader,n,ExecIf($[${LEN(${ALERTINFO})}]?SIPRemoveHeader(${ALERTINFO}))
exten => clrheader,n,ExecIf($[${LEN(${CALLINFO})}]?SIPRemoveHeader(${CALLINFO}))
exten => clrheader,n,Return()

exten => s-BUSY,1,GotoIf($["${IVR_RETVM}"="RETURN" & "${IVR_CONTEXT}"!=""]?exit,1)
exten => s-BUSY,n,Playtones(busy)
exten => s-BUSY,n,Busy(20)

exten => _s-!,1,GotoIf($["${IVR_RETVM}"="RETURN" & "${IVR_CONTEXT}"!=""]?exit,1)
exten => _s-!,n,Playtones(congestion)
exten => _s-!,n,Congestion(10)

exten => exit,1,Playback(beep&line-busy-transfer-menu&silence/1)
exten => exit,n,MacroExit()

;--== end of [macro-exten-vm] ==--;


[macro-simple-dial]
exten => s,1,Set(__EXTTOCALL=${ARG1})
exten => s,n,Set(RT=${ARG2})
exten => s,n,Set(CFUEXT=${DB(CFU/${EXTTOCALL})})
exten => s,n,Set(CFBEXT=${DB(CFB/${EXTTOCALL})})
exten => s,n,Set(CWI_TMP=${CWIGNORE})
exten => s,n(macrodial),Macro(dial-one,${RT},${DIAL_OPTIONS},${EXTTOCALL})
exten => s,n,Set(__CWIGNORE=${CWI_TMP})
exten => s,n,Set(PR_DIALSTATUS=${DIALSTATUS})
exten => s,n(calldocfu),GosubIf($["${PR_DIALSTATUS}"="NOANSWER" & "${CFUEXT}"!=""]?docfu,1())
exten => s,n(calldocfb),GosubIf($["${PR_DIALSTATUS}"="BUSY" & "${CFBEXT}"!=""]?docfb,1())
exten => s,n,Set(DIALSTATUS=${PR_DIALSTATUS})
exten => s,n,Goto(s-${DIALSTATUS},1)

exten => docfu,1,GotoIf($["${DB(AMPUSER/${CFUEXT}/device)}" = "" ]?chlocal)
exten => docfu,n,Dial(Local/${CFUEXT}@ext-local,${RT},${DIAL_OPTIONS})
exten => docfu,n,Return()
exten => docfu,n(chlocal),ExecIf($["${DIRECTION}" = "INBOUND"]?Set(DIAL_OPTIONS=${STRREPLACE(DIAL_OPTIONS,T)}))
exten => docfu,n,Dial(Local/${CFUEXT}@from-internal/n,${RT},${DIAL_OPTIONS})
exten => docfu,n,Return()

exten => docfb,1,GotoIf($["${DB(AMPUSER/${CFBEXT}/device)}" = "" ]?chlocal)
exten => docfb,n,Dial(Local/${CFBEXT}@ext-local,${RT},${DIAL_OPTIONS})
exten => docfb,n,Return()
exten => docfb,n(chlocal),ExecIf($["${DIRECTION}" = "INBOUND"]?Set(DIAL_OPTIONS=${STRREPLACE(DIAL_OPTIONS,T)}))
exten => docfb,n,Dial(Local/${CFBEXT}@from-internal/n,${RT},${DIAL_OPTIONS})
exten => docfb,n,Return()

exten => _s-.,1,Noop(Extension is reporting ${EXTEN})

;--== end of [macro-simple-dial] ==--;


[originate-skipvm]
exten => _.X,1,Macro(blkvm-set,)
exten => _.X,n,Goto(from-internal,${EXTEN},1)

;--== end of [originate-skipvm] ==--;


[macro-blkvm-setifempty]
exten => s,1,GotoIf($[!${EXISTS(${BLKVM_CHANNEL})}]?init)
exten => s,n,Set(GOSUB_RETVAL=${SHARED(BLKVM,${BLKVM_CHANNEL})})
exten => s,n,MacroExit()
exten => s,n(init),Set(__BLKVM_CHANNEL=${CHANNEL})
exten => s,n,Set(SHARED(BLKVM,${BLKVM_CHANNEL})=TRUE)
exten => s,n,Set(GOSUB_RETVAL=TRUE)
exten => s,n,MacroExit()

;--== end of [macro-blkvm-setifempty] ==--;


[macro-blkvm-set]
exten => s,1,ExecIf($[!${EXISTS(${BLKVM_CHANNEL})} | "{ARG1}" = "reset"]?Set(__BLKVM_CHANNEL=${CHANNEL}))
exten => s,n,Set(SHARED(BLKVM,${BLKVM_CHANNEL})=TRUE)
exten => s,n,Set(GOSUB_RETVAL=TRUE)
exten => s,n,MacroExit()

;--== end of [macro-blkvm-set] ==--;


[macro-blkvm-clr]
exten => s,1,Set(SHARED(BLKVM,${BLKVM_CHANNEL})=)
exten => s,n,Set(GOSUB_RETVAL=)
exten => s,n,MacroExit()

;--== end of [macro-blkvm-clr] ==--;


[macro-blkvm-check]
exten => s,1,Set(GOSUB_RETVAL=${SHARED(BLKVM,${BLKVM_CHANNEL})})
exten => s,n,ExecIf($["${GOSUB_RETVAL}"="" & "${CC_RECALL}"="1"]?Set(GOSUB_RETVAL=TRUE))
exten => s,n,MacroExit()

;--== end of [macro-blkvm-check] ==--;


[macro-hangupcall]
exten => s,1(start),GotoIf($["${USE_CONFIRMATION}"="" | "${RINGGROUP_INDEX}"="" | "${CHANNEL}"!="${UNIQCHAN}"]?theend)
exten => s,n(delrgi),Noop(Deleting: RG/${RINGGROUP_INDEX}/${CHANNEL} ${DB_DELETE(RG/${RINGGROUP_INDEX}/${CHANNEL})})
exten => s,n(theend),ExecIf($["${ONETOUCH_RECFILE}"!="" & "${CDR(recordingfile)}"=""]?Set(CDR(recordingfile)=${ONETOUCH_RECFILE}))
exten => s,n,Hangup
exten => s,n,MacroExit()

;--== end of [macro-hangupcall] ==--;


[macro-user-logon]
exten => s,1,Set(DEVICETYPE=${DB(DEVICE/${CALLERID(number)}/type)})
exten => s,n,Answer
exten => s,n,Wait(1)
exten => s,n,GotoIf($["${DEVICETYPE}" = "fixed"]?s-FIXED,1)
exten => s,n,Set(AMPUSER=${ARG1})
exten => s,n,GotoIf($["${AMPUSER}" != ""]?gotpass)
exten => s,n,Read(AMPUSER,please-enter-your-extension-then-press-pound,,,4,)
exten => s,n,GotoIf($["${AMPUSER}" = ""]?s-MAXATTEMPTS,1)
exten => s,n(gotpass),GotoIf($["${DB_EXISTS(AMPUSER/${AMPUSER}/password)}" = "0"]?s-NOUSER,1)
exten => s,n,Set(AMPUSERPASS=${DB_RESULT})
exten => s,n,GotoIf($[${LEN(${AMPUSERPASS})} = 0]?s-NOPASSWORD,1)
exten => s,n,Set(DEVICEUSER=${DB(DEVICE/${CALLERID(number)}/user)})
exten => s,n,GotoIf($["${DEVICEUSER}" = "${AMPUSER}"]?s-ALREADYLOGGEDON,1)
exten => s,n,Authenticate(${AMPUSERPASS},)
exten => s,n,AGI(user_login_out.agi,login,${CALLERID(number)},${AMPUSER})
exten => s,n,Playback(agent-loginok)

exten => s-FIXED,1,Noop(Device is FIXED and cannot be logged into)
exten => s-FIXED,n,SayNumber(${CALLERID(number)},f)
exten => s-FIXED,n,Playback(vm-isunavail&vm-goodbye)
exten => s-FIXED,n,Hangup

exten => s-ALREADYLOGGEDON,1,Noop(This device has already been logged into by this user)
exten => s-ALREADYLOGGEDON,n,Playback(vm-goodbye)
exten => s-ALREADYLOGGEDON,n,Hangup

exten => s-NOPASSWORD,1,Noop(This extension does not exist or no password is set)
exten => s-NOPASSWORD,n,Playback(pbx-invalid)
exten => s-NOPASSWORD,n,Hangup

exten => s-MAXATTEMPTS,1,Noop(Too many login attempts)
exten => s-MAXATTEMPTS,n,Playback(vm-goodbye)
exten => s-MAXATTEMPTS,n,Hangup

exten => s-NOUSER,1,Noop(Invalid extension ${AMPUSER} entered)
exten => s-NOUSER,n,Playback(pbx-invalid)
exten => s-NOUSER,n,Goto(s,playagain)

;--== end of [macro-user-logon] ==--;


[macro-user-logoff]
exten => s,1,Set(DEVICETYPE=${DB(DEVICE/${CALLERID(number)}/type)})
exten => s,n,GotoIf($["${DEVICETYPE}" = "fixed"]?s-FIXED,1)
exten => s,n,AGI(user_login_out.agi,logout,${CALLERID(number)})
exten => s,n(done),Playback(agent-loggedoff)

exten => s-FIXED,1,Noop(Device is FIXED and cannot be logged into)
exten => s-FIXED,n,Playback(an-error-has-occured&vm-goodbye)
exten => s-FIXED,n,Hangup

;--== end of [macro-user-logoff] ==--;


[macro-dial-one]
exten => s,1,Set(DEXTEN=${ARG3})
exten => s,n(setexttocall),ExecIf($[${LEN(${EXTTOCALL})}=0 & ${LEN(${DEXTEN})}>0]?Set(__EXTTOCALL=${DEXTEN}))
exten => s,n,Set(DIALSTATUS_CW=)
exten => s,n,GosubIf($["${FROM_DID}"!="" & "${SCREEN}"="" & "${DB(AMPUSER/${DEXTEN}/screen)}"!=""]?screen,1())
exten => s,n,GosubIf($["${DB(CF/${DEXTEN})}"!=""]?cf,1())
exten => s,n,GotoIf($["${DEXTEN:-1}"="#" | "${DB(DND/${DEXTEN})}"=""]?skip1)
exten => s,n,Set(DEXTEN=)
exten => s,n,Set(DIALSTATUS=BUSY)
exten => s,n(skip1),GotoIf($["${DEXTEN}"=""]?nodial)
exten => s,n,GotoIf($["${DEXTEN:-1}"="#"]?continue)
exten => s,n,Set(EXTHASCW=${IF($["${CWIGNORE}"!=""]? :${DB(CW/${DEXTEN})})})
exten => s,n,GotoIf($["${EXTHASCW}"="" | "${DB(CFB/${DEXTEN})}"!="" | "${DB(CFU/${DEXTEN})}"!=""]?next1:cwinusebusy)
exten => s,n(next1),GotoIf($["${DB(CFU/${DEXTEN})}"!="" & ("${EXTENSION_STATE(${DEXTEN})}"="UNAVAILABLE" | "${EXTENSION_STATE(${DEXTEN})}"="UNKNOWN")]?docfu:skip3)
exten => s,n(docfu),Set(DEXTEN=)
exten => s,n,Set(DIALSTATUS=NOANSWER)
exten => s,n,Goto(nodial)
exten => s,n(skip3),GotoIf($["${EXTHASCW}"="" | "${DB(CFB/${DEXTEN})}"!=""]?next2:continue)
exten => s,n(next2),GotoIf($["${EXTENSION_STATE(${DEXTEN})}"="NOT_INUSE" | "${EXTENSION_STATE(${DEXTEN})}"="UNAVAILABLE" | "${EXTENSION_STATE(${DEXTEN})}"="UNKNOWN"]?continue)
exten => s,n,ExecIf($["${DB(CFB/${DEXTEN})}"!="" & "${CFIGNORE}"=""]?Set(DIALSTATUS=BUSY))
exten => s,n,GotoIf($["${EXTHASCW}"!="" | "${DEXTEN:-1}"="#"]?cwinusebusy)
exten => s,n,Set(DEXTEN=)
exten => s,n,Set(DIALSTATUS=BUSY)
exten => s,n,Goto(nodial)
exten => s,n(cwinusebusy),GotoIf($["${EXTHASCW}"!="" & "${CWINUSEBUSY}"="true"]?next3:continue)
exten => s,n(next3),ExecIf($["${EXTENSION_STATE(${DEXTEN})}"!="UNAVAILABLE" & "${EXTENSION_STATE(${DEXTEN})}"!="NOT_INUSE" & "${EXTENSION_STATE(${DEXTEN})}"!="UNKNOWN"]?Set(DIALSTATUS_CW=BUSY))
exten => s,n(continue),GotoIf($["${DEXTEN}"=""]?nodial)
exten => s,n,GosubIf($["${DEXTEN:-1}"!="#"]?dstring,1():dlocal,1())
exten => s,n,GotoIf($[${LEN(${DSTRING})}=0]?nodial)
exten => s,n,GotoIf($["${DEXTEN:-1}"="#"]?skiptrace)
exten => s,n,GosubIf($[${REGEX("^[\+]?[0-9]+$" ${CALLERID(number)})} = 1]?ctset,1():ctclear,1())
exten => s,n(skiptrace),Set(D_OPTIONS=${IF($["${NODEST}"!="" & ${REGEX("(M[(]auto-blkvm[)])" ${ARG2})} != 1]?${ARG2}M(auto-blkvm):${ARG2})})
exten => s,n,GosubIf($["${ALERT_INFO}"!="" & "${HASH(SIPHEADERS,Alert-Info)}"=""]?func-set-sipheader,s,1(Alert-Info,${ALERT_INFO}))
exten => s,n,Noop(Blind Transfer: ${BLINDTRANSFER}, Attended Transfer: ${ATTENDEDTRANSFER}, User: ${AMPUSER}, Alert Info: ${ALERT_INFO})
exten => s,n,ExecIf($["${ALERT_INFO}"="" & ${LEN(${AMPUSER})}!=0 & ${LEN(${BLINDTRANSFER})}=0 & ${LEN(${ATTENDEDTRANSFER})}=0]?Set(ALERT_INFO=RingAnswer))
exten => s,n,ExecIf($[${LEN(${BLINDTRANSFER})}!=0]?Set(ALERT_INFO=))
exten => s,n,ExecIf($[${LEN(${ATTENDEDTRANSFER})}!=0]?Set(ALERT_INFO=))
exten => s,n,ExecIf($["${RVOL}"!=""]?Set(ALERT_INFO=${IF($["${ALERT_INFO}"!=""]?${ALERT_INFO}:Normal)}\;volume=${RVOL}))
exten => s,n,ExecIf($["${RVOL}"="" & "${DB(AMPUSER/${EXTTOCALL}/rvolume)}" != ""]?Set(ALERT_INFO=${IF($["${ALERT_INFO}"!=""]?${ALERT_INFO}:Normal)}\;volume=${DB(AMPUSER/${EXTTOCALL}/rvolume)}))
exten => s,n,GosubIf($["${ALERT_INFO}"!="" & "${ALERT_INFO}"!=" "]?func-set-sipheader,s,1(Alert-Info,${ALERT_INFO}))
exten => s,n,ExecIf($[("${MOHCLASS}"!="default") & ("${MOHCLASS}"!="")]?Set(CHANNEL(musicclass)=${MOHCLASS}))
exten => s,n,GosubIf($["${QUEUEWAIT}"!=""]?qwait,1())
exten => s,n,Set(__CWIGNORE=${CWIGNORE})
exten => s,n,Set(__KEEPCID=TRUE)
exten => s,n,GotoIf($["${USEGOTO}"="1"]?usegoto,1)
exten => s,n,GotoIf($["${DB(AMPUSER/${EXTTOCALL}/cidname)}" = "" || "${DB(AMPUSER/${AMPUSER}/cidname)}" = ""]?godial)
exten => s,n,Gosub(sub-presencestate-display,s,1(${EXTTOCALL}))
exten => s,n,Set(CONNECTEDLINE(name,i)=${DB(AMPUSER/${EXTTOCALL}/cidname)}${PRESENCESTATE_DISPLAY})
exten => s,n,Set(CONNECTEDLINE(num)=${EXTTOCALL})
exten => s,n,Set(D_OPTIONS=${D_OPTIONS})
exten => s,n(godial),Macro(dialout-one-predial-hook,)
exten => s,n,ExecIf($["${DIRECTION}" = "INBOUND"]?Set(D_OPTIONS=${STRREPLACE(D_OPTIONS,T)}I))
exten => s,n(dialapp),Noop()
exten => s,n,ExecIf($["${ivrreturn}" = "1"]?Set(D_OPTIONS=${D_OPTIONS}g))
exten => s,n(dial),Dial(${DSTRING},${ARG1},${D_OPTIONS}b(func-apply-sipheaders^s^1))
exten => s,n,ExecIf($["${DIALSTATUS}"="ANSWER" & "${CALLER_DEST}"!=""]?MacroExit())
exten => s,n,ExecIf($["${DIALSTATUS_CW}"!=""]?Set(DIALSTATUS=${DIALSTATUS_CW}))
exten => s,n,GosubIf($[("${SCREEN}"!=""&("${DIALSTATUS}"="TORTURE"|"${DIALSTATUS}"="DONTCALL"))|"${DIALSTATUS}"="ANSWER"]?s-${DIALSTATUS},1())
exten => s,n,MacroExit()
exten => s,n(nodial),Noop()
exten => s,n,ExecIf($["${DIALSTATUS}" = ""]?Set(DIALSTATUS=NOANSWER))
exten => s,n,Noop(Returned from dial-one with nothing to call and DIALSTATUS: ${DIALSTATUS})
exten => s,n,MacroExit()

exten => h,1,Macro(hangupcall,)

exten => usegoto,1,Set(USEGOTO=)
exten => usegoto,n,Goto(from-internal,${DSTRING},1)

exten => screen,1,GotoIf($["${DB(AMPUSER/${DEXTEN}/screen)}"!="nomemory" | "${CALLERID(number)}"=""]?memory)
exten => screen,n,ExecIf($[${REGEX("^[0-9a-zA-Z ]+$" ${CALLERID(number)})} = 1]?System(rm -f ${ASTVARLIBDIR}/sounds/priv-callerintros/${CALLERID(number)}.*))
exten => screen,n(memory),Set(__SCREEN=${DB(AMPUSER/${DEXTEN}/screen)})
exten => screen,n,Set(__SCREEN_EXTEN=${DEXTEN})
exten => screen,n,Set(ARG2=${ARG2}p)
exten => screen,n,Return()

exten => cf,1,Set(CFAMPUSER=${IF($["${AMPUSER}"=""]?${CALLERID(number)}:${AMPUSER})})
exten => cf,n,ExecIf($["${DB(CF/${DEXTEN})}"="${CFAMPUSER}" | "${DB(CF/${DEXTEN})}"="${REALCALLERIDNUM}" | "${CUT(CUT(BLINDTRANSFER,-,1),/,1)}" = "${DB(CF/${DEXTEN})}" | "${DEXTEN}"="${DB(CF/${DEXTEN})}"]?Return())
exten => cf,n,ExecIf($["${DB(AMPUSER/${DEXTEN}/cfringtimer)}" != "0" & "${DB(AMPUSER/${DEXTEN}/cfringtimer)}" != ""]?Set(ARG1=${IF($["${DB(AMPUSER/${DEXTEN}/cfringtimer)}"="-1"]? : ${DB(AMPUSER/${DEXTEN}/cfringtimer)})}))
exten => cf,n,ExecIf($["${DB(AMPUSER/${DEXTEN}/cfringtimer)}" == "0"]?Set(ARG1=${IF($["${DB(FREEPBXCONF/CFRINGTIMERDEFAULT)}"="-1"]? : ${DB(FREEPBXCONF/CFRINGTIMERDEFAULT)})}))
exten => cf,n,Set(DEXTEN=${IF($["${CFIGNORE}"=""]?"${DB(CF/${DEXTEN})}#": )})
exten => cf,n,ExecIf($["${DEXTEN}"!=""]?Return())
exten => cf,n,Set(DIALSTATUS=NOANSWER)
exten => cf,n,Return()

exten => qwait,1,ExecIf($["${SAVEDCIDNAME}" = ""]?Set(__SAVEDCIDNAME=${CALLERID(name)}))
exten => qwait,n,Set(ELAPSED=${MATH($[${EPOCH}+30-${QUEUEWAIT}]/60,int)})
exten => qwait,n,Set(CALLERID(name)=M${ELAPSED}:${SAVEDCIDNAME})
exten => qwait,n,Return()

exten => ctset,1,Set(DB(CALLTRACE/${DEXTEN})=${CALLERID(number)})
exten => ctset,n,Return()

exten => ctclear,1,Noop(Deleting: CALLTRACE/${DEXTEN} ${DB_DELETE(CALLTRACE/${DEXTEN})})
exten => ctclear,n,Return()

exten => dstring,1,Set(DSTRING=)
exten => dstring,n,Set(DEVICES=${DB(AMPUSER/${DEXTEN}/device)})
exten => dstring,n,ExecIf($["${DEVICES}"=""]?Return())
exten => dstring,n,ExecIf($["${DEVICES:0:1}"="&"]?Set(DEVICES=${DEVICES:1}))
exten => dstring,n,Set(LOOPCNT=${FIELDQTY(DEVICES,&)})
exten => dstring,n,Set(ITER=1)
exten => dstring,n(begin),Set(THISDIAL=${DB(DEVICE/${CUT(DEVICES,&,${ITER})}/dial)})
exten => dstring,n,GosubIf($["${ASTCHANDAHDI}" = "1"]?zap2dahdi,1())
exten => dstring,n,GotoIf($["${THISDIAL:0:5}"!="PJSIP"]?docheck)
exten => dstring,n,Noop(Debug: Found PJSIP Destination ${THISDIAL})
exten => dstring,n,GotoIf($[ ${REGEX("(/.+/|@)" ${THISDIAL})} = 1 ]?doset)
exten => dstring,n,Noop(Debug: Updating PJSIP Destination with PJSIP_DIAL_CONTACTS)
exten => dstring,n,Set(THISDIAL=${PJSIP_DIAL_CONTACTS(${THISDIAL:6})})
exten => dstring,n(docheck),GotoIf($["${THISDIAL}"=""]?skipset)
exten => dstring,n(doset),Set(DSTRING=${DSTRING}${THISDIAL}&)
exten => dstring,n(skipset),Set(ITER=$[${ITER}+1])
exten => dstring,n,GotoIf($[${ITER}<=${LOOPCNT}]?begin)
exten => dstring,n,ExecIf($["${DSTRING:-1}"!="&"]?Return())
exten => dstring,n,Set(DSTRING=${DSTRING:0:$[${LEN(${DSTRING})}-1]})
exten => dstring,n,Return()

exten => dlocal,1,Set(DSTRING=${IF($["${ARG1}"=""]?${DEXTEN:0:${MATH(${LEN(${DEXTEN})}-1,int)}}:Local/${DEXTEN:0:${MATH(${LEN(${DEXTEN})}-1,int)}}@from-internal/n)})
exten => dlocal,n,Set(USEGOTO=${IF($["${ARG1}"=""]?1:0)})
exten => dlocal,n,Return()

exten => zap2dahdi,1,ExecIf($["${THISDIAL}" = ""]?Return())
exten => zap2dahdi,n,Set(NEWDIAL=)
exten => zap2dahdi,n,Set(LOOPCNT2=${FIELDQTY(THISDIAL,&)})
exten => zap2dahdi,n,Set(ITER2=1)
exten => zap2dahdi,n(begin2),Set(THISPART2=${CUT(THISDIAL,&,${ITER2})})
exten => zap2dahdi,n,ExecIf($["${THISPART2:0:3}" = "ZAP"]?Set(THISPART2=DAHDI${THISPART2:3}))
exten => zap2dahdi,n,Set(NEWDIAL=${NEWDIAL}${THISPART2}&)
exten => zap2dahdi,n,Set(ITER2=$[${ITER2} + 1])
exten => zap2dahdi,n,GotoIf($[${ITER2} <= ${LOOPCNT2}]?begin2)
exten => zap2dahdi,n,Set(THISDIAL=${NEWDIAL:0:$[${LEN(${NEWDIAL})}-1]})
exten => zap2dahdi,n,Return()

exten => s-ANSWER,1,Noop(Call successfully answered - Hanging up now)
exten => s-ANSWER,n,GotoIf($["${ivrreturn}" = "1"]?${IVR_CONTEXT},return,1)
exten => s-ANSWER,n(bye),Macro(hangupcall,)

exten => s-TORTURE,1,Goto(app-blackhole,musiconhold,1)
exten => s-TORTURE,n,Macro(hangupcall,)

exten => s-DONTCALL,1,Answer
exten => s-DONTCALL,n,Wait(1)
exten => s-DONTCALL,n,Zapateller()
exten => s-DONTCALL,n,Playback(ss-noservice)
exten => s-DONTCALL,n,Macro(hangupcall,)

exten => s-CHANUNAVAIL,1,Macro(vm,${SCREEN_EXTEN},BUSY,${IVR_RETVM})
exten => s-CHANUNAVAIL,n,GotoIf($["${ivrreturn}" = "1"]?${IVR_CONTEXT},return,1)
exten => s-CHANUNAVAIL,n(return),ExecIf($["${IVR_RETVM}"!="RETURN" | "${IVR_CONTEXT}"=""]?Hangup())
exten => s-CHANUNAVAIL,n,Return()

exten => s-NOANSWER,1,Macro(vm,${SCREEN_EXTEN},BUSY,${IVR_RETVM})
exten => s-NOANSWER,n,GotoIf($["${ivrreturn}" = "1"]?${IVR_CONTEXT},return,1)
exten => s-NOANSWER,n(return),ExecIf($["${IVR_RETVM}"!="RETURN" | "${IVR_CONTEXT}"=""]?Hangup())
exten => s-NOANSWER,n,Return()

exten => s-BUSY,1,Macro(vm,${SCREEN_EXTEN},BUSY,${IVR_RETVM})
exten => s-BUSY,n,GotoIf($["${ivrreturn}" = "1"]?${IVR_CONTEXT},return,1)
exten => s-BUSY,n(return),ExecIf($["${IVR_RETVM}"!="RETURN" | "${IVR_CONTEXT}"=""]?Hangup())
exten => s-BUSY,n,Return()

;--== end of [macro-dial-one] ==--;


[func-set-sipheader]
exten => s,1,Noop(Sip Add Header function called. Adding ${ARG1} = ${ARG2})
exten => s,n,Set(HASH(__SIPHEADERS,${ARG1})=${ARG2})
exten => s,n,Return()

;--== end of [func-set-sipheader] ==--;


[func-apply-sipheaders]
exten => s,1,Noop(Applying SIP Headers to channel ${CHANNEL})
exten => s,n,Set(TECH=${CUT(CHANNEL,/,1)})
exten => s,n,Set(SIPHEADERKEYS=${HASHKEYS(SIPHEADERS)})
exten => s,n,While($["${SET(sipkey=${SHIFT(SIPHEADERKEYS)})}" != ""])
exten => s,n,Set(sipheader=${HASH(SIPHEADERS,${sipkey})})
exten => s,n,ExecIf($["${sipheader}" = "unset" & "${TECH}" = "SIP"]?SIPRemoveHeader(${sipkey}:))
exten => s,n,ExecIf($["${TECH}" = "SIP" & "${sipheader}" != "unset"]?SIPAddHeader(${sipkey}:${sipheader}))
exten => s,n,EndWhile
exten => s,n,Return()

;--== end of [func-apply-sipheaders] ==--;


[macro-pinsets]
exten => s,1,Set(try=1)
exten => s,n,GotoIf($[${ARG2} = 1]?cdr,1)
exten => s,n,GotoIf($["${DB(AMPUSER/${AMPUSER}/pinless)}" != "NOPASSWD"]?auth:return)
exten => s,n(auth),Progress
exten => s,n,Read(dtmf,agent-pass,0,n,1,10)
exten => s,n,GotoIf($["${DB(PINSETS/${ARG1}/${dtmf})}" = "${ARG1}"]?return:askpin)
exten => s,n(askpin),Set(try=$[${try}+1])
exten => s,n,GotoIf($[${try} > 4]?hangup)
exten => s,n,Read(dtmf,auth-incorrect,0,n,1,10)
exten => s,n(validate),GotoIf($["${DB(PINSETS/${ARG1}/${dtmf})}" = "${ARG1}"]?return:askpin)
exten => s,n(hangup),Hangup
exten => s,n(return),Noop(returning back)

exten => cdr,1,GotoIf($["${DB(AMPUSER/${AMPUSER}/pinless)}" != "NOPASSWD"]?auth:return)
exten => cdr,n,Set(try=1)
exten => cdr,n(auth),Progress
exten => cdr,n,Read(dtmf,agent-pass,0,n,1,10)
exten => cdr,n,GotoIf($["${DB(PINSETS/${ARG1}/${dtmf})}" = "${ARG1}"]?setaccountcode:askpin)
exten => cdr,n(askpin),Set(try=$[${try}+1])
exten => cdr,n,GotoIf($[${try} > 4]?hangup)
exten => cdr,n,Read(dtmf,auth-incorrect,0,n,1,10)
exten => cdr,n(validate),GotoIf($["${DB(PINSETS/${ARG1}/${dtmf})}" = "${ARG1}"]?setaccountcode:askpin)
exten => cdr,n(hangup),Hangup
exten => cdr,n(setaccountcode),Set(CHANNEL(accountcode)=${dtmf})
exten => cdr,n(return),Noop(returning back)

;--== end of [macro-pinsets] ==--;


[ivr-4] ; Closed
include => from-did-direct-ivr
exten => s,1,Set(TIMEOUT_LOOPCOUNT=0)
exten => s,n,Set(INVALID_LOOPCOUNT=0)
exten => s,n,Set(_IVR_CONTEXT_${CONTEXT}=${IVR_CONTEXT})
exten => s,n,Set(_IVR_CONTEXT=${CONTEXT})
exten => s,n,Set(__IVR_RETVM=)
exten => s,n,GotoIf($["${CHANNEL(state)}" = "Up"]?skip)
exten => s,n,Answer
exten => s,n,Wait(1)
exten => s,n(skip),Set(IVR_MSG=custom/IVR-CLOSED)
exten => s,n(start),Set(TIMEOUT(digit)=3)
exten => s,n,ExecIf($["${IVR_MSG}" != ""]?Background(${IVR_MSG}))
exten => s,n,WaitExten(10,)

exten => 0,1,Set(__ivrreturn=0)
exten => 0,n(ivrsel-0),Goto(ext-local,vmb100,1)

exten => 2,1,Set(__ivrreturn=0)
exten => 2,n(ivrsel-2),Goto(ext-local,vmu131,1)

exten => 3,1,Set(__ivrreturn=0)
exten => 3,n(ivrsel-3),Goto(ext-local,vmu133,1)

exten => 4,1,Set(__ivrreturn=0)
exten => 4,n(ivrsel-4),Goto(ext-local,vmu138,1)

exten => 5,1,Set(__ivrreturn=0)
exten => 5,n(ivrsel-5),Goto(ext-local,vmu145,1)

exten => 6,1,Set(__ivrreturn=0)
exten => 6,n(ivrsel-6),Goto(ext-local,vmu140,1)

exten => 7,1,Set(__ivrreturn=0)
exten => 7,n(ivrsel-7),Goto(ivr-7,s,1)

exten => 8,1,Set(__ivrreturn=0)
exten => 8,n(ivrsel-8),Goto(app-announcement-1,s,1)

exten => 9,1,Set(__ivrreturn=0)
exten => 9,n(ivrsel-9),Goto(directory,1,1)

exten => i,1,Set(INVALID_LOOPCOUNT=$[${INVALID_LOOPCOUNT}+1])
exten => i,n,GotoIf($[${INVALID_LOOPCOUNT} > 3]?final)
exten => i,n,Set(IVR_MSG=no-valid-responce-pls-try-again)
exten => i,n,Goto(s,start)
exten => i,n(final),Playback(no-valid-responce-transfering)
exten => i,n,Goto(ivr-4,s,1)

exten => t,1,Set(TIMEOUT_LOOPCOUNT=$[${TIMEOUT_LOOPCOUNT}+1])
exten => t,n,GotoIf($[${TIMEOUT_LOOPCOUNT} > 3]?final)
exten => t,n,Set(IVR_MSG=no-valid-responce-pls-try-again)
exten => t,n,Goto(s,start)
exten => t,n(final),Playback(no-valid-responce-transfering)
exten => t,n,Goto(ivr-4,s,1)

exten => return,1,Set(_IVR_CONTEXT=${CONTEXT})
exten => return,n,Set(_IVR_CONTEXT_${CONTEXT}=${IVR_CONTEXT_${CONTEXT}})
exten => return,n,Set(IVR_MSG=custom/IVR-CLOSED)
exten => return,n,Goto(s,start)

exten => h,1,Hangup

exten => hang,1,Playback(vm-goodbye)
exten => hang,n,Hangup

;--== end of [ivr-4] ==--;


[ivr-5] ; Closed-Holiday
include => from-did-direct-ivr
exten => s,1,Set(TIMEOUT_LOOPCOUNT=0)
exten => s,n,Set(INVALID_LOOPCOUNT=0)
exten => s,n,Set(_IVR_CONTEXT_${CONTEXT}=${IVR_CONTEXT})
exten => s,n,Set(_IVR_CONTEXT=${CONTEXT})
exten => s,n,Set(__IVR_RETVM=)
exten => s,n,GotoIf($["${CHANNEL(state)}" = "Up"]?skip)
exten => s,n,Answer
exten => s,n,Wait(1)
exten => s,n(skip),Set(IVR_MSG=custom/IVR-HOLIDAY)
exten => s,n(start),Set(TIMEOUT(digit)=3)
exten => s,n,ExecIf($["${IVR_MSG}" != ""]?Background(${IVR_MSG}))
exten => s,n,WaitExten(10,)

exten => 0,1,Set(__ivrreturn=0)
exten => 0,n(ivrsel-0),Goto(ext-local,vmb100,1)

exten => 2,1,Set(__ivrreturn=0)
exten => 2,n(ivrsel-2),Goto(ext-local,vmu131,1)

exten => 3,1,Set(__ivrreturn=0)
exten => 3,n(ivrsel-3),Goto(ext-local,vmu133,1)

exten => 4,1,Set(__ivrreturn=0)
exten => 4,n(ivrsel-4),Goto(ext-local,vmu138,1)

exten => 5,1,Set(__ivrreturn=0)
exten => 5,n(ivrsel-5),Goto(ext-local,vmu145,1)

exten => 6,1,Set(__ivrreturn=0)
exten => 6,n(ivrsel-6),Goto(ext-local,vmu140,1)

exten => 7,1,Set(__ivrreturn=0)
exten => 7,n(ivrsel-7),Goto(ivr-7,s,1)

exten => 8,1,Set(__ivrreturn=0)
exten => 8,n(ivrsel-8),Goto(app-announcement-1,s,1)

exten => 9,1,Set(__ivrreturn=0)
exten => 9,n(ivrsel-9),Goto(directory,1,1)

exten => i,1,Set(INVALID_LOOPCOUNT=$[${INVALID_LOOPCOUNT}+1])
exten => i,n,GotoIf($[${INVALID_LOOPCOUNT} > 3]?final)
exten => i,n,Set(IVR_MSG=no-valid-responce-pls-try-again)
exten => i,n,Goto(s,start)
exten => i,n(final),Playback(no-valid-responce-transfering)
exten => i,n,Goto(ivr-5,s,1)

exten => t,1,Set(TIMEOUT_LOOPCOUNT=$[${TIMEOUT_LOOPCOUNT}+1])
exten => t,n,GotoIf($[${TIMEOUT_LOOPCOUNT} > 3]?final)
exten => t,n,Set(IVR_MSG=no-valid-responce-pls-try-again)
exten => t,n,Goto(s,start)
exten => t,n(final),Playback(no-valid-responce-transfering)
exten => t,n,Goto(ivr-5,s,1)

exten => return,1,Set(_IVR_CONTEXT=${CONTEXT})
exten => return,n,Set(_IVR_CONTEXT_${CONTEXT}=${IVR_CONTEXT_${CONTEXT}})
exten => return,n,Set(IVR_MSG=custom/IVR-HOLIDAY)
exten => return,n,Goto(s,start)

exten => h,1,Hangup

exten => hang,1,Playback(vm-goodbye)
exten => hang,n,Hangup

;--== end of [ivr-5] ==--;


[ivr-7] ; Counseling Auto Attendant
include => from-ivr-directory-Disabled
exten => s,1,Set(TIMEOUT_LOOPCOUNT=0)
exten => s,n,Set(INVALID_LOOPCOUNT=0)
exten => s,n,Set(_IVR_CONTEXT_${CONTEXT}=${IVR_CONTEXT})
exten => s,n,Set(_IVR_CONTEXT=${CONTEXT})
exten => s,n,Set(__IVR_RETVM=)
exten => s,n,GotoIf($["${CHANNEL(state)}" = "Up"]?skip)
exten => s,n,Answer
exten => s,n,Wait(1)
exten => s,n(skip),Set(IVR_MSG=custom/IVR_COUNSELING)
exten => s,n(start),Set(TIMEOUT(digit)=3)
exten => s,n,ExecIf($["${IVR_MSG}" != ""]?Background(${IVR_MSG}))
exten => s,n,WaitExten(10,)

exten => *,1,Set(__ivrreturn=0)
exten => *,n(ivrsel-*),Goto(ivr-3,s,1)

exten => 1,1,Set(__ivrreturn=0)
exten => 1,n(ivrsel-1),Goto(from-did-direct,135,1)

exten => 2,1,Set(__ivrreturn=0)
exten => 2,n(ivrsel-2),Goto(from-did-direct,146,1)

exten => 3,1,Set(__ivrreturn=0)
exten => 3,n(ivrsel-3),Goto(from-did-direct,139,1)

exten => i,1,Set(INVALID_LOOPCOUNT=$[${INVALID_LOOPCOUNT}+1])
exten => i,n,GotoIf($[${INVALID_LOOPCOUNT} > 3]?final)
exten => i,n,Set(IVR_MSG=no-valid-responce-pls-try-again)
exten => i,n,Goto(s,start)
exten => i,n(final),Playback(no-valid-responce-transfering)
exten => i,n,Goto(ivr-7,s,1)

exten => t,1,Set(TIMEOUT_LOOPCOUNT=$[${TIMEOUT_LOOPCOUNT}+1])
exten => t,n,GotoIf($[${TIMEOUT_LOOPCOUNT} > 3]?final)
exten => t,n,Set(IVR_MSG=no-valid-responce-pls-try-again)
exten => t,n,Goto(s,start)
exten => t,n(final),Playback(no-valid-responce-transfering)
exten => t,n,Goto(ivr-7,s,1)

exten => return,1,Set(_IVR_CONTEXT=${CONTEXT})
exten => return,n,Set(_IVR_CONTEXT_${CONTEXT}=${IVR_CONTEXT_${CONTEXT}})
exten => return,n,Set(IVR_MSG=custom/IVR_COUNSELING)
exten => return,n,Goto(s,start)

exten => h,1,Hangup

exten => hang,1,Playback(vm-goodbye)
exten => hang,n,Hangup

;--== end of [ivr-7] ==--;


[ivr-3] ; Open - Allow Teacher
include => from-ivr-directory-1
exten => s,1,Set(TIMEOUT_LOOPCOUNT=0)
exten => s,n,Set(INVALID_LOOPCOUNT=0)
exten => s,n,Set(_IVR_CONTEXT_${CONTEXT}=${IVR_CONTEXT})
exten => s,n,Set(_IVR_CONTEXT=${CONTEXT})
exten => s,n,Set(__IVR_RETVM=)
exten => s,n,GotoIf($["${CHANNEL(state)}" = "Up"]?skip)
exten => s,n,Answer
exten => s,n,Wait(1)
exten => s,n(skip),Set(IVR_MSG=custom/IVR-MAIN)
exten => s,n(start),Set(TIMEOUT(digit)=3)
exten => s,n,ExecIf($["${IVR_MSG}" != ""]?Background(${IVR_MSG}))
exten => s,n,WaitExten(10,)

exten => 0,1,Set(__ivrreturn=0)
exten => 0,n(ivrsel-0),Goto(from-did-direct,130,1)

exten => 2,1,Set(__ivrreturn=0)
exten => 2,n(ivrsel-2),Goto(ext-group,331,1)

exten => 3,1,Set(__ivrreturn=0)
exten => 3,n(ivrsel-3),Goto(from-did-direct,133,1)

exten => 4,1,Set(__ivrreturn=0)
exten => 4,n(ivrsel-4),Goto(from-did-direct,138,1)

exten => 5,1,Set(__ivrreturn=0)
exten => 5,n(ivrsel-5),Goto(from-did-direct,145,1)

exten => 6,1,Set(__ivrreturn=0)
exten => 6,n(ivrsel-6),Goto(from-did-direct,140,1)

exten => 7,1,Set(__ivrreturn=0)
exten => 7,n(ivrsel-7),Goto(ivr-7,s,1)

exten => 8,1,Set(__ivrreturn=0)
exten => 8,n(ivrsel-8),Goto(app-announcement-1,s,1)

exten => 9,1,Set(__ivrreturn=0)
exten => 9,n(ivrsel-9),Goto(directory,1,1)

exten => i,1,Set(INVALID_LOOPCOUNT=$[${INVALID_LOOPCOUNT}+1])
exten => i,n,GotoIf($[${INVALID_LOOPCOUNT} > 3]?final)
exten => i,n,Set(IVR_MSG=no-valid-responce-pls-try-again)
exten => i,n,Goto(s,start)
exten => i,n(final),Playback(no-valid-responce-transfering)
exten => i,n,Goto(timeconditions,2,1)

exten => t,1,Set(TIMEOUT_LOOPCOUNT=$[${TIMEOUT_LOOPCOUNT}+1])
exten => t,n,GotoIf($[${TIMEOUT_LOOPCOUNT} > 3]?final)
exten => t,n,Set(IVR_MSG=no-valid-responce-pls-try-again)
exten => t,n,Goto(s,start)
exten => t,n(final),Playback(no-valid-responce-transfering)
exten => t,n,Goto(ext-local,vmu130,1)

exten => return,1,Set(_IVR_CONTEXT=${CONTEXT})
exten => return,n,Set(_IVR_CONTEXT_${CONTEXT}=${IVR_CONTEXT_${CONTEXT}})
exten => return,n,Set(IVR_MSG=custom/IVR-MAIN)
exten => return,n,Goto(s,start)

exten => h,1,Hangup

exten => hang,1,Playback(vm-goodbye)
exten => hang,n,Hangup

;--== end of [ivr-3] ==--;


[ivr-8] ; Open - Block Teacher
include => from-ivr-directory-4
exten => s,1,Set(TIMEOUT_LOOPCOUNT=0)
exten => s,n,Set(INVALID_LOOPCOUNT=0)
exten => s,n,Set(_IVR_CONTEXT_${CONTEXT}=${IVR_CONTEXT})
exten => s,n,Set(_IVR_CONTEXT=${CONTEXT})
exten => s,n,Set(__IVR_RETVM=)
exten => s,n,GotoIf($["${CHANNEL(state)}" = "Up"]?skip)
exten => s,n,Answer
exten => s,n,Wait(1)
exten => s,n(skip),Set(IVR_MSG=custom/IVR-MAIN)
exten => s,n(start),Set(TIMEOUT(digit)=3)
exten => s,n,ExecIf($["${IVR_MSG}" != ""]?Background(${IVR_MSG}))
exten => s,n,WaitExten(10,)

exten => 0,1,Set(__ivrreturn=0)
exten => 0,n(ivrsel-0),Goto(from-did-direct,130,1)

exten => 2,1,Set(__ivrreturn=0)
exten => 2,n(ivrsel-2),Goto(ext-group,331,1)

exten => 3,1,Set(__ivrreturn=0)
exten => 3,n(ivrsel-3),Goto(from-did-direct,133,1)

exten => 4,1,Set(__ivrreturn=0)
exten => 4,n(ivrsel-4),Goto(from-did-direct,138,1)

exten => 5,1,Set(__ivrreturn=0)
exten => 5,n(ivrsel-5),Goto(from-did-direct,145,1)

exten => 6,1,Set(__ivrreturn=0)
exten => 6,n(ivrsel-6),Goto(from-did-direct,140,1)

exten => 7,1,Set(__ivrreturn=0)
exten => 7,n(ivrsel-7),Goto(ivr-7,s,1)

exten => 8,1,Set(__ivrreturn=0)
exten => 8,n(ivrsel-8),Goto(app-announcement-1,s,1)

exten => 9,1,Set(__ivrreturn=0)
exten => 9,n(ivrsel-9),Goto(directory,4,1)

exten => i,1,Set(INVALID_LOOPCOUNT=$[${INVALID_LOOPCOUNT}+1])
exten => i,n,GotoIf($[${INVALID_LOOPCOUNT} > 3]?final)
exten => i,n,Set(IVR_MSG=no-valid-responce-pls-try-again)
exten => i,n,Goto(s,start)
exten => i,n(final),Playback(no-valid-responce-transfering)
exten => i,n,Goto(timeconditions,2,1)

exten => t,1,Set(TIMEOUT_LOOPCOUNT=$[${TIMEOUT_LOOPCOUNT}+1])
exten => t,n,GotoIf($[${TIMEOUT_LOOPCOUNT} > 3]?final)
exten => t,n,Set(IVR_MSG=no-valid-responce-pls-try-again)
exten => t,n,Goto(s,start)
exten => t,n(final),Playback(no-valid-responce-transfering)
exten => t,n,Goto(ext-local,vmu130,1)

exten => return,1,Set(_IVR_CONTEXT=${CONTEXT})
exten => return,n,Set(_IVR_CONTEXT_${CONTEXT}=${IVR_CONTEXT_${CONTEXT}})
exten => return,n,Set(IVR_MSG=custom/IVR-MAIN)
exten => return,n,Goto(s,start)

exten => h,1,Hangup

exten => hang,1,Playback(vm-goodbye)
exten => hang,n,Hangup

;--== end of [ivr-8] ==--;


[ivr-6] ; VOICEMAIL
include => from-did-direct-ivr
exten => s,1,Set(TIMEOUT_LOOPCOUNT=0)
exten => s,n,Set(INVALID_LOOPCOUNT=0)
exten => s,n,Set(_IVR_CONTEXT_${CONTEXT}=${IVR_CONTEXT})
exten => s,n,Set(_IVR_CONTEXT=${CONTEXT})
exten => s,n,Set(__IVR_RETVM=)
exten => s,n,GotoIf($["${CHANNEL(state)}" = "Up"]?skip)
exten => s,n,Answer
exten => s,n,Wait(1)
exten => s,n(skip),Set(IVR_MSG=custom/77outage20161009)
exten => s,n(start),Set(TIMEOUT(digit)=3)
exten => s,n,ExecIf($["${IVR_MSG}" != ""]?Background(${IVR_MSG}))
exten => s,n,WaitExten(10,)

exten => 0,1,Set(__ivrreturn=0)
exten => 0,n(ivrsel-0),Goto(from-did-direct,130,1)

exten => 9,1,Set(__ivrreturn=0)
exten => 9,n(ivrsel-9),Goto(directory,1,1)

exten => i,1,Set(INVALID_LOOPCOUNT=$[${INVALID_LOOPCOUNT}+1])
exten => i,n,GotoIf($[${INVALID_LOOPCOUNT} > 3]?final)
exten => i,n,Set(IVR_MSG=no-valid-responce-pls-try-again)
exten => i,n,Goto(s,start)
exten => i,n(final),Playback(no-valid-responce-transfering)
exten => i,n,Goto()

exten => t,1,Set(TIMEOUT_LOOPCOUNT=$[${TIMEOUT_LOOPCOUNT}+1])
exten => t,n,GotoIf($[${TIMEOUT_LOOPCOUNT} > 3]?final)
exten => t,n,Set(IVR_MSG=no-valid-responce-pls-try-again)
exten => t,n,Goto(s,start)
exten => t,n(final),Playback(no-valid-responce-transfering)
exten => t,n,Goto()

exten => return,1,Set(_IVR_CONTEXT=${CONTEXT})
exten => return,n,Set(_IVR_CONTEXT_${CONTEXT}=${IVR_CONTEXT_${CONTEXT}})
exten => return,n,Set(IVR_MSG=custom/77outage20161009)
exten => return,n,Goto(s,start)

exten => h,1,Hangup

exten => hang,1,Playback(vm-goodbye)
exten => hang,n,Hangup

;--== end of [ivr-6] ==--;


[from-ivr-directory-1]
exten => 386,1,Macro(blkvm-clr,)
exten => 386,n,Set(__NODEST=)
exten => 386,n,Goto(from-internal,386,1)
exten => 386,n,Macro(blkvm-clr,)
exten => 386,n,Set(__NODEST=)
exten => 386,n,Goto(from-internal,386,1)

exten => 103,1,Macro(blkvm-clr,)
exten => 103,n,Set(__NODEST=)
exten => 103,n,Goto(from-internal,103,1)

exten => 363,1,Macro(blkvm-clr,)
exten => 363,n,Set(__NODEST=)
exten => 363,n,Goto(from-internal,363,1)
exten => 363,n,Macro(blkvm-clr,)
exten => 363,n,Set(__NODEST=)
exten => 363,n,Goto(from-internal,363,1)

exten => 365,1,Macro(blkvm-clr,)
exten => 365,n,Set(__NODEST=)
exten => 365,n,Goto(from-internal,365,1)
exten => 365,n,Macro(blkvm-clr,)
exten => 365,n,Set(__NODEST=)
exten => 365,n,Goto(from-internal,365,1)

exten => 136,1,Macro(blkvm-clr,)
exten => 136,n,Set(__NODEST=)
exten => 136,n,Goto(from-internal,136,1)
exten => 136,n,Macro(blkvm-clr,)
exten => 136,n,Set(__NODEST=)
exten => 136,n,Goto(from-internal,136,1)

exten => 350,1,Macro(blkvm-clr,)
exten => 350,n,Set(__NODEST=)
exten => 350,n,Goto(from-internal,350,1)
exten => 350,n,Macro(blkvm-clr,)
exten => 350,n,Set(__NODEST=)
exten => 350,n,Goto(from-internal,350,1)

exten => 137,1,Macro(blkvm-clr,)
exten => 137,n,Set(__NODEST=)
exten => 137,n,Goto(from-internal,137,1)
exten => 137,n,Macro(blkvm-clr,)
exten => 137,n,Set(__NODEST=)
exten => 137,n,Goto(from-internal,137,1)

exten => 139,1,Macro(blkvm-clr,)
exten => 139,n,Set(__NODEST=)
exten => 139,n,Goto(from-internal,139,1)

exten => 105,1,Macro(blkvm-clr,)
exten => 105,n,Set(__NODEST=)
exten => 105,n,Goto(from-internal,105,1)

exten => 142,1,Macro(blkvm-clr,)
exten => 142,n,Set(__NODEST=)
exten => 142,n,Goto(from-internal,142,1)
exten => 142,n,Macro(blkvm-clr,)
exten => 142,n,Set(__NODEST=)
exten => 142,n,Goto(from-internal,142,1)

exten => 384,1,Macro(blkvm-clr,)
exten => 384,n,Set(__NODEST=)
exten => 384,n,Goto(from-internal,384,1)

exten => 362,1,Macro(blkvm-clr,)
exten => 362,n,Set(__NODEST=)
exten => 362,n,Goto(from-internal,362,1)
exten => 362,n,Macro(blkvm-clr,)
exten => 362,n,Set(__NODEST=)
exten => 362,n,Goto(from-internal,362,1)

exten => 367,1,Macro(blkvm-clr,)
exten => 367,n,Set(__NODEST=)
exten => 367,n,Goto(from-internal,367,1)
exten => 367,n,Macro(blkvm-clr,)
exten => 367,n,Set(__NODEST=)
exten => 367,n,Goto(from-internal,367,1)

exten => 131,1,Macro(blkvm-clr,)
exten => 131,n,Set(__NODEST=)
exten => 131,n,Goto(from-internal,131,1)

exten => 144,1,Macro(blkvm-clr,)
exten => 144,n,Set(__NODEST=)
exten => 144,n,Goto(from-internal,144,1)
exten => 144,n,Macro(blkvm-clr,)
exten => 144,n,Set(__NODEST=)
exten => 144,n,Goto(from-internal,144,1)

exten => 106,1,Macro(blkvm-clr,)
exten => 106,n,Set(__NODEST=)
exten => 106,n,Goto(from-internal,106,1)

exten => 135,1,Macro(blkvm-clr,)
exten => 135,n,Set(__NODEST=)
exten => 135,n,Goto(from-internal,135,1)
exten => 135,n,Macro(blkvm-clr,)
exten => 135,n,Set(__NODEST=)
exten => 135,n,Goto(from-internal,135,1)

exten => 360,1,Macro(blkvm-clr,)
exten => 360,n,Set(__NODEST=)
exten => 360,n,Goto(from-internal,360,1)
exten => 360,n,Macro(blkvm-clr,)
exten => 360,n,Set(__NODEST=)
exten => 360,n,Goto(from-internal,360,1)

exten => 358,1,Macro(blkvm-clr,)
exten => 358,n,Set(__NODEST=)
exten => 358,n,Goto(from-internal,358,1)
exten => 358,n,Macro(blkvm-clr,)
exten => 358,n,Set(__NODEST=)
exten => 358,n,Goto(from-internal,358,1)

exten => 355,1,Macro(blkvm-clr,)
exten => 355,n,Set(__NODEST=)
exten => 355,n,Goto(from-internal,355,1)
exten => 355,n,Macro(blkvm-clr,)
exten => 355,n,Set(__NODEST=)
exten => 355,n,Goto(from-internal,355,1)

exten => 353,1,Macro(blkvm-clr,)
exten => 353,n,Set(__NODEST=)
exten => 353,n,Goto(from-internal,353,1)
exten => 353,n,Macro(blkvm-clr,)
exten => 353,n,Set(__NODEST=)
exten => 353,n,Goto(from-internal,353,1)

exten => 361,1,Macro(blkvm-clr,)
exten => 361,n,Set(__NODEST=)
exten => 361,n,Goto(from-internal,361,1)
exten => 361,n,Macro(blkvm-clr,)
exten => 361,n,Set(__NODEST=)
exten => 361,n,Goto(from-internal,361,1)

exten => 132,1,Macro(blkvm-clr,)
exten => 132,n,Set(__NODEST=)
exten => 132,n,Goto(from-internal,132,1)
exten => 132,n,Macro(blkvm-clr,)
exten => 132,n,Set(__NODEST=)
exten => 132,n,Goto(from-internal,132,1)

exten => 129,1,Macro(blkvm-clr,)
exten => 129,n,Set(__NODEST=)
exten => 129,n,Goto(from-internal,129,1)
exten => 129,n,Macro(blkvm-clr,)
exten => 129,n,Set(__NODEST=)
exten => 129,n,Goto(from-internal,129,1)

exten => 372,1,Macro(blkvm-clr,)
exten => 372,n,Set(__NODEST=)
exten => 372,n,Goto(from-internal,372,1)
exten => 372,n,Macro(blkvm-clr,)
exten => 372,n,Set(__NODEST=)
exten => 372,n,Goto(from-internal,372,1)

exten => 100,1,Macro(blkvm-clr,)
exten => 100,n,Set(__NODEST=)
exten => 100,n,Goto(from-internal,100,1)

exten => 371,1,Macro(blkvm-clr,)
exten => 371,n,Set(__NODEST=)
exten => 371,n,Goto(from-internal,371,1)
exten => 371,n,Macro(blkvm-clr,)
exten => 371,n,Set(__NODEST=)
exten => 371,n,Goto(from-internal,371,1)

exten => 141,1,Macro(blkvm-clr,)
exten => 141,n,Set(__NODEST=)
exten => 141,n,Goto(from-internal,141,1)
exten => 141,n,Macro(blkvm-clr,)
exten => 141,n,Set(__NODEST=)
exten => 141,n,Goto(from-internal,141,1)

exten => 147,1,Macro(blkvm-clr,)
exten => 147,n,Set(__NODEST=)
exten => 147,n,Goto(from-internal,147,1)
exten => 147,n,Macro(blkvm-clr,)
exten => 147,n,Set(__NODEST=)
exten => 147,n,Goto(from-internal,147,1)

exten => 149,1,Macro(blkvm-clr,)
exten => 149,n,Set(__NODEST=)
exten => 149,n,Goto(from-internal,149,1)
exten => 149,n,Macro(blkvm-clr,)
exten => 149,n,Set(__NODEST=)
exten => 149,n,Goto(from-internal,149,1)

exten => 130,1,Macro(blkvm-clr,)
exten => 130,n,Set(__NODEST=)
exten => 130,n,Goto(from-internal,130,1)
exten => 130,n,Macro(blkvm-clr,)
exten => 130,n,Set(__NODEST=)
exten => 130,n,Goto(from-internal,130,1)

exten => 102,1,Macro(blkvm-clr,)
exten => 102,n,Set(__NODEST=)
exten => 102,n,Goto(from-internal,102,1)

exten => 381,1,Macro(blkvm-clr,)
exten => 381,n,Set(__NODEST=)
exten => 381,n,Goto(from-internal,381,1)

exten => 382,1,Macro(blkvm-clr,)
exten => 382,n,Set(__NODEST=)
exten => 382,n,Goto(from-internal,382,1)

exten => 351,1,Macro(blkvm-clr,)
exten => 351,n,Set(__NODEST=)
exten => 351,n,Goto(from-internal,351,1)
exten => 351,n,Macro(blkvm-clr,)
exten => 351,n,Set(__NODEST=)
exten => 351,n,Goto(from-internal,351,1)

exten => 383,1,Macro(blkvm-clr,)
exten => 383,n,Set(__NODEST=)
exten => 383,n,Goto(from-internal,383,1)

exten => 104,1,Macro(blkvm-clr,)
exten => 104,n,Set(__NODEST=)
exten => 104,n,Goto(from-internal,104,1)

exten => 127,1,Macro(blkvm-clr,)
exten => 127,n,Set(__NODEST=)
exten => 127,n,Goto(from-internal,127,1)
exten => 127,n,Macro(blkvm-clr,)
exten => 127,n,Set(__NODEST=)
exten => 127,n,Goto(from-internal,127,1)

exten => 133,1,Macro(blkvm-clr,)
exten => 133,n,Set(__NODEST=)
exten => 133,n,Goto(from-internal,133,1)
exten => 133,n,Macro(blkvm-clr,)
exten => 133,n,Set(__NODEST=)
exten => 133,n,Goto(from-internal,133,1)

exten => 107,1,Macro(blkvm-clr,)
exten => 107,n,Set(__NODEST=)
exten => 107,n,Goto(from-internal,107,1)

exten => 369,1,Macro(blkvm-clr,)
exten => 369,n,Set(__NODEST=)
exten => 369,n,Goto(from-internal,369,1)
exten => 369,n,Macro(blkvm-clr,)
exten => 369,n,Set(__NODEST=)
exten => 369,n,Goto(from-internal,369,1)

exten => 354,1,Macro(blkvm-clr,)
exten => 354,n,Set(__NODEST=)
exten => 354,n,Goto(from-internal,354,1)
exten => 354,n,Macro(blkvm-clr,)
exten => 354,n,Set(__NODEST=)
exten => 354,n,Goto(from-internal,354,1)

exten => 356,1,Macro(blkvm-clr,)
exten => 356,n,Set(__NODEST=)
exten => 356,n,Goto(from-internal,356,1)
exten => 356,n,Macro(blkvm-clr,)
exten => 356,n,Set(__NODEST=)
exten => 356,n,Goto(from-internal,356,1)

exten => 359,1,Macro(blkvm-clr,)
exten => 359,n,Set(__NODEST=)
exten => 359,n,Goto(from-internal,359,1)
exten => 359,n,Macro(blkvm-clr,)
exten => 359,n,Set(__NODEST=)
exten => 359,n,Goto(from-internal,359,1)

exten => 140,1,Macro(blkvm-clr,)
exten => 140,n,Set(__NODEST=)
exten => 140,n,Goto(from-internal,140,1)
exten => 140,n,Macro(blkvm-clr,)
exten => 140,n,Set(__NODEST=)
exten => 140,n,Goto(from-internal,140,1)

exten => 101,1,Macro(blkvm-clr,)
exten => 101,n,Set(__NODEST=)
exten => 101,n,Goto(from-internal,101,1)

exten => 800,1,Macro(blkvm-clr,)
exten => 800,n,Set(__NODEST=)
exten => 800,n,Goto(from-internal,800,1)

exten => 146,1,Macro(blkvm-clr,)
exten => 146,n,Set(__NODEST=)
exten => 146,n,Goto(from-internal,146,1)
exten => 146,n,Macro(blkvm-clr,)
exten => 146,n,Set(__NODEST=)
exten => 146,n,Goto(from-internal,146,1)

exten => 9999,1,Macro(blkvm-clr,)
exten => 9999,n,Set(__NODEST=)
exten => 9999,n,Goto(from-internal,9999,1)

exten => 357,1,Macro(blkvm-clr,)
exten => 357,n,Set(__NODEST=)
exten => 357,n,Goto(from-internal,357,1)
exten => 357,n,Macro(blkvm-clr,)
exten => 357,n,Set(__NODEST=)
exten => 357,n,Goto(from-internal,357,1)

exten => 373,1,Macro(blkvm-clr,)
exten => 373,n,Set(__NODEST=)
exten => 373,n,Goto(from-internal,373,1)
exten => 373,n,Macro(blkvm-clr,)
exten => 373,n,Set(__NODEST=)
exten => 373,n,Goto(from-internal,373,1)

exten => 368,1,Macro(blkvm-clr,)
exten => 368,n,Set(__NODEST=)
exten => 368,n,Goto(from-internal,368,1)
exten => 368,n,Macro(blkvm-clr,)
exten => 368,n,Set(__NODEST=)
exten => 368,n,Goto(from-internal,368,1)

exten => 148,1,Macro(blkvm-clr,)
exten => 148,n,Set(__NODEST=)
exten => 148,n,Goto(from-internal,148,1)

exten => 134,1,Macro(blkvm-clr,)
exten => 134,n,Set(__NODEST=)
exten => 134,n,Goto(from-internal,134,1)
exten => 134,n,Macro(blkvm-clr,)
exten => 134,n,Set(__NODEST=)
exten => 134,n,Goto(from-internal,134,1)

exten => 366,1,Macro(blkvm-clr,)
exten => 366,n,Set(__NODEST=)
exten => 366,n,Goto(from-internal,366,1)
exten => 366,n,Macro(blkvm-clr,)
exten => 366,n,Set(__NODEST=)
exten => 366,n,Goto(from-internal,366,1)

exten => 364,1,Macro(blkvm-clr,)
exten => 364,n,Set(__NODEST=)
exten => 364,n,Goto(from-internal,364,1)
exten => 364,n,Macro(blkvm-clr,)
exten => 364,n,Set(__NODEST=)
exten => 364,n,Goto(from-internal,364,1)

exten => 370,1,Macro(blkvm-clr,)
exten => 370,n,Set(__NODEST=)
exten => 370,n,Goto(from-internal,370,1)
exten => 370,n,Macro(blkvm-clr,)
exten => 370,n,Set(__NODEST=)
exten => 370,n,Goto(from-internal,370,1)

exten => 128,1,Macro(blkvm-clr,)
exten => 128,n,Set(__NODEST=)
exten => 128,n,Goto(from-internal,128,1)

exten => 145,1,Macro(blkvm-clr,)
exten => 145,n,Set(__NODEST=)
exten => 145,n,Goto(from-internal,145,1)
exten => 145,n,Macro(blkvm-clr,)
exten => 145,n,Set(__NODEST=)
exten => 145,n,Goto(from-internal,145,1)

exten => 352,1,Macro(blkvm-clr,)
exten => 352,n,Set(__NODEST=)
exten => 352,n,Goto(from-internal,352,1)
exten => 352,n,Macro(blkvm-clr,)
exten => 352,n,Set(__NODEST=)
exten => 352,n,Goto(from-internal,352,1)

exten => 138,1,Macro(blkvm-clr,)
exten => 138,n,Set(__NODEST=)
exten => 138,n,Goto(from-internal,138,1)
exten => 138,n,Macro(blkvm-clr,)
exten => 138,n,Set(__NODEST=)
exten => 138,n,Goto(from-internal,138,1)

exten => 143,1,Macro(blkvm-clr,)
exten => 143,n,Set(__NODEST=)
exten => 143,n,Goto(from-internal,143,1)

;--== end of [from-ivr-directory-1] ==--;


[from-ivr-directory-4]
exten => 386,1,Macro(blkvm-clr,)
exten => 386,n,Set(__NODEST=)
exten => 386,n,Goto(from-internal,386,1)

exten => 103,1,Macro(blkvm-clr,)
exten => 103,n,Set(__NODEST=)
exten => 103,n,Goto(from-internal,103,1)

exten => *363,1,Macro(blkvm-clr,)
exten => *363,n,Set(__NODEST=)
exten => *363,n,Goto(from-internal,*363,1)

exten => *365,1,Macro(blkvm-clr,)
exten => *365,n,Set(__NODEST=)
exten => *365,n,Goto(from-internal,*365,1)

exten => 136,1,Macro(blkvm-clr,)
exten => 136,n,Set(__NODEST=)
exten => 136,n,Goto(from-internal,136,1)

exten => *350,1,Macro(blkvm-clr,)
exten => *350,n,Set(__NODEST=)
exten => *350,n,Goto(from-internal,*350,1)

exten => 137,1,Macro(blkvm-clr,)
exten => 137,n,Set(__NODEST=)
exten => 137,n,Goto(from-internal,137,1)

exten => *139,1,Macro(blkvm-clr,)
exten => *139,n,Set(__NODEST=)
exten => *139,n,Goto(from-internal,*139,1)

exten => 105,1,Macro(blkvm-clr,)
exten => 105,n,Set(__NODEST=)
exten => 105,n,Goto(from-internal,105,1)

exten => 142,1,Macro(blkvm-clr,)
exten => 142,n,Set(__NODEST=)
exten => 142,n,Goto(from-internal,142,1)

exten => *384,1,Macro(blkvm-clr,)
exten => *384,n,Set(__NODEST=)
exten => *384,n,Goto(from-internal,*384,1)

exten => *362,1,Macro(blkvm-clr,)
exten => *362,n,Set(__NODEST=)
exten => *362,n,Goto(from-internal,*362,1)

exten => *367,1,Macro(blkvm-clr,)
exten => *367,n,Set(__NODEST=)
exten => *367,n,Goto(from-internal,*367,1)

exten => 131,1,Macro(blkvm-clr,)
exten => 131,n,Set(__NODEST=)
exten => 131,n,Goto(from-internal,131,1)

exten => 150,1,Macro(blkvm-clr,)
exten => 150,n,Set(__NODEST=)
exten => 150,n,Goto(from-internal,150,1)

exten => 144,1,Macro(blkvm-clr,)
exten => 144,n,Set(__NODEST=)
exten => 144,n,Goto(from-internal,144,1)

exten => *106,1,Macro(blkvm-clr,)
exten => *106,n,Set(__NODEST=)
exten => *106,n,Goto(from-internal,*106,1)

exten => 135,1,Macro(blkvm-clr,)
exten => 135,n,Set(__NODEST=)
exten => 135,n,Goto(from-internal,135,1)

exten => *360,1,Macro(blkvm-clr,)
exten => *360,n,Set(__NODEST=)
exten => *360,n,Goto(from-internal,*360,1)

exten => *358,1,Macro(blkvm-clr,)
exten => *358,n,Set(__NODEST=)
exten => *358,n,Goto(from-internal,*358,1)

exten => *355,1,Macro(blkvm-clr,)
exten => *355,n,Set(__NODEST=)
exten => *355,n,Goto(from-internal,*355,1)

exten => *353,1,Macro(blkvm-clr,)
exten => *353,n,Set(__NODEST=)
exten => *353,n,Goto(from-internal,*353,1)

exten => *361,1,Macro(blkvm-clr,)
exten => *361,n,Set(__NODEST=)
exten => *361,n,Goto(from-internal,*361,1)

exten => *132,1,Macro(blkvm-clr,)
exten => *132,n,Set(__NODEST=)
exten => *132,n,Goto(from-internal,*132,1)

exten => 129,1,Macro(blkvm-clr,)
exten => 129,n,Set(__NODEST=)
exten => 129,n,Goto(from-internal,129,1)

exten => *372,1,Macro(blkvm-clr,)
exten => *372,n,Set(__NODEST=)
exten => *372,n,Goto(from-internal,*372,1)

exten => 371,1,Macro(blkvm-clr,)
exten => 371,n,Set(__NODEST=)
exten => 371,n,Goto(from-internal,371,1)

exten => 141,1,Macro(blkvm-clr,)
exten => 141,n,Set(__NODEST=)
exten => 141,n,Goto(from-internal,141,1)

exten => 147,1,Macro(blkvm-clr,)
exten => 147,n,Set(__NODEST=)
exten => 147,n,Goto(from-internal,147,1)

exten => 149,1,Macro(blkvm-clr,)
exten => 149,n,Set(__NODEST=)
exten => 149,n,Goto(from-internal,149,1)

exten => 130,1,Macro(blkvm-clr,)
exten => 130,n,Set(__NODEST=)
exten => 130,n,Goto(from-internal,130,1)

exten => *102,1,Macro(blkvm-clr,)
exten => *102,n,Set(__NODEST=)
exten => *102,n,Goto(from-internal,*102,1)

exten => *381,1,Macro(blkvm-clr,)
exten => *381,n,Set(__NODEST=)
exten => *381,n,Goto(from-internal,*381,1)

exten => *382,1,Macro(blkvm-clr,)
exten => *382,n,Set(__NODEST=)
exten => *382,n,Goto(from-internal,*382,1)

exten => *351,1,Macro(blkvm-clr,)
exten => *351,n,Set(__NODEST=)
exten => *351,n,Goto(from-internal,*351,1)

exten => *383,1,Macro(blkvm-clr,)
exten => *383,n,Set(__NODEST=)
exten => *383,n,Goto(from-internal,*383,1)

exten => *104,1,Macro(blkvm-clr,)
exten => *104,n,Set(__NODEST=)
exten => *104,n,Goto(from-internal,*104,1)

exten => 127,1,Macro(blkvm-clr,)
exten => 127,n,Set(__NODEST=)
exten => 127,n,Goto(from-internal,127,1)

exten => 133,1,Macro(blkvm-clr,)
exten => 133,n,Set(__NODEST=)
exten => 133,n,Goto(from-internal,133,1)

exten => *107,1,Macro(blkvm-clr,)
exten => *107,n,Set(__NODEST=)
exten => *107,n,Goto(from-internal,*107,1)

exten => *369,1,Macro(blkvm-clr,)
exten => *369,n,Set(__NODEST=)
exten => *369,n,Goto(from-internal,*369,1)

exten => *354,1,Macro(blkvm-clr,)
exten => *354,n,Set(__NODEST=)
exten => *354,n,Goto(from-internal,*354,1)

exten => *356,1,Macro(blkvm-clr,)
exten => *356,n,Set(__NODEST=)
exten => *356,n,Goto(from-internal,*356,1)

exten => *359,1,Macro(blkvm-clr,)
exten => *359,n,Set(__NODEST=)
exten => *359,n,Goto(from-internal,*359,1)

exten => 140,1,Macro(blkvm-clr,)
exten => 140,n,Set(__NODEST=)
exten => 140,n,Goto(from-internal,140,1)

exten => 101,1,Macro(blkvm-clr,)
exten => 101,n,Set(__NODEST=)
exten => 101,n,Goto(from-internal,101,1)

exten => 146,1,Macro(blkvm-clr,)
exten => 146,n,Set(__NODEST=)
exten => 146,n,Goto(from-internal,146,1)

exten => *357,1,Macro(blkvm-clr,)
exten => *357,n,Set(__NODEST=)
exten => *357,n,Goto(from-internal,*357,1)

exten => *373,1,Macro(blkvm-clr,)
exten => *373,n,Set(__NODEST=)
exten => *373,n,Goto(from-internal,*373,1)

exten => *368,1,Macro(blkvm-clr,)
exten => *368,n,Set(__NODEST=)
exten => *368,n,Goto(from-internal,*368,1)

exten => 148,1,Macro(blkvm-clr,)
exten => 148,n,Set(__NODEST=)
exten => 148,n,Goto(from-internal,148,1)

exten => *134,1,Macro(blkvm-clr,)
exten => *134,n,Set(__NODEST=)
exten => *134,n,Goto(from-internal,*134,1)

exten => *366,1,Macro(blkvm-clr,)
exten => *366,n,Set(__NODEST=)
exten => *366,n,Goto(from-internal,*366,1)

exten => *364,1,Macro(blkvm-clr,)
exten => *364,n,Set(__NODEST=)
exten => *364,n,Goto(from-internal,*364,1)

exten => *370,1,Macro(blkvm-clr,)
exten => *370,n,Set(__NODEST=)
exten => *370,n,Goto(from-internal,*370,1)

exten => *128,1,Macro(blkvm-clr,)
exten => *128,n,Set(__NODEST=)
exten => *128,n,Goto(from-internal,*128,1)

exten => 145,1,Macro(blkvm-clr,)
exten => 145,n,Set(__NODEST=)
exten => 145,n,Goto(from-internal,145,1)

exten => *352,1,Macro(blkvm-clr,)
exten => *352,n,Set(__NODEST=)
exten => *352,n,Goto(from-internal,*352,1)

exten => 138,1,Macro(blkvm-clr,)
exten => 138,n,Set(__NODEST=)
exten => 138,n,Goto(from-internal,138,1)

exten => *143,1,Macro(blkvm-clr,)
exten => *143,n,Set(__NODEST=)
exten => *143,n,Goto(from-internal,*143,1)

;--== end of [from-ivr-directory-4] ==--;


[paging-chanspy]
exten => s,1,Answer
exten => s,n,Wait(1)
exten => s,n,Playback(beep&extension)
exten => s,n,SayAlpha(${AMPUSER})
exten => s,n,Playback(calling)
exten => s,n,SayDigits(${DIALED})
exten => s,n,ExecIf($["${DEVICE_STATE(${ORIG_CHANNEL})}" = "NOT_INUSE"]?Playback(sorry&this&channel&has-expired))
exten => s,n,ExecIf($["${DEVICE_STATE(${ORIG_CHANNEL})}" = "NOT_INUSE"]?Busy(5))
exten => s,n,ExecIf($["${DEVICE_STATE(${ORIG_CHANNEL})}" = "NOT_INUSE"]?Hangup())
exten => s,n,ChanSpy(${ORIG_CHANNEL},qEB)
exten => s,n,Hangup

;--== end of [paging-chanspy] ==--;


[from-internal-additional]
include => app-cf-busy-off
include => app-cf-off
include => app-cf-busy-prompting-on
include => app-cf-busy-on
include => app-cf-busy-off-any
include => app-cf-off-any
include => app-cf-on
include => app-cf-toggle
include => app-cf-unavailable-prompt-on
include => app-cf-unavailable-on
include => app-cf-prompting-on
include => app-cf-unavailable-off
include => ext-cf-hints
include => app-callwaiting-cwoff
include => app-callwaiting-cwon
include => ext-meetme
include => app-dnd-off
include => app-dnd-on
include => app-dnd-toggle
include => ext-dnd-hints
include => app-fmf-toggle
include => ext-findmefollow
include => fmgrps
include => app-hotelwakeup
include => app-calltrace
include => app-echo-test
include => app-speakextennum
include => app-speakingclock
include => ext-intercom-users
include => park-hints
include => app-parking
include => ext-queues
include => app-queue-toggle
include => app-queue-caller-count
include => app-recordings
include => ext-group
include => grps
include => timeconditions-toggles
include => app-dialvm
include => app-vmmain
include => app-blacklist
include => app-userlogonoff
include => ext-local-confirm
include => findmefollow-ringallv2
include => app-pickup
include => app-chanspy
include => ext-test
include => ext-local
include => outbound-allroutes
exten => h,1,Hangup

;--== end of [from-internal-additional] ==--;


[from-internal-noxfer-additional]
exten => h,1,Hangup

;--== end of [from-internal-noxfer-additional] ==--;


