; ============================================================
; Plum Market – Palm Beach Gardens (PBG)
; Mirror of West Bloomfield (6565 Orchard) STT IVR behavior - per Dave Marriott
; Address: 2410 PGA Blvd, Palm Beach Gardens, FL 33410

; PURPOSE:
;   "Site profile" for STT IVR.
;   This sets per-store variables (greeting, mapping, fallback)
;   and then hands off to the shared STT engine:
;       [sttivr] in extensions_sttivr.conf
;
; HOW IT WORKS:
;   - Caller hits this context (s,1)
;   - We set variables used by the STT engine:
;       IVR_MSG, STORE_LOCAL, FINAL_EXT, IVR0..IVR9, IVRSTAR, IVRPOUND
;   - Then jump into the engine: GoTo(sttivr,sttivr,1)
; ============================================================

[2410_pbg]

exten => s,1,Verbose("2410 PBG STT IVR (Mirrors 6565 Orchard)")

; Greeting prompt for this store
exten => s,n,Set(_IVR_MSG=custom/2410_PBG_Voice_IVR)

; Store identifier used by STT mapping logic
exten => s,n,Set(_STORE_LOCAL=2410)

; Fallback destination (operator / POD 1)
exten => s,n,Set(_FINAL_EXT=704)

; ---- DTMF mappings (mirror WBL pattern) ----
; 0 = operator / main destination
exten => s,n,Set(_IVR0=704)

; WBL leaves these blank (keep blank unless instructed otherwise)
exten => s,n,Set(_IVR1=)
exten => s,n,Set(_IVR2=)

; WBL uses 3 and 5 (you MUST decide what these should be in PBG)
; If you don’t know yet, leave them blank for now.
;exten => s,n,Set(_IVR3=990)   ; WBL special destination
exten => s,n,Set(_IVR3=)

exten => s,n,Set(_IVR4=)

;exten => s,n,Set(_IVR5=991)   ; WBL special destination
exten => s,n,Set(_IVR5=)

exten => s,n,Set(_IVR6=)
exten => s,n,Set(_IVR7=)
exten => s,n,Set(_IVR8=)
exten => s,n,Set(_IVR9=)

; WBL does not map * or # (leave blank to mirror)
exten => s,n,Set(_IVRSTAR=)
exten => s,n,Set(_IVRPOUND=)

; Loop controls (match WBL)
exten => s,n,Set(_INVALID_MAXCOUNT=3)
exten => s,n,Set(_TIMEOUT_MAXCOUNT=3)
exten => s,n,Set(_INVALID_LOOPCOUNT=0)
exten => s,n,Set(_TIMEOUT_LOOPCOUNT=0)

; Confidence target (WBL sets 0.1 — note engine may still hardcode 0.5)
exten => s,n,Set(_CONFIDENCE="0.1")

; Reset vars (match WBL style)
exten => s,n,Set(_AGIRXDIGITS=NONE)
exten => s,n,Set(_UTTERANCE="")
exten => s,n,Set(_EXTFOUND="")
exten => s,n,Set(_MAPPEDEXT="")
exten => s,n,Set(__IVR_RETVM=)

; !!!!!!!!!!!! Hand off to the shared STT engine !!!!!!!!!!!
exten => s,n,GoTo(sttivr,sttivr,1)

; ----- END 2410 PBG ----- ;
